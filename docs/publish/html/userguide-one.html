<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Inca 2.6 User's Guide</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="inca.css"></HEAD
><BODY
CLASS="ARTICLE"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN1"
>Inca 2.6 User's Guide</A
></H1
><H2
CLASS="SUBTITLE"
>[<A
HREF="userguide-one.html"
TARGET="_top"
>Single page</A
>, <A
HREF="userguide-index.html"
TARGET="_top"
>Multiple pages</A
>]</H2
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
>1. <A
HREF="#USERGUIDE-INTRO"
>Introduction</A
></DT
><DT
>2. <A
HREF="#USERGUIDE-REQUIREMENTS"
>Requirements</A
></DT
><DT
>3. <A
HREF="#USERGUIDE-RECOMMENDATIONS"
>Recommendations</A
></DT
><DT
>4. <A
HREF="#USERGUIDE-QUICKSTART"
>Quick Start</A
></DT
><DT
>5. <A
HREF="#USERGUIDE-INCAT"
>Administering Inca with incat</A
></DT
><DD
><DL
><DT
>5.1. <A
HREF="#USERGUIDE-INCAT-REPOS"
>Repositories</A
></DT
><DT
>5.2. <A
HREF="#USERGUIDE-INCAT-RESOURCES"
>Resource Configuration</A
></DT
><DT
>5.3. <A
HREF="#USERGUIDE-INCAT-SUITES"
>Suites</A
></DT
><DT
>5.4. <A
HREF="#USERGUIDE-INCAT-COMMITS"
>Committing/Saving</A
></DT
><DT
>5.5. <A
HREF="#ACCESS-METHODS"
>Resource Access Methods</A
></DT
><DT
>5.6. <A
HREF="#USERGUIDE-CHANGE-APPROVAL"
>Requiring Resource Administrator Approval</A
></DT
><DT
>5.7. <A
HREF="#PROXIES"
>Proxies</A
></DT
><DT
>5.8. <A
HREF="#USERGUIDE-INCAT-MACROS"
>Using Resource Macros</A
></DT
><DD
><DL
><DT
>5.8.1. <A
HREF="#USERGUIDE-INCAT-ALL2ALL"
>Configuring "all2all" Series</A
></DT
></DL
></DD
><DT
>5.9. <A
HREF="#USERGUIDE-INCAT-COMPARISON"
>Series Comparison and Notification</A
></DT
></DL
></DD
><DT
>6. <A
HREF="#USERGUIDE-CONSUMER"
>Data Display (Data Consumers)</A
></DT
><DD
><DL
><DT
>6.1. <A
HREF="#CURRENT-DATA"
>Current Data</A
></DT
><DD
><DL
><DT
>6.1.1. <A
HREF="#TABLE-SUMMARY"
>Tabular Suite Summary View</A
></DT
><DT
>6.1.2. <A
HREF="#REST"
>REST URLs</A
></DT
><DT
>6.1.3. <A
HREF="#GOOGLE"
>Map View using Google Map API</A
></DT
></DL
></DD
><DT
>6.2. <A
HREF="#REPORTS"
>Reports</A
></DT
><DD
><DL
><DT
>6.2.1. <A
HREF="#PASS-FAIL-REPORT"
>Pass/Fail Graphs and Error Messages</A
></DT
><DT
>6.2.2. <A
HREF="#AVE-PASS-REPORT"
>Average Pass Rate by Resource/Suite</A
></DT
><DT
>6.2.3. <A
HREF="#SERIES-REPORT"
>Series Error Summary</A
></DT
><DT
>6.2.4. <A
HREF="#AVE-PASS-HISTORY-REPORT"
>Average Pass History</A
></DT
></DL
></DD
><DT
>6.3. <A
HREF="#QUERY-PAGES"
>Query</A
></DT
><DD
><DL
><DT
>6.3.1. <A
HREF="#GRAPH-SERIES"
>Create Graph</A
></DT
><DT
>6.3.2. <A
HREF="#CREATE-QUERY"
>Create Stored Query</A
></DT
><DT
>6.3.3. <A
HREF="#VIEW-QUERY"
>Manage Stored Queries</A
></DT
></DL
></DD
><DT
>6.4. <A
HREF="#ADMIN"
>Admin</A
></DT
><DD
><DL
><DT
>6.4.1. <A
HREF="#RUNNING-REPORTERS"
>List Running Reporters</A
></DT
><DT
>6.4.2. <A
HREF="#CONFIG-CONSUMER"
>View/Change Configuration</A
></DT
></DL
></DD
><DT
>6.5. <A
HREF="#CONSUMER-REPORT-DETAILS"
>Report Details</A
></DT
><DD
><DL
><DT
>6.5.1. <A
HREF="#CONSUMER-REPORT-DETAILS-XML"
>Report Details XML</A
></DT
><DT
>6.5.2. <A
HREF="#CONSUMER-RUN-NOW"
>Run Nows</A
></DT
><DT
>6.5.3. <A
HREF="#CONSUMER-KB"
>Knowledge Base</A
></DT
></DL
></DD
><DT
>6.6. <A
HREF="#CONSUMER-REPORT-SUMMARY-XML"
>Report Summaries</A
></DT
><DT
>6.7. <A
HREF="#FILE-DESC"
>Description of Data Consumer Files</A
></DT
><DT
>6.8. <A
HREF="#CUSTOM-DISPLAY"
>Changing the Look</A
></DT
><DD
><DL
><DT
>6.8.1. <A
HREF="#CUSTOM-COLOR"
>Colors and Fonts</A
></DT
><DT
>6.8.2. <A
HREF="#CUSTOM-HTML"
>HTML Layout</A
></DT
><DT
>6.8.3. <A
HREF="#CUSTOM-HTML-HEADER"
>Custom Page Header</A
></DT
></DL
></DD
><DT
>6.9. <A
HREF="#CONSUMER-NEUTRAL-ERRS"
>Displaying Errors Neutrally</A
></DT
><DT
>6.10. <A
HREF="#CONSUMER-ALT-LOCATION"
>Changing the Installation Location</A
></DT
><DT
>6.11. <A
HREF="#CONSUMER-PORT"
>Changing Ports</A
></DT
><DT
>6.12. <A
HREF="#DISABLE-HTTP-CONSUMER"
>Disabling HTTP</A
></DT
><DT
>6.13. <A
HREF="#HTTPS-CREDS"
>Changing HTTPS credential</A
></DT
><DT
>6.14. <A
HREF="#PASSWORD-CONSUMER"
>Adding Password Protection</A
></DT
></DL
></DD
><DT
>7. <A
HREF="#USERGUIDE-REPORTERS"
>Reporters and Repositories</A
></DT
><DD
><DL
><DT
>7.1. <A
HREF="#REPORTER-CMDLINE"
>Executing Reporters</A
></DT
><DT
>7.2. <A
HREF="#REPORTER-WRITING"
>Writing Reporters</A
></DT
><DD
><DL
><DT
>7.2.1. <A
HREF="#REPORTER-SCHEMA"
>Reporter XML Schema</A
></DT
><DT
>7.2.2. <A
HREF="#REPORTER-OUTPUT"
>Reporter XML Output</A
></DT
><DT
>7.2.3. <A
HREF="#REPORTER-API"
>Reporter APIs</A
></DT
><DT
>7.2.4. <A
HREF="#WRITING-TIPS"
>Reporter Writing Tips</A
></DT
></DL
></DD
><DT
>7.3. <A
HREF="#REPORTER-REPOSITORIES"
>Reporter Repositories</A
></DT
><DD
><DL
><DT
>7.3.1. <A
HREF="#PACKAGE-DEPEND"
>Reporter Package Dependencies</A
></DT
><DT
>7.3.2. <A
HREF="#UPDATE-REPOSITORY"
>Updating Reporter Repositories</A
></DT
></DL
></DD
></DL
></DD
><DT
>8. <A
HREF="#USERGUIDE-APIS"
>Inca Client APIs</A
></DT
><DT
>9. <A
HREF="#USERGUIDE-WEBSERVICES"
>Web Services</A
></DT
><DT
>10. <A
HREF="#USERGUIDE-SECURITY"
>Security</A
></DT
><DT
>11. <A
HREF="#USERGUIDE-ADVANCED-CONFIG"
>Advanced Configuration</A
></DT
><DD
><DL
><DT
>11.1. <A
HREF="#COMP-OPTIONS"
>Inca Component Options</A
></DT
><DT
>11.2. <A
HREF="#CUSTOM-NOTIFICATION"
>Customizing Series Notification</A
></DT
><DT
>11.3. <A
HREF="#REPORT-FILTERING"
>Report Filtering</A
></DT
><DD
><DL
><DT
>11.3.1. <A
HREF="#DOWNTIME-FILTER"
>Downtime Filter</A
></DT
><DT
>11.3.2. <A
HREF="#ALL2ALL-FILTER"
>All2All Filter</A
></DT
><DT
>11.3.3. <A
HREF="#MULTIPLE-FILTERS"
>Mutiple Filters</A
></DT
></DL
></DD
><DT
>11.4. <A
HREF="#DB-CONFIG"
>Depot Database Configuration</A
></DT
><DT
>11.5. <A
HREF="#PEER-DEPOTS"
>Depot Fault Tolerance</A
></DT
><DT
>11.6. <A
HREF="#USERGUIDE-ADVANCED-MANUAL"
>Manual Access Method</A
></DT
><DT
>11.7. <A
HREF="#USERGUIDE-ADVANCED-BATCH"
>Batch Systems</A
></DT
><DT
>11.8. <A
HREF="#USERGUIDE-ADVANCED-RUNNOW"
>Manual Run Now</A
></DT
><DD
><DL
><DT
>11.8.1. <A
HREF="#USERGUIDE-ADVANCED-RUNNOW-CONFIG"
>Configuring the Manual Run Now Script</A
></DT
><DT
>11.8.2. <A
HREF="#USERGUIDE-ADVANCED-RUNNOW-USING"
>Using the Manual Run Now Script</A
></DT
></DL
></DD
><DT
>11.9. <A
HREF="#USERGUIDE-ADVANCED-SRCDIST"
>Source Distributions</A
></DT
></DL
></DD
><DT
>12. <A
HREF="#USERGUIDE-MAN"
>Component Man Pages</A
></DT
><DD
><DL
><DT
>12.1. <A
HREF="#MAN-DEPOT"
>Depot</A
></DT
><DT
>12.2. <A
HREF="#MAN-AGENT"
>Agent</A
></DT
><DT
>12.3. <A
HREF="#MAN-RM"
>Reporter Manager</A
></DT
><DT
>12.4. <A
HREF="#MAN-CONSUMER"
>Consumer</A
></DT
><DT
>12.5. <A
HREF="#MAN-INCAT"
>Incat</A
></DT
><DT
>12.6. <A
HREF="#MAN-INCAWS"
>Inca Web Services</A
></DT
></DL
></DD
><DT
>13. <A
HREF="#USERGUIDE-TROUBLESHOOTING"
>Troubleshooting</A
></DT
><DD
><DL
><DT
>13.1. <A
HREF="#USERGUIDE-LOGGING"
>Log Files</A
></DT
><DT
>13.2. <A
HREF="#USERGUIDE-AUTHPROB"
>Authentication Problems</A
></DT
></DL
></DD
></DL
></DIV
><FONT
COLOR="RED"
>[<A
HREF="userguide-one.html"
TARGET="_top"
>Single page</A
>, <A
HREF="userguide-index.html"
TARGET="_top"
>Multiple pages</A
>]</FONT
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-INTRO"
>1. Introduction</A
></H2
><P
>Determining whether a Grid is up in the face of complex Grid software
deployments can be difficult and depends on the types of applications and
users that utilize it.  By detailing a set of software, services, and features
that should be available on a Grid in a machine-readable format, a Grid can be
tested periodically by an automated system to verify its health and usability
to users.  To this end, we have developed Inca as a flexible framework to
perform periodic, user-level functionality testing and performance measurement
of Grid systems.  It includes mechanisms to schedule the execution of
information gathering scripts, and to collect, archive, publish, and display
data    </P
><P
>The architecture of Inca and a description of its components is shown in the
below figures.  </P
><DIV
CLASS="FIGURE"
><A
NAME="ARCH.FIG"
></A
><P
><B
>Figure 1. Inca architecture</B
></P
><P
><IMG
SRC="figures/arch/arch.jpg"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="INFORMALTABLE"
><P
></P
><A
NAME="AEN13"
></A
><TABLE
BORDER="0"
FRAME="void"
CLASS="CALSTABLE"
><COL><COL><TBODY
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/arch/ug-reporter-icon.png"></P
></TD
><TD
><P
> 
  A <EM
><FONT
>reporter</FONT
></EM
> is an executable program that tests or
  measures some aspect of the system or installed software.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/arch/ug-report-icon.png"></P
></TD
><TD
><P
> 
  A <EM
><FONT
>report</FONT
></EM
> is the output of a reporter and is a XML
  document complying to the reporter schema in <A
HREF="#REPORTER-SCHEMA"
>Section 7.2.1</A
>.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/arch/ug-suite-icon.png"></P
></TD
><TD
><P
> 
  A <EM
><FONT
>suite</FONT
></EM
> specifies a set of reporters to execute on
  selected resources, their configuration, and frequency of execution.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/arch/ug-repository-icon.png"></P
></TD
><TD
><P
>  A <EM
><FONT
>reporter repository</FONT
></EM
> contains a collection of reporters and is available
  via an URL.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/arch/ug-manager-icon.png"></P
></TD
><TD
><P
>  A <EM
><FONT
>reporter manager</FONT
></EM
> is responsible for managing the
  schedule and execution of reporters on a single resource.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/arch/ug-agent-icon.png"></P
></TD
><TD
><P
>  A <EM
><FONT
>agent</FONT
></EM
> is a server that implements the configuration
  specified by the Inca Administrator.  
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/arch/ug-incat-icon.png"></P
></TD
><TD
><P
>  <EM
><FONT
>incat</FONT
></EM
> is a GUI used by the Inca administrator to
  control and configure the Inca deployment on a set of resources.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/arch/ug-depot-icon.png"></P
></TD
><TD
><P
>  A <EM
><FONT
>depot</FONT
></EM
> is a server that is responsible for storing the
  data produced by reporters. 
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/arch/ug-consumer-icon.png"></P
></TD
><TD
><P
>  A <EM
><FONT
>data consumer</FONT
></EM
> is typically a web page client that
  queries a depot for data and displays it in a user-friendly format. 
  </P
></TD
></TR
></TBODY
></TABLE
><P
></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-REQUIREMENTS"
>2. Requirements</A
></H2
><P
>      The Inca server components have the following requirements:
    </P
><P
></P
><UL
><LI
><P
>           Sun JDK or JRE 1.4.2_09 or greater.  When run with Java 1.4, the
           memory usage of Inca components sometimes grows significantly over
           time.  This appears to be a problem in the Java run-time that is
           fixed in Sun Java 1.5 and 1.6, so use those versions if possible.
        </P
></LI
><LI
><P
>Perl 5.8.6 or greater</P
></LI
><LI
><P
>OpenSSL-0.9.6[jkl] or OpenSSL-0.9.7b or greater</P
></LI
><LI
><P
>GNU tar (i.e., no limit on filename length)</P
></LI
></UL
><P
>      Inca clients (reporter managers) running on *nix resources should have:
    </P
><P
></P
><UL
><LI
><P
>Perl 5.8.x or greater</P
></LI
><LI
><P
>OpenSSL-0.9.6[jkl] or OpenSSL-0.9.7b or greater</P
></LI
><LI
><P
>GNU tar (i.e., no limit on filename length)</P
></LI
><LI
><P
>make or gmake</P
></LI
><LI
><P
>a C compiler</P
></LI
></UL
><P
>      Inca clients (reporter managers) running on Windows resources should have cygwin installed with the following modules (tested on XP):</P
><P
></P
><UL
><LI
><P
>ssh server</P
></LI
><LI
><P
>perl</P
></LI
><LI
><P
>make</P
></LI
><LI
><P
>gcc</P
></LI
><LI
><P
>openssl &#38; openssl-dev</P
></LI
><LI
><P
>vim (not required for reporter manager but generally useful)</P
></LI
></UL
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-RECOMMENDATIONS"
>3. Recommendations</A
></H2
><P
>We recommend that Inca be run under a regular user account and not as root for the following reasons:</P
><P
></P
><UL
><LI
><P
>    To best detect user-level problems, Inca should be run under a regular
    user account with the default environment setup.
    </P
></LI
><LI
><P
>    Inca does not require any special privileges to run.
    </P
></LI
></UL
><P
>Furthermore, we recommend that a valid GSI credential be obtained for this
regular user account so that tests of Grid software requiring proxy
certificates can be executed. Please request a GSI credential from your
virtual organization's Certificate Authority (CA) and consult your
organization's security policy regarding GSI credential use.  
<A
HREF="#PROXIES"
>Section 5.7</A
> describes using proxy credentials in the Inca framework.</P
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-QUICKSTART"
>4. Quick Start</A
></H2
><P
>This section describes how to download, install and verify the Inca 2.6 
binary release. The figure below represents a typical installation. </P
><DIV
CLASS="FIGURE"
><A
NAME="INSTALL-ARCH"
></A
><P
><B
>Figure 2. Inca Installation</B
></P
><P
><IMG
SRC="figures/arch/arch-install.jpg"
ALIGN="CENTER"></P
></DIV
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>Step <A
HREF="#QS-STEP1"
>1</A
>: Download the installer script</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP2"
>2</A
>: Run the installer script</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP3"
>3</A
>: Change to the Inca installation directory</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP4"
>4</A
>: Create credentials for Inca components</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP5"
>5</A
>: Start up Inca components with a sample default configuration</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP6"
>6</A
>: View the Inca web server pages</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP7"
>7</A
>: View the sample default configuration using the Inca GUI tool</TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><OL
TYPE="1"
><LI
><A
NAME="QS-STEP1"
></A
><P
>     Download the <TT
CLASS="FILENAME"
>incaInstall.sh</TT
> script:
    </P
><P
>    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% wget http://inca.sdsc.edu/releases/2.6/incaInstall.sh</PRE
></FONT
></TD
></TR
></TABLE
>
    </P
></LI
><LI
><A
NAME="QS-STEP2"
></A
><P
>    Execute the install script to download the binary distribution from our
    website and unpack it into an installation directory.  The installation directory is represented by 
    the $INCA_DIST environment variable - it may be useful to set this variable now. 
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% sh incaInstall.sh $INCA_DIST core</PRE
></FONT
></TD
></TR
></TABLE
><P
>$INCA_DIST is the location of the directory where you want to
    install Inca.  You should see something like:
    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>Retrieving http://inca.sdsc.edu/releases/current/
inca-common-java-bin.tar.gz
--12:49:38--  http://inca.sdsc.edu/releases/current/
inca-common-java-bin.tar.gz
=&#62; `inca-common-java-bin.tar.gz'
Resolving inca.sdsc.edu... 198.202.75.28
Connecting to inca.sdsc.edu|198.202.75.28|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5,921,461 [application/x-tar]

100%[======================&#62;] 5,921,461    1.23M/s  ETA 00:00

12:49:43 (1.18 MB/s) - `inca-common-java-bin.tar.gz'
saved [5921461/5921461] 
...
common-java installed ...
agent installed ...
consumers installed ...
depot installed ...
incat installed</PRE
></FONT
></TD
></TR
></TABLE
>
      </P
></LI
><LI
><A
NAME="QS-STEP3"
></A
><P
>    Change to the top level directory of your Inca installation:
    </P
><P
>    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST</PRE
></FONT
></TD
></TR
></TABLE
>
    </P
></LI
><LI
><A
NAME="QS-STEP4"
></A
><P
>    Create certificates for the Inca components (enables secure component
    communication): 
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca createauth</PRE
></FONT
></TD
></TR
></TABLE
><P
>    <STRONG
><FONT
COLOR="RED"
>NOTE:</FONT
></STRONG
> the default life of 2.6 
    certificates is 5 years (1 year in earlier releases).
    To replace expired certificates, execute "bin/inca createauth" again to 
    create new certificates and "bin/inca agent -u &#60;resource group&#62; 
    -logfile var/upgrade.log" to update the certificates on the reporter managers.
    </P
><P
>    Output from "bin/inca createauth" looks similar to the text below.  When 
    completed, you should see a certificate/key created for each of the 
    four Inca components and stored in $INCA_DIST/etc: 
    </P
><P
>    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>password&#62; (choose a password for your Inca installation administration)
Confirm password&#62; (reenter the same password)
Generating a 512 bit RSA private key
.++++++++++++
writing new private key to 'clientx.sdsc.edukey.pem'
-----
agent
Generating a 512 bit RSA private key
.++++++++++++
writing new private key to 'agentkey.pem' ...
writing new private key to 'consumerkey.pem' ...
writing new private key to 'depotkey.pem' ...
writing new private key to 'incatkey.pem' ...</PRE
></FONT
></TD
></TR
></TABLE
>
  </P
></LI
><LI
><A
NAME="QS-STEP5"
></A
><P
>    Start the Inca server components and deploy the sample default
    configuration (<STRONG
><FONT
COLOR="RED"
>NOTE:</FONT
></STRONG
> this command only needs to 
be executed ONCE.  The components started in this step can later be stopped with "./bin/inca stop all" and started with 
"./bin/inca start all".  A restart command is also available).  The Inca server components are agent, depot, and consumer
    and will be started on ports 6323, 6324, and 8080 respectively.  Please
    edit the inca.properties file in etc/common to change the default ports
    for the agent and depot.  For the consumer, the port number can be
    customized in etc/jetty.xml.  More information can be found in <A
HREF="#USERGUIDE-ADVANCED-CONFIG"
>Section 11</A
>.
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca default</PRE
></FONT
></TD
></TR
></TABLE
><P
>    You should see something like:
    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>password&#62; (enter password from the last step)
Preparing to deploy default Inca configuration...
Initializing Inca configuration...
** Warning:  this will erase any previously collected reporter
    state on the Inca depot and configuration on the agent 
    Do you wish to continue (y/n)? y
Initializing depot...
Initializing c3p0 pool... com.mchange.v2.c3p0.PoolBackedDataSource@90....
Database Initialization Completed
done
Initializing agent
done
Started Inca agent
Started Inca consumer
Started Inca depot
Sleeping for 20 seconds while the components come online
Deploying default configuration</PRE
></FONT
></TD
></TR
></TABLE
>
      </P
><P
>During this step:</P
><P
></P
><UL
><LI
><P
>three server components are started on localhost:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ps | grep java
3527 p1 S 0:14.21 /usr/bin/java -Xmx256m edu.sdsc.inca.Agent -l agent.log
3560 p1 S 0:17.63 /usr/bin/java -Xmx256m edu.sdsc.inca.Depot -l depot.log
3593 p1 S 0:15.43 /usr/bin/java -Xmx256m edu.sdsc.inca.Consumer consumer.log</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>a sample test suite called <EM
><FONT
>sampleSuite</FONT
></EM
> is sent to the
        agent.  The sample suite contains a schedule for executing each of the following reporters
	every ten minutes:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>cluster.admin.ant.unit  			(ant_helloworld_compile_test)
cluster.admin.ant.version  			(ant_version)
cluster.compiler.any.unit  			(gcc_hello_world)
cluster.compiler.gcc.version  			(gcc_version)
cluster.compiler.any.unit  			(java_hello_world)
cluster.java.sun.version  			(java_version)
cluster.interactive_access.openssh.version	(openssh_version)
cluster.security.openssl.version		(openssl_version)
viz.lib.vtk-nvgl.version			(vtk-nvgl_version)
grid.wget.unit					(wget_page_test)</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>a client component is started on localhost:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ps | grep Manager
5382 p1 S 0:02.14 /usr/bin/perl reporter-manager
                  -d incas://client64-236.sdsc.edu:6324 -c etc/rmcert.</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
><UL
><LI
><P
>The agent receives <EM
><FONT
>sampleSuite</FONT
></EM
> suite and installs a reporter 
          manager on the localhost in <TT
CLASS="FILENAME"
>~/incaReporterManager</TT
> (takes 1-5 minutes - view progress of build in 
          <TT
CLASS="FILENAME"
>~/incaReporterManager/build.log</TT
>)
        </P
></LI
><LI
><P
>After the reporter manager is built, it registers itself with 
          the agent.  The agent will send the reporter manager the set of
          reporters, libraries, and execution schedule. 
        </P
></LI
><LI
><P
>          The reporter manager executes reporters based on the execution
          schedule and sends reports to the depot.  
        </P
></LI
></UL
></LI
></UL
></LI
><LI
><A
NAME="QS-STEP6"
></A
><P
>To view results and verify that your Inca installation is
    working correctly, open the URL below in a browser.
    Starting a web server is not required, but you may need to replace "localhost" with the full hostname of your
    machine.
    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>http://<STRONG
><FONT
COLOR="RED"
>localhost</FONT
></STRONG
>:8080</PRE
></FONT
></TD
></TR
></TABLE
>
    </P
><P
>    You should see a start up screen similar to the figure below initially
    indicating an empty Inca configuration.  
        <DIV
CLASS="FIGURE"
><A
NAME="INCA.STARTUP.EMPTY.FIG"
></A
><P
><B
>Figure 3. Default Inca start up page.</B
></P
><P
><IMG
SRC="figures/consumer/index1.gif"
ALIGN="CENTER"></P
></DIV
>
    </P
><P
>    After a few minutes (when the consumer cache is refreshed), reload the
    page and you should see a start up screen similar to the figure below 
    showing one suite called <EM
><FONT
>sampleSuite</FONT
></EM
> 
    (our default sample configuration), a resource group called
    <EM
><FONT
>defaultGrid</FONT
></EM
>, a resource group called
    <EM
><FONT
>localSite</FONT
></EM
>, and one resource called
    <EM
><FONT
>localResource</FONT
></EM
> which is a nickname for the machine you 
    installed an Inca reporter manager on.
        <DIV
CLASS="FIGURE"
><A
NAME="INCA.STARTUP.FIG"
></A
><P
><B
>Figure 4. Default Inca start up page with suite and resources.</B
></P
><P
><IMG
SRC="figures/consumer/index2.gif"
ALIGN="CENTER"></P
></DIV
>
    </P
><P
>    Select <EM
><FONT
>sampleSuite</FONT
></EM
> and
    <EM
><FONT
>defaultGrid</FONT
></EM
> and press the <EM
><FONT
>Submit</FONT
></EM
>
    button.  You should see a page similar to the figure below with
    the reporter series scheduled to execute on localhost.  The reporters test a small set of compiler, 
    grid services, math library and
    scientific visualization packages.  Each reporter may perform
    a software package version query (e.g., gcc) and/or unit test (e.g., java --
    unit test name is java_hello_world).  Almost all boxes should be empty
    indicating that the reports have not yet been received. 
        <DIV
CLASS="FIGURE"
><A
NAME="INCA.DEFAULT.RESULTS.EMPTY.FIG"
></A
><P
><B
>Figure 5. Default Inca results page without all results.</B
></P
><P
><IMG
SRC="figures/consumer/sum_page1.gif"
ALIGN="CENTER"></P
></DIV
>
    </P
><P
>    Refresh the page after a few minutes and you should begin to see more
    boxes filled in until it looks like the below figure.  If you do not see a
    results filled in, check the .log files in $INCA_DIST/var for
    <TT
CLASS="FILENAME"
>ERROR</TT
> or <TT
CLASS="FILENAME"
>Exception</TT
>. See
    <A
HREF="#USERGUIDE-LOGGING"
>Section 13.1</A
> for more information about logging.
    </P
><P
>You can also navigate to this page from the "table of sampleSuite 
    results" link under "Current Data" in the page header.</P
><DIV
CLASS="FIGURE"
><A
NAME="INCA.DEFAULT.RESULTS.FIG"
></A
><P
><B
>Figure 6. Default Inca results page with results.</B
></P
><P
><IMG
SRC="figures/consumer/sum_page2.jpg"
ALIGN="CENTER"></P
></DIV
><P
>Click on any red/green box to see the details of how the result was
    collected.  The figure below shows the details of the 
    <TT
CLASS="FILENAME"
>cluster.compiler.any.unit</TT
> reporter that compiles
    and executes a small hello world java program.  
        <DIV
CLASS="FIGURE"
><A
NAME="INCA.JAVA.FIG"
></A
><P
><B
>Figure 7. Reporter details page.</B
></P
><P
><IMG
SRC="figures/consumer/details_annotated.jpg"></P
></DIV
>
    </P
></LI
><LI
><A
NAME="QS-STEP7"
></A
><P
>View the Inca sample default configuration using the Inca GUI tool, incat (Inca Administration Tool).
      You can use incat to make changes to the default configuration (e.g., add
      a new resource to <EM
><FONT
>defaultGrid</FONT
></EM
> or add new tests to
      <EM
><FONT
>sampleSuite</FONT
></EM
>).  See <A
HREF="#USERGUIDE-INCAT"
>Section 5</A
> for more information about using incat.</P
><P
> Use the following command to start incat: <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca start incat -A localhost:6323 </PRE
></FONT
></TD
></TR
></TABLE
> </P
><P
> You should now see the Java GUI window appear on your local machine. 
      If you don't see Java GUI windows pop up like those in <A
HREF="#RETRIEVE.FIG"
>Figure 8</A
> and <A
HREF="#DEFAULT.FIG"
>Figure 9</A
>, 
      it is probable that X-Window forwarding is not set up correctly between the 
      machine where you installed Inca and your local machine.
        You can either configure X-Window forwarding, or you can start incat on a local machine as described in step <A
HREF="#QS-STEP8"
>8</A
>.
      </P
><P
>        <DIV
CLASS="FIGURE"
><A
NAME="RETRIEVE.FIG"
></A
><P
><B
>Figure 8. incat Agent Screen</B
></P
><P
><IMG
SRC="figures/incat/starting-up.jpg"
ALIGN="CENTER"></P
></DIV
>
        Once incat has information from the agent, the following screen will display:
      </P
><DIV
CLASS="FIGURE"
><A
NAME="DEFAULT.FIG"
></A
><P
><B
>Figure 9. Default incat Screen</B
></P
><P
><IMG
SRC="figures/incat/repository-tab.jpg"
ALIGN="CENTER"></P
></DIV
></LI
><LI
><A
NAME="QS-STEP8"
></A
><P
><STRONG
><FONT
COLOR="RED"
>THIS STEP IS OPTIONAL.</FONT
></STRONG
>  If you don't see Java GUI windows pop up like those in <A
HREF="#RETRIEVE.FIG"
>Figure 8</A
> and <A
HREF="#DEFAULT.FIG"
>Figure 9</A
>, you can use this step to install incat on a local machine. </P
><P
></P
><UL
><LI
><P
>            Copy the <TT
CLASS="FILENAME"
>incaInstall.sh</TT
> script to a local machine.
          </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% wget http://inca.sdsc.edu/releases/2.6/incaInstall.sh</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>            Install incat on a local machine:
          </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./incaInstall.sh $INCA_DIST incat</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>            Copy the incat key, certificate, and trusted directory from the original machine 
        to your local machine:
          </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% scp <STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/incatkey.pem $INCA_DIST/etc/
% scp <STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/incatcert.pem $INCA_DIST/etc/
% scp "<STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/trusted/*" $INCA_DIST/etc/trusted/</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>Edit the <TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> local file and change the incat key/cert to the incat key/cert:
            <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>17 inca.incat.cert=incatcert.pem
...
29 inca.incat.key=incatkey.pem</PRE
></FONT
></TD
></TR
></TABLE
>
          </P
></LI
><LI
><P
> Start the incat component on a local machine with the agent hostname from the original machine: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca start incat -A <STRONG
><FONT
COLOR="RED"
>ORIGHOST</FONT
></STRONG
>:6323 &#38;</PRE
></FONT
></TD
></TR
></TABLE
></LI
></UL
></LI
></OL
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT"
>5. Administering Inca with incat</A
></H2
><P
>  Inca provides a graphical administration tool, named incat, that allows you
  to configure your deployment.  Using incat, you can specify the repositories
  from which Inca should retrieve reporters, the hosts where you wish to
  run reporters, and which reporters you wish to run on each host.
  <P
><IMG
SRC="figures/arch/arch-incat.jpg"
ALIGN="CENTER"></P
>
  </P
><P
>  You can connect incat to a running Inca Agent via the
  -A option, e.g., "cd $INCA_DIST; ./bin/inca start incat -A localhost:6323".
  </P
><P
>  As mentioned in the <A
HREF="#QS-STEP5"
>Quick Start guide</A
>, you
  can execute "./bin/inca default" from the command line to install a default Inca configuration.
  The discussion below describes how you would use incat to specify the same
  configuration.  Before continuing, use the inca script to start both a Depot
  and an Agent on your host.
  </P
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-REPOS"
>5.1. Repositories</A
></H3
><P
>  Incat begins by showing the panel for Inca reporter repositories (as shown in <A
HREF="#INCAT.REP.FIG"
>Figure 10</A
>).  
  The default Inca configuration retrieves reporters from the 
  $INCA_DIST/Inca-Reporter-* repository on the agent machine.  To add this repository to your list, press the Add button in the
  Repositories section, enter the file:/ location of the Packages.gz file
  in the pop-up window that appears, then press the OK button.  Within a few
  seconds you should see the repository appear in the Repositories list, a
  set of reporters in the Reporters list, and properties for the first reporter
  in the Reporter Properties list.  Reporter source code is viewable by double clicking on a reporter name or by selecting 
  the reporter name and pressing the "Show" button.
  </P
><DIV
CLASS="FIGURE"
><A
NAME="INCAT.REP.FIG"
></A
><P
><B
>Figure 10. Incat Repositories Tab</B
></P
><P
><IMG
SRC="figures/incat/incat-annotated-repository.jpg"
ALIGN="CENTER"></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-RESOURCES"
>5.2. Resource Configuration</A
></H3
><P
>  The default Inca configuration defines three resource groups -- a group called "localResource" that
  specifies the host where the Inca Agent will launch a new Reporter Manager (localhost) and two container groups called "localSite" (contains "localResource") and "defaultGrid" (contains "localSite") that can be extended to include any other hosts running Reporter Managers.  The default resource configuration 
  is shown is <A
HREF="#INCAT.RES.FIG"
>Figure 11</A
>.  
  </P
><DIV
CLASS="FIGURE"
><A
NAME="INCAT.RES.FIG"
></A
><P
><B
>Figure 11. Incat Resource Configuration Tab</B
></P
><P
><IMG
SRC="figures/incat/incat-annotated-resource.jpg"
ALIGN="CENTER"></P
></DIV
><P
>  The configuration above can be duplicated in an empty Inca installation by 
  pressing the Resource Configuration tab near the top of the incat window and then entering
  information about the hosts on which you want Inca to run reporters.
  To define the default groups above in incat, press the Add button in the Resource Groups section to
  open the resource group edit dialog shown in <A
HREF="#INCAT.RES.ADD.FIG"
>Figure 12</A
>.
  </P
><DIV
CLASS="FIGURE"
><A
NAME="INCAT.RES.ADD.FIG"
></A
><P
><B
>Figure 12. Incat Add Resource Dialog</B
></P
><P
><IMG
SRC="figures/incat/incat-annotated-resource-add.jpg"
ALIGN="CENTER"></P
></DIV
><P
>  In the Group Name text box, enter the name "localResource" as a nickname for the machine the Reporter Manager client runs on. 
  Enter "localhost" in the Members text box and select "local" as the access method (for a description 
  of access methods see <A
HREF="#ACCESS-METHODS"
>Section 5.5</A
>).
  Press OK to complete entry of this resource group.  Incat will close the
  resource group edit dialog and will display localResource in the Resource Groups
  section of the Resource Configuration panel.
  </P
><P
>  Press the Add button again to add a second resource group.  Give this one
  the name "defaultGrid" and enter "localResource" in the Members text box.  This tells
  incat that any hosts in the "localResource" group (localhost, in this case) are also
  part of the defaultGrid group.  If you defined other groups, "siteB", "siteC",
  etc., you could include these in defaultGrid by listing them in the Members
  text box, separated by spaces.  Press OK to complete entry of this resource
  group.  In the Resource Groups list, select each group and notice that localhost is listed in the 
  the Members panel.
  </P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-SUITES"
>5.3. Suites</A
></H3
><P
>  Pressing the Suites tab near the top of the incat window takes you to incat's
  suite/series specification panel.  Here you specify the reporters you want to
  run, the resource groups to run them on, how frequently to run them, and the
  arguments to use when running them.
  </P
><P
>  The default Inca configuration defines a single suite named sampleSuite
  that contains eight series as shown in <A
HREF="#INCAT.SUITE.FIG"
>Figure 13</A
>.  
  <DIV
CLASS="FIGURE"
><A
NAME="INCAT.SUITE.FIG"
></A
><P
><B
>Figure 13. Incat Suite Tab</B
></P
><P
><IMG
SRC="figures/incat/incat-annotated-suite.jpg"
ALIGN="CENTER"></P
></DIV
>
  </P
><P
>  In a new Inca installation, you can add the default suite above by pressing Add button in the Suites section of
  the panel, entering "sampleSuite" in the pop-up window, then pressing the OK
  button.  To add series to the new suite, press the Add
  button in the Series section to open the incat series dialog and configure each like the gcc_hello_world series in <A
HREF="#INCAT.SERIES.FIG"
>Figure 14</A
>.
  <DIV
CLASS="FIGURE"
><A
NAME="INCAT.SERIES.FIG"
></A
><P
><B
>Figure 14. Incat Series Configuration</B
></P
><P
><IMG
SRC="figures/incat/incat-annotated-series.jpg"
ALIGN="CENTER"></P
></DIV
>
  </P
><P
>  The bottommost box in the series dialog allows you to test the output of the
  reporter and send email or take other actions if the test fails.  This is
  covered in <A
HREF="#USERGUIDE-INCAT-COMPARISON"
>Section 5.9</A
> below; for this series
  leave this box blank.  Press the OK button, and incat will close the series
  dialog box and add the series to the Series list in the
  suite/series specification panel.
  </P
><P
>  The other nine series in the default Inca configuration are composed
  similarly to the first one.  Press the Add button in the series section for
  each of them, then set the values in the series dialog as specified in the
  table below.  Set the log argument for each series to 3 and the frequency to
  10 minutes.
  </P
><DIV
CLASS="TABLE"
><A
NAME="AEN318"
></A
><P
><B
>Table 1. Default Configuration Series</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><THEAD
><TR
><TH
><P
>Reporter</P
></TH
><TH
><P
>Nickname</P
></TH
><TH
><P
>Arguments</P
></TH
></TR
></THEAD
><TBODY
><TR
><TD
><P
>cluster.admin.ant.unit</P
></TD
><TD
><P
>ant_helloworld_compile_test</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>cluster.admin.ant.version</P
></TD
><TD
><P
>ant_version</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>cluster.compiler.gcc.version</P
></TD
><TD
><P
>gcc_version</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>cluster.compiler.any.unit</P
></TD
><TD
><P
>java_hello_world</P
></TD
><TD
><P
>compiler: javac; lang: java</P
></TD
></TR
><TR
><TD
><P
>cluster.java.sun.version</P
></TD
><TD
><P
>java_version</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>cluster.interactive_access.openssh.version</P
></TD
><TD
><P
>openssh_version</P
></TD
><TD
><P
>ssh: ssh</P
></TD
></TR
><TR
><TD
><P
>cluster.security.openssl.version</P
></TD
><TD
><P
>openssl_version</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>viz.lib.vtk-nvgl.version</P
></TD
><TD
><P
>vtk-nvgl_version</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>grid.wget.unit</P
></TD
><TD
><P
>wget_page_test</P
></TD
><TD
><P
>page: http://cnn.com/index.html</P
></TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-COMMITS"
>5.4. Committing/Saving</A
></H3
><P
>  Your Inca deployment configuration is now complete.  At this point, it's a
  good idea to use the "Save" option in incat's File menu to write the
  configuration to a file (<A
HREF="#INCAT.SAVE.FIG"
>Figure 15</A
>).  That way, you have a local copy of the configuration
  that you can later modify.  The file is formatted XML; if you're curious, you
  can read through it to see how incat represents the information you've
  entered.
  <DIV
CLASS="FIGURE"
><A
NAME="INCAT.SAVE.FIG"
></A
><P
><B
>Figure 15. Incat Save Configuration to File</B
></P
><P
><IMG
SRC="figures/incat/save.jpg"
ALIGN="CENTER"></P
></DIV
>
  </P
><P
>  Although your configuration is complete, it's not yet active.  To tell Inca
  to begin running reporters, you need to have incat send your configuration to
  your Inca Agent.  If you started incat with the -A argument, then you're
  already connected to your Agent.  Otherwise, use the "Connect" option in
  incat's Agent menu to establish a connection.  Once you're connected, you can
  use the "Commit" option in the Agent menu to send the configuration to the
  Agent (<A
HREF="#INCAT.COMMIT.FIG"
>Figure 16</A
>).  In response, the Agent will install the Inca Reporter Manager code on
  the host specified in incat's "Resource Configuration" panel and begin running the reporters you specified in the "Suite Series" panel.
  <DIV
CLASS="FIGURE"
><A
NAME="INCAT.COMMIT.FIG"
></A
><P
><B
>Figure 16. Incat Save Configuration to Agent</B
></P
><P
><IMG
SRC="figures/incat/commit.jpg"
ALIGN="CENTER"></P
></DIV
>
  </P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="ACCESS-METHODS"
>5.5. Resource Access Methods</A
></H3
><P
>  The Inca Agent can use the following access methods to stage and start
  Reporter Managers on resources:
  </P
><P
></P
><UL
><LI
><P
>ssh:</P
><P
>  The most common access method.  The Agent starts a Reporter Manager on a
  remote machine using ssh to access the remote machine.  The Agent must have
  ssh key access to the remote machine.
  Reporter Manager files are copied from the Agent to the
  remote machine using sftp.  For ssh resource groups, incat provides text
  boxes for you to enter the login id, password, and path to the ssh key file
  on the Agent machine.  For security purposes, incat displays asterisks for
  the password and encrypts it when you save the configuration to a file.
  </P
></LI
><LI
><P
>globus2:</P
><P
>  The Agent starts a Reporter Manager on a remote machine using Globus PreWS to
  access the remote machine.  Reporter Manager files are copied from the Agent
  to the remote machine using GridFTP.  When you select globus2 in the Access
  Method pull-down, incat provides text boxes for you to enter contact
  information for the resource's Globus GRAM and GridFTP servers.  If you leave
  these boxes blank, Inca defaults to ports 2119 and 2811, respectively, for
  the first host in the resource group's member list.  Access to Globus hosts
  requires an active Globus proxy on the Agent's host.  You can either create a
  manual proxy on the Agent machine before starting, or you can store a proxy
  on a myproxy server and complete the four incat proxy dialog boxes (see
  <A
HREF="#PROXIES"
>Section 5.7</A
>) so that the Agent can obtain one as needed.
  </P
></LI
><LI
><P
>globus4:</P
><P
>  The Agent starts a Reporter Manager on a remote machine using Globus WS to
  access the remote machine.  Reporter Manager files are copied from the Agent
  to the remote machine using GridFTP.  When you select globus4 in the Access
  Method pull-down, incat provides text boxes for you to enter contact
  information for the resource's Globus WS GRAM and GridFTP servers.  If you leave
  these boxes blank, Inca defaults to ports 8443 and 2811, respectively, for
  the first host in the resource group's member list.  Access to Globus hosts
  requires an active Globus proxy on the Agent's host.  You can either create a
  manual proxy on the Agent machine before starting, or you can store a proxy
  on a myproxy server and complete the four incat proxy dialog boxes (see
  <A
HREF="#PROXIES"
>Section 5.7</A
>) so that the Agent can obtain one as needed.
  </P
></LI
><LI
><P
>local:</P
><P
>  The Agent starts a Reporter Manager on the same machine where the Agent is
  running (localhost).  
  </P
></LI
><LI
><P
>manual:</P
><P
>  Entering a manual resource group indicates that you want complete, direct
  control over Inca execution on the group.  For a manual resource group you
  must start the Reporter Manager on the command line and restart it any time
  you want to change the reporter series configuration for the group.  The
  Agent will NOT automatically start a Reporter Manager for a manual resource
  as it will for local, ssh, or globus2 resources.  See
  <A
HREF="#USERGUIDE-ADVANCED-MANUAL"
>Section 11.6</A
> for more details.
  </P
></LI
></UL
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-CHANGE-APPROVAL"
>5.6. Requiring Resource Administrator Approval</A
></H3
><P
> By default, Inca installation changes take effect automatically once
you commit them to the Agent.  In circumstances where Inca changes must be
approved before they take effect, enter the approver's email address in the
"Approval Email" text box of the resource edit dialog.  When changes to the
Inca installation on this resource are committed, Inca will send approval
instructions to the email specified in the resource dialog.  Note that
a run now request as described in <A
HREF="#USERGUIDE-INCAT-SUITES"
>Section 5.3</A
>
is not considered a change and will be forwarded automatically if that series
has already been approved.</P
><P
><IMG
SRC="figures/incat/approval.png"
ALIGN="CENTER"></P
><P
>The emailed approval instructions will look like the image below by
default and will describe how changes can be approved using Inca's
<TT
CLASS="FILENAME"
>approveChanges</TT
> command.  To customize the approval
instruction email edit <TT
CLASS="FILENAME"
>$INCA_DIST/etc/approveEmail.txt</TT
>.</P
><P
><IMG
SRC="figures/admin/ug-approvalEmail.png"
ALIGN="CENTER"></P
><P
> The <TT
CLASS="FILENAME"
>approveChanges</TT
> command allows viewing and
approval of the individual changes committed using incat.   Use the 
<TT
CLASS="FILENAME"
>--help</TT
> flag with the <TT
CLASS="FILENAME"
>approveChanges</TT
> 
command to see all possible options.  After <TT
CLASS="FILENAME"
>approveChanges</TT
> 
 is invoked, the approver will see a
text menu like the one in the screen below with a list of proposed changes.
More information about each change is viewable by hitting ctrl-y.  By default
all changes are checked.  If any proposed changes are incorrect for their
system, the approver should uncheck them by hitting space.  After checking only
correct changes for their resource, the approver should hit ctrl-s to approve
the selected changes.  The Agent will only transmit approved changes to the
resource.   The proposed changes not approved will remain in the queue and
indicate that the Inca administrator has incorrect information about the
resource.  The approver should notify their Inca administrator of these errors
to correct their proposed changes list.  </P
><P
><IMG
SRC="figures/admin/ug-approve.png"
ALIGN="CENTER"></P
><P
>The image below shows an example of more information about a change 
 (viewable by hitting ctrl-y).  In this example a change to the series logging 
is represented by the before and after values separated by the "=&#62;" symbol and the 
green color highlighting the new log and context values. If colors aren't viewable 
in your terminal, try setting the TERM environment variable to "xterm-color".</P
><P
><IMG
SRC="figures/admin/approveChanges.gif"
ALIGN="CENTER"></P
><P
>Here the <TT
CLASS="FILENAME"
>approveChanges</TT
> command was invoked using the 
<TT
CLASS="FILENAME"
>--color=blue,red,green</TT
> flag to show unchanged attributes in blue, 
changed attributes in red and new values in green.  Edit the 
<TT
CLASS="FILENAME"
>$INCA_DIST/etc/approveEmail.txt</TT
> file to add your own 
color preferences.</P
><P
><IMG
SRC="figures/admin/approveChanges-color2.gif"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="PROXIES"
>5.7. Proxies</A
></H3
><P
>For convenience, the Inca framework can be used to retrieve a proxy for the
globus2 access method or for reporters that require an active proxy.
Reporters that require a proxy should use the Inca::Reporter::GridProxy 
module described in <A
HREF="#REPORTER-API"
>Section 7.2.3</A
>.  </P
><P
>Before configuring Inca to retrieve proxies, first store a proxy on a myproxy
server.  For information about setting up a myproxy server or storing proxies
on a server, please see <A
HREF="http://grid.ncsa.uiuc.edu/myproxy/"
TARGET="_top"
>the
official myproxy documentation</A
>.</P
><P
>The Agent can automatically retrieve a proxy from a myproxy server if the proxy
information is defined in incat as follows:</P
><P
><IMG
SRC="figures/incat/incat-annotated-resource-proxy.jpg"
ALIGN="CENTER"></P
><P
>The dialog boxes are the hostname of the myproxy server, the username and password used to store the proxy, and the lifetime in hours that the agent should retrieve a proxy for (the default is 12 hours).</P
><P
>Once proxy information is committed to the agent, it can be retrieved by reporter managers. Each time a reporter manager is ready to run a reporter that needs a proxy it:
<P
></P
><UL
><LI
><P
>requests the MyProxy passphrase from the agent</P
></LI
><LI
><P
>uses the MyProxy command-line client to retrieve proxy credentials from a MyProxy server</P
></LI
><LI
><P
>clears the MyProxy passphrase from memory</P
></LI
></UL
></P
><P
>The MyProxy passphrase is stored on the agent in the $INCA_DIST/var/resources.xml file and is 
encrypted with the same passphrase as the agent's private key.  The MyProxy passphrase passes between the 
reporter manager and agent over their SSL connection.
  <P
><IMG
SRC="figures/arch/arch-proxy.jpg"
ALIGN="CENTER"></P
>
  </P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-MACROS"
>5.8. Using Resource Macros</A
></H3
><P
>  Resource macros provide a shorthand for defining multiple, similar series.
  For example, suppose you wanted to add three series to the configuration
  defined above to measure the ping time to three different hosts, named
  blue.ufo.edu, green.ufo.edu, and red.ufo.edu.  One approach would be to
  define a series for blue, use the Clone button in the Series section
  of the Suites panel to make two copies, then modify them to ping green and
  red.
  </P
><P
>  A better approach is to use a macro for the host names and let Inca replicate
  the series for you.  In the Resource Configuration panel, click on
  defaultGrid in the Resource Group section.  Next, press the Add button
  beneath the Macros section.  This opens a dialog box that allows you to enter
  the name and value(s) of a macro associated with the current resource group.
  <P
><IMG
SRC="figures/incat/incat-annotated-macro-dialog.png"
ALIGN="CENTER"></P
>
  </P
><P
>  Enter "targets" in the Macro Name text box and "blue" in the macro value edit
  box, then use the "Add" button or hit "enter/return" to add "green" and
  "red" as the second and third values of the macro.  Afterwards, press OK.
  The definition of the targets macro now appears in the Macros section of the
  Resource Configuration panel.  You may also edit values in the list by
  selecting them, changing the value in the edit value box, and hitting
  "enter/return".  To delete macro values, select the value in the list
  and press the "Delete" button.
  <P
><IMG
SRC="figures/incat/macro1.jpg"
ALIGN="CENTER"></P
>
  </P
><P
>The targets macro is also defined for the other resource groups since
  the defaultGrid contains all other groups.  As shown in
  <A
HREF="#INCAT.MACRO2.FIG"
>Figure 17</A
>, macros appear grey if they were defined in
  a resource group other than the one selected.  You can override an inherited
  macro value by selecting the macro in the Macros panel and pressing the Edit
  button to open the macro edit dialog.  After you change the macro value and
  press OK, the updated macro definition will show in black in the Macros
  panel, indicating that the resource is no longer using the inherited value.
  <DIV
CLASS="FIGURE"
><A
NAME="INCAT.MACRO2.FIG"
></A
><P
><B
>Figure 17. Inherited Macro</B
></P
><P
><IMG
SRC="figures/incat/macro2.jpg"
ALIGN="CENTER"></P
></DIV
>
  </P
><P
>  To make use of the macro you've defined, click the Suites tab, then press the
  Add button underneath the Series section to open the series edit dialog.  In
  the dialog, set the reporter to grid.benchmark.performance.ping and the
  resource group to localResource.
  </P
><P
>  In the host text box in the Arguments section of the dialog, enter
  "@targets@.ufo.edu".  Macro references in incat are indicated by placing a
  "@" before and after the macro name.  When the Inca Agent encounters a macro
  reference in a series, it makes one copy of the series for each value of the
  macro.  Since the targets macro has three values--blue, green, and red--the
  Inca Agent will make three copies of this series, substituting a single value
  for the macro reference in each.  In this case that means that you'll have
  one series with a host argument of "blue.ufo.edu", one with a host argument
  of "green.ufo.edu", and one with a host argument of "red.ufo.edu".
  </P
><P
>  The inca web pages use the series nickname when displaying series results.
  If you leave the series nickname with its default value, the name of the
  reporter, then all three series will have the same nickname.  Instead, you
  can enter "ping_to_@targets@" in the nickname text box.  The Inca Agent will
  expand this reference in parallel with the reference in the host argument, so
  your three series will have the nicknames ping_to_blue, ping_to_green, and
  ping_to_red, respectively.
  </P
><P
><IMG
SRC="figures/incat/macro3.jpg"
ALIGN="CENTER"></P
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-ALL2ALL"
>5.8.1. Configuring "all2all" Series</A
></H4
><P
>The "all2all" test results are calculated by the consumer.  Generally "all2all" series 
  are cross-site tests.  The images below illustrates an example of configuring an "all2all" ping series. 
  </P
><P
>First a new suite called "cross-site" is added to contain the series for our "all2all" tests:
  <P
><IMG
SRC="figures/incat/all2all-suite.jpg"
ALIGN="CENTER"></P
>
  </P
><P
>Next we select the cross-site test that we'll execute (grid.benchmark.performance.ping) and configure 
  the targets with a "pingHosts" macro.  The consumer detects that this is an all2all series
  because the nickname and context contain all2all strings as described in the image below:
  <P
><IMG
SRC="figures/incat/incat-annotated-all2all.jpg"
ALIGN="CENTER"></P
>
  </P
><P
>In addition to configuring the actual all2all tests, we also configure a summary series for the
  latest pass/fail results of each all2all test.  This summary will be used by the All2AllFilter described in <A
HREF="#ALL2ALL-FILTER"
>Section 11.3.2</A
> to determine which resource is responsible for a failure.  For example, in the example above we created
  an all2all ping test to be executed on the defaultGrid resource group.  Each of defaultGrid resources is pinging three other resources: cuzco.sdsc.edu, inca.sdsc.edu and badhost.sdsc.edu.  The summary series will find the latest results for each of the resources being pinged in order to assess whether a new failure is the fault of the resource doing the ping or the resource being pinged.  For example, if two of the three resources in the defaultGrid group are unable to ping badhost.sdsc.edu, when the third resource in defaultGrid goes to ping badhost.sdsc.edu and fails we know that it's the fault of badhost.sdsc.edu and not the third resource (or subsequently any other resource until badhost.sdsc.edu is fixed).  Based on the results of the summary series, the All2AllFilter would mark this third resource as "NOT_AT_FAULT" for failing to ping badhost.sdsc.edu.</P
><P
>To configure a summary series for all2all tests, make a new series that will execute the "summary.successpct.performance" reporter with the following parameters:</P
><P
></P
><UL
><LI
><P
>"Context": contains a similar "nickname=all2all:testName_to_.*" string as the all2all tests being summarized. Note that ".*" replaces the "@pingHosts@" macro used above since we're only creating one series.  </P
></LI
><LI
><P
>"filter": same as the Context string minus "nickname=".  The reporter will get the latest results for all series whose nickname matches this string.</P
></LI
><LI
><P
>"ignoreErr": the regular expression that the summary reporter looks for in error strings when counting failures and if it finds it then the errors are marked neutrally.</P
></LI
><LI
><P
>"restId", "server" and "type": tell the reporter where to get the latest test results (in this example via the consumer at rocks-101.sdsc.edu using the "rest" URL).</P
></LI
><LI
><P
>"suite": the suite the all2all tests being summarized can be found in.</P
></LI
><LI
><P
>"wgetArgs": extra arguments to use when wget'ing the test results.</P
></LI
></UL
><P
>  <P
><IMG
SRC="figures/incat/incat-annotated-summary-reporter.jpg"
ALIGN="CENTER"></P
>
  </P
><P
>The results of the all2all tests configured above are shown in the following image.  Note that while the single summary series produces all the boxes in the "SUMMARY" column, each of the other boxes represents a unique series.
  <P
><IMG
SRC="figures/consumer/all2all-suite-before-filter.jpg"
ALIGN="CENTER"></P
>
  </P
><P
>After we add the All2AllFilter described in <A
HREF="#ALL2ALL-FILTER"
>Section 11.3.2</A
> the results 
  also show when an individual resource is not at fault for the error.  Error messages are prefixed with 
  "NOT_AT_FAULT" and marked neutrally in stylesheets ("noFault") and history graphs:
  <P
><IMG
SRC="figures/consumer/all2all-suite-after-filter.jpg"
ALIGN="CENTER"></P
>
  </P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-COMPARISON"
>5.9. Series Comparison and Notification</A
></H3
><P
>  For a particular series, the Inca system by default reports only whether or
  not the series reporter was able to execute successfully--whether a version
  reporter was able to determine a package version, a unit reporter was able to
  run a program, etc.  Using Inca's comparison and notification feature, you
  can refine a series to define success more precisely and to receive
  notification from Inca when a series reporter detects a problem.  The bottom
  text boxes of the series edit dialog provide access to Inca's comparison
  and notification feature.
  </P
><P
><IMG
SRC="figures/incat/incat-annotated-gcc-version.jpg"
ALIGN="CENTER"></P
><P
>  The comparison expression can test the content of the report body, the content of the
  report error message, or the value of any symbols defined in the report body
  by &#60;ID&#62; tags.  The expression may use any of the boolean operators
  &#60;, &#60;=, &#62;, &#62;=, ==, and !=, plus perl's pattern match (=~) and
  mismatch (!~) operators.  One simple test would be "body =~ /./", which would
  test whether the report body contained any characters.  Tests can be joined
  together by the &#38;&#38; and || operators.  Using these, you could ignore
  an expected, minor error with the test
  "body =~ /./ || errorMessage == 'Try again later'".
  </P
><P
>  As mentioned above, you can include symbols defined in the report body in
  your tests.  The Inca system uses the content of any subsequent tag as the
  symbol value.  For example, the body of the output of the gcc version
  reporter might be
  </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>  &#60;body&#62;
    &#60;package&#62;
      &#60;ID&#62;gcc&#60;/ID&#62;
      &#60;version&#62;3.1&#60;/version&#62;
    &#60;/package&#62;
  &#60;/body&#62;
  </PRE
></FONT
></TD
></TR
></TABLE
><P
>  Here, Inca will use "3.1" as the value of the symbol "gcc".  With this
  output, the comparison test "gcc &#62;= 3.0" would succeed, while the
  comparison "gcc == 3.0" would fail.  If the report body contains an
  &#60;ID&#62; tag with no subsequent tag, the value of the symbol is defined
  to be "".
  </P
><P
>The image below illustrates how a comparison for subpackage versions
        would be configured. 
  <P
><IMG
SRC="figures/incat/incat-annotated-subpackage-version.jpg"
ALIGN="CENTER"></P
>
  </P
><P
>  Inca supports the ability to run a script that notifies you of changes in a
  series comparison.  When you specify a series comparison in the incat series
  dialog, two additional components become visible.  The Notification Script
  pull-down menu allows you to select the script to run, and the Script
  Parameters text box allows you to enter parameters to pass to the script.
  By default, the Inca installation provides two notification scripts,
  EmailNotifier and LogNotifier.  The first sends email to each address
  specified by the script parameters; the second writes a message to the
  specified log file.  See <A
HREF="#CUSTOM-NOTIFICATION"
>Section 11.2</A
>
  for directions on customizing the notifications you receive.
  </P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-CONSUMER"
>6. Data Display (Data Consumers)</A
></H2
><P
>  The data that the Inca depot stores can be displayed in many ways, such as
  current status reports, historical graphs, and customized status information.
  An Inca data consumer is anything that
  retrieves data from the depot and displays it (e.g. a JSP, SQL query, CGI,
  etc.).  The Inca depot provides access to stored data via Perl and Java
  client APIs (see <A
HREF="#USERGUIDE-APIS"
>Section 8</A
>).
  </P
><P
><IMG
SRC="figures/arch/arch-consumer.jpg"
ALIGN="CENTER"></P
><P
>  The data consumer packaged with Inca is a collection of
  <A
HREF="http://java.sun.com/products/jsp/"
TARGET="_top"
>JavaServer Pages (JSP)</A
>
  and associated files.  The consumer is installed in
  <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/inca</TT
> and is deployed with
  <A
HREF="http://www.mortbay.org/"
TARGET="_top"
>Jetty</A
> when the consumer is
  started (e.g., ./bin/inca start consumer).  The consumer
  listens on ports 8080 (HTTP) and 8443 (HTTPS) unless
  <TT
CLASS="FILENAME"
>$INCA_DIST/etc/jetty.xml</TT
> is edited as described in
  <A
HREF="#CONSUMER-PORT"
>Section 6.11</A
>.  
  </P
><P
>  The default consumer's JSPs query the depot for XML results and
  either apply XSL to them in order to display HTML status pages or 
  parse out data and display it in graphs.  The figure below shows
  the default menu header.  Each menu item invokes a JSP as
  described in the sections below.
  </P
><P
><IMG
SRC="figures/consumer/menuOverview.jpg"
ALIGN="CENTER"></P
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="CURRENT-DATA"
>6.1. Current Data</A
></H3
><P
>    The default page header navigation contains links to tabular and map view
    result summaries for the sample suite.  To add other current data pages
    under this heading (e.g., result summary tables for additional suites),
    customize the <TT
CLASS="FILENAME"
>header.xsl</TT
> file as described in
    <A
HREF="#CUSTOM-HTML-HEADER"
>Section 6.8.3</A
>.
    </P
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="TABLE-SUMMARY"
>6.1.1. Tabular Suite Summary View</A
></H4
><P
>      The first item in the CURRENT DATA menu executes
      <TT
CLASS="FILENAME"
>status.jsp</TT
> with <TT
CLASS="FILENAME"
>default.xsl</TT
> to
      create a summary table of suite results. 
      This JSP takes comma-delimited lists in its suiteNames and optional
      resourceIds parameters that specify the suites and resources to be shown.
      The default installation invokes
      <A
HREF="http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite&#38;resourceIds=defaultGrid"
TARGET="_top"
>      http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite&#38;resourceIds=defaultGrid</A
>,
      producing an image similar to this one:
      <P
><IMG
SRC="figures/consumer/sum_page2.jpg"
ALIGN="CENTER"></P
>
      If you omit resourceIds, then all resources will be displayed for each
      suite.
      </P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="REST"
>6.1.2. REST URLs</A
></H4
><P
>Inca also provides the ability to fetch data in XML or HTML
      format using REST urls.  By default, the consumer recognizes a 
      REST url using the following format:
      </P
><P
><TT
CLASS="FILENAME"
>http://localhost:8080/inca/XML|HTML/rest/&#60;suiteName&#62;[/&#60;resourceId&#62;[/&#60;seriesNickname&#62;[/week|month|quarter|year]]]</TT
></P
><P
>For example, the url</P
><P
><A
HREF="http://localhost:8080/inca/HTML/rest/sampleSuite"
TARGET="_top"
>http://localhost:8080/inca/HTML/rest/sampleSuite</A
></P
><P
>is equivalent to</P
><P
><A
HREF="http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite"
TARGET="_top"
>http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite</A
>.</P
><P
>Likewise, the url </P
><P
><A
HREF="http://localhost:8080/inca/HTML/rest/sampleSuite/defaultGrid"
TARGET="_top"
>http://localhost:8080/inca/HTML/rest/sampleSuite/defaultGrid</A
></P
><P
>is equivalent to</P
><P
><A
HREF="http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite&#38;resourceIds=defaultGrid"
TARGET="_top"
>http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite&#38;resourceIds=defaultGrid</A
>.</P
><P
>Specific resources can also be specified as resourceId, </P
><P
><A
HREF="http://localhost:8080/inca/HTML/rest/sampleSuite/localResource"
TARGET="_top"
>http://localhost:8080/inca/HTML/rest/sampleSuite/localResource</A
></P
><P
>The latest instance of a test can also be retrieved as follows:</P
><P
><A
HREF="http://localhost:8080/inca/HTML/rest/sampleSuite/localResource/ant_version"
TARGET="_top"
>http://localhost:8080/inca/HTML/rest/sampleSuite/localResource/ant_version</A
></P
><P
>Historical results for a test can also be retrieved for a week, month, quarter or year.  For example:</P
><P
><A
HREF="http://localhost:8080/inca/HTML/rest/sampleSuite/localResource/ant_version/week"
TARGET="_top"
>http://localhost:8080/inca/HTML/rest/sampleSuite/localResource/ant_version/week</A
></P
><P
>If you want to fetch the data in XML, just replace HTML 
      as below:</P
><P
><A
HREF="http://localhost:8080/inca/XML/rest/sampleSuite/localResource"
TARGET="_top"
>http://localhost:8080/inca/XML/rest/sampleSuite/localResource</A
></P
><P
>If you would like to change the id 'rest' to a more transparent id
      such as 'kit-status-v1', edit &#60;context-param&#62; in 
      <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/inca/WEB-INF/web.xml</TT
> and restart the consumer.
      For example, change </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;context-param&#62;
        &#60;param-name&#62;restId&#60;/param-name&#62;
        &#60;param-value&#62;rest&#60;/param-value&#62;
      &#60;/context-param&#62;
      </PRE
></FONT
></TD
></TR
></TABLE
><P
>to</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;context-param&#62;
        &#60;param-name&#62;restId&#60;/param-name&#62;
        &#60;param-value&#62;kit-status-v1&#60;/param-value&#62;
      &#60;/context-param&#62;
      </PRE
></FONT
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="GOOGLE"
>6.1.3. Map View using Google Map API</A
></H4
><DIV
CLASS="SECTION"
><H5
CLASS="SECTION"
><A
NAME="GOOGLE-OVERVIEW"
>6.1.3.1. Overview</A
></H5
><P
>        The second item in the CURRENT DATA menu executes
        <TT
CLASS="FILENAME"
>status.jsp</TT
> using <TT
CLASS="FILENAME"
>google.xsl</TT
> 
        to display a map that provides a
        summary of the current status of resources.  For each resource, the map
        view gives the percentage of reports passed, number of passed reports,
        number of failed reports, and a list of the failed tests with a link to
        each report details page.  A resource is represented on the map as a
        marker and colored red, green, or orange based on the number of tests
        that have passed and/or failed.  The figure below shows the Inca Google
        map view for the NEON testbed (four resources at SDSC and one resource
        at James Reserve).  All resources are passing their tests, so every
        resource marker is green.
        </P
><P
><IMG
SRC="figures/consumer/googleNeon.png"
ALIGN="CENTER"></P
><P
>        Clicking on a marker displays a pop-up with the name of the
        resource and its status information as show below.
        </P
><P
><IMG
SRC="figures/consumer/googleNeonInfo.png"
ALIGN="CENTER"></P
><P
>        Clicking on the "Toggle ping status" button displays the status of the
        cross-site ping test as show below.
        </P
><P
><IMG
SRC="figures/consumer/googleNeonPing.png"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><HR><H5
CLASS="SECTION"
><A
NAME="GOOGLE-SETUP"
>6.1.3.2. Setting up Google Map View</A
></H5
><P
>The Inca map views can be configured using the page described in <A
HREF="#CONFIG-CONSUMER"
>Section 6.4.2</A
>.
        Use the options in <A
HREF="#GOOGLE-CONFIG"
>Section 6.1.3.2.1</A
> to configure maps for your site.</P
><P
>        To access the map view, you need to install a Google Maps API key in
        your Inca consumer.  To generate one, go the Google Maps API web page at
        <A
HREF="http://www.google.com/apis/maps/signup.html"
TARGET="_top"
>http://www.google.com/apis/maps/signup.html</A
>,
        type "http://<STRONG
><FONT
COLOR="RED"
>yourHost</FONT
></STRONG
>:8080" in the "My
        web site URL" text box, then click the "Generate API key" button.  A
        new page will display a key for your server that looks something like
        "ABQIAAAA_4IHDoSvxQqISMa1RKFLQBSSlCzupJMr-Xoh__duR37DAX9UVBRVn9-X9_4ILpmvilr4hN-QZU8pNQ".
        Copy this key, then use the configuration page 
        to replace "Insert key here" with your new Google Maps API key as shown below:
        <P
><IMG
SRC="figures/consumer/google-keys.gif"
ALIGN="CENTER"></P
>
        </P
><P
>If you have more than one alias for your Inca server, generate an API key for 
        each alias, click on the "Add Alias Key" in the configuration page and add your host alias in 
        hostname:port format.  Then expand the "keys" folder and complete the values 
        for each "key" folder, using your google map keys and their corresponding hostname:port 
        like the example below:
        <P
><IMG
SRC="figures/consumer/google-alias-keys.gif"
ALIGN="CENTER"></P
>
        </P
><P
>        Next give the map generator the locations of your resources.  Use the 
        configuration page to add/edit sites and resource like the one below:
        <P
><IMG
SRC="figures/consumer/google-sites.gif"
ALIGN="CENTER"></P
>
        </P
><P
>Provide a site name, latitude/longitude coordinates
        and a list of resources for each site.  
        Optionally, you can also specify a logo for the site. Specify the height and 
        width of the logo in pixels, angle from 0 degrees, and logo
        anchor coordinates (logoAnchorX/logoAnchorY) as
        shown in the figure below:
        <P
><IMG
SRC="figures/consumer/googleSite.png"
ALIGN="CENTER"></P
>
        </P
><DIV
CLASS="SECTION"
><HR><H6
CLASS="SECTION"
><A
NAME="GOOGLE-CONFIG"
>6.1.3.2.1. Google Map Options</A
></H6
><P
></P
><UL
><LI
><P
>  <EM
><FONT
>key:</FONT
></EM
> Google key for your Inca server.  If you have more than one alias for your web server, add key aliases for your server.</P
></LI
><LI
><P
>  <EM
><FONT
>width/height:</FONT
></EM
> The size of the map graphic (in pixels) that will be generated. By default the map is 800x500.</P
></LI
><LI
><P
>  <EM
><FONT
>center:</FONT
></EM
> The center of the map in latitude/longitude coordinates. By default, the center of the map corresponds to the center of the U.S.</P
></LI
><LI
><P
>  <EM
><FONT
>mapType:</FONT
></EM
> Type of map to display. By default the map is G_NORMAL_MAP.</P
><P
></P
><UL
><LI
><P
>  <EM
><FONT
>G_NORMAL_MAP:</FONT
></EM
> displays the default road map view.</P
></LI
><LI
><P
>  <EM
><FONT
>G_SATELLITE_MAP:</FONT
></EM
> displays Google Earth satellite images.</P
></LI
><LI
><P
>  <EM
><FONT
>G_HYBRID_MAP:</FONT
></EM
> displays a mixture of normal and satellite views.</P
></LI
><LI
><P
>  <EM
><FONT
>G_PHYSICAL_MAP:</FONT
></EM
> displays a physical map based on terrain information.</P
></LI
></UL
></LI
><LI
><P
>  <EM
><FONT
>magnificationLevel:</FONT
></EM
> The initial magnification, or zoom level, of the map expressed as a number between 1 and 12. Zoom level 1 displays the entire world, while zoom level 12 allows you to read street names.</P
></LI
><LI
><P
>  <EM
><FONT
>markerDist:</FONT
></EM
> The distance between resource markers at a site.  If there is more than one resource at a particular site, the resource markers will be arranged in a circle around the site center. By default, the distance between the markers will be determined so that the markers do not overlap each other.</P
></LI
><LI
><P
>  <EM
><FONT
>maxErrors:</FONT
></EM
> The maximum number of errors to display in the info window that is displayed when a resource is clicked.</P
></LI
><LI
><P
>  <EM
><FONT
>line:</FONT
></EM
> For cross-site tests, a line will be displayed between the two sites to indicate the test status.  If a suite contains a cross-site test, a button will be displayed below the map named "Toggle &#60;testName&#62; status". When the button is clicked, the status of an individual cross-site test will be expressed as a line in between the source resource and the destination resource. The color of the line used to represent the test status can be customized. By default, green represents the test passed and red represents the test failed. </P
></LI
><LI
><P
>  <EM
><FONT
>marker:</FONT
></EM
> Customize the look of the icon marker used to represent a resource on the map.
  A resource is represented by a Google marker and the color varies based on the number of tests that it failed:
  all tests passed = <IMG
SRC="figures/consumer/mm_20_green.png"
ALIGN="CENTER">, 
  at least one test failed = <IMG
SRC="figures/consumer/mm_20_orange.png"
ALIGN="CENTER">,
  all tests failed = <IMG
SRC="figures/consumer/mm_20_red.png"
ALIGN="CENTER">.  </P
><P
>Suppose you wanted to change the icons displayed to weather icons 
  so that all tests passed = <IMG
SRC="figures/consumer/icon33.png"
ALIGN="CENTER">, 
  at least one test failed = <IMG
SRC="figures/consumer/icon34.png"
ALIGN="CENTER">,
  all tests failed = <IMG
SRC="figures/consumer/icon36.png"
ALIGN="CENTER">. You would 
  first find the size of the icons and modify the iconWidth and iconHeight (in this case the weather icons are 32x32 pixels).
  Then pick the anchor point for the icon to be placed in relation to the resource's place on the map.  Since we want the middle of the icon to be placed on the map, we choose the coordinates (16, 16) and modify iconAnchorCoord.
   Next determine the anchor point for the info window to pop up relative to the icon.  Since we want the info window to appear in the top middle, we choose the coordinates (16, 10) and modify iconInfoWindowAnchorCoord. Then construct the icon URLs 
using the three weather icons located on the Google server at: <A
HREF="http://maps.google.com/mapfiles/kml/pal4/icon33.png"
TARGET="_top"
>http://maps.google.com/mapfiles/kml/pal4/icon33.png</A
>, <A
HREF="http://maps.google.com/mapfiles/kml/pal4/icon34.png"
TARGET="_top"
>http://maps.google.com/mapfiles/kml/pal4/icon34.png</A
>, <A
HREF="http://maps.google.com/mapfiles/kml/pal4/icon36.png"
TARGET="_top"
>http://maps.google.com/mapfiles/kml/pal4/icon36.png</A
>.  Set the following values: iconUrlPrefix="http://maps.google.com/mapfiles/kml/pal4/icon", iconStatus-&#62;fail="36", iconStatus-&#62;pass="33", iconStatus-&#62;warn="34", iconUrlSuffix=".png".
  Finally, specify the url for the shadow icon by setting shadowIconUrl="http://maps.google.com/mapfiles/kml/pal4/icon36s.png".</P
><P
></P
><UL
><LI
><P
>  <EM
><FONT
>iconWidth/iconHeight:</FONT
></EM
> size of icon in pixels.</P
></LI
><LI
><P
>  <EM
><FONT
>iconAnchorCoord:</FONT
></EM
> the coordinates of point inside the icon to be used for the anchor.</P
></LI
><LI
><P
>  <EM
><FONT
>iconInfoWindowAnchorCoord:</FONT
></EM
> where the anchor point for the info window should appear inside the icon.</P
></LI
><LI
><P
>  <EM
><FONT
>iconUrlPrefix/iconStatus/iconUrlSuffix:</FONT
></EM
> set of 3 icons to indicate the different resource status: pass/fail/warn based on the number of tests the resource passes.  The url for the 3 different images should have the same url pattern constructed by concatenating &#60;iconUrlPrefix&#62;, &#60;iconStatus&#62;/&#60;fail|pass|warn&#62;, and &#60;iconUrlSuffix&#62;.</P
></LI
><LI
><P
>  <EM
><FONT
>shadowIconUrl:</FONT
></EM
> url of a icon to use for the shadow of the resource icon.</P
></LI
><LI
><P
>  <EM
><FONT
>shadowIconWidth/shadowIconHeight:</FONT
></EM
>  the size of the shadow icon in pixels.</P
></LI
></UL
></LI
><LI
><P
>  <EM
><FONT
>sites:</FONT
></EM
>  The information about where to place resources in a site.  Can have multiple logos and resources for a site.  The logo angle/logoAnchorX/logoAnchorY are placement relative to the latitude/longitude.  Angle is the degrees from the site center (latitude/longitude).  For example, an angle of 0 will place the logo to the right of the resources, 180 to the left, 90 to the top, and 270 to the bottom.  logoAnchorX and logoAnchorY are used to indicate the coordinates relative to the image that should be placed on the map. For example, if your image is 12x12, using logoAnchorX=6 and logoAnchorY=6 will place the image in the center.</P
></LI
><LI
><P
>  <EM
><FONT
>debug:</FONT
></EM
>  For development purposes.  Will print out some log messages in a javascript window if greater than 0.</P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H5
CLASS="SECTION"
><A
NAME="GOOGLE-ACCESS"
>6.1.3.3. Accessing the Google Map View</A
></H5
><P
>        Once setup is complete, load the map view by selecting the "Map of
        sampleSuite results" item of the CURRENT DATA menu in
        the navigation bar.
        </P
><P
><IMG
SRC="figures/consumer/googleMapMenu.png"
ALIGN="CENTER"></P
><P
>        In the default installation, this links to
        <A
HREF="http://localhost:8080/inca/jsp/status.jsp?xsl=google.xsl&#38;xml=google.xml&#38;suiteNames=sampleSuite&#38;resourceIds=defaultGrid"
TARGET="_top"
>http://localhost:8080/inca/jsp/status.jsp?xsl=google.xsl&#38;xml=google.xml&#38;suiteNames=sampleSuite&#38;resourceIds=defaultGrid</A
>.
        This shows one resource and the Inca logo, similar to the map
        below.  The resource status for multiple suites can be shown by
        editing <TT
CLASS="FILENAME"
>header.xsl</TT
> to provide comma-delimited
        lists for <TT
CLASS="FILENAME"
>status.jsp</TT
>'s suiteNames and resourceIds
        parameters.
        </P
><P
><IMG
SRC="figures/consumer/googleDefaultMap.jpg"
ALIGN="CENTER"></P
><P
>        Clicking on the resource marker will display an info box as below.
        Clicking on the name of any failed test will take you to the reporter
        details page.
        </P
><P
><IMG
SRC="figures/consumer/googleDefaultMapInfo.jpg"
ALIGN="CENTER"></P
></DIV
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="REPORTS"
>6.2. Reports</A
></H3
><P
>    The items in the REPORTS menu display graphic reports of current Inca
    data and series histories.  These graphs are generated using
    <A
HREF="http://cewolf.sourceforge.net/"
TARGET="_top"
>Cewolf</A
>,
    a JSP tag library for graphing based on
    <A
HREF="http://www.jfree.org/jfreechart/"
TARGET="_top"
>JFreeChart</A
>.
    Some reports require the "incaQueryStatus" query to have run previously;
    information about queries can be found in <A
HREF="#VIEW-QUERY"
>Section 6.3.3</A
>.
    </P
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="PASS-FAIL-REPORT"
>6.2.1. Pass/Fail Graphs and Error Messages</A
></H4
><P
>      The first item in the REPORTS menu executes 
      <TT
CLASS="FILENAME"
>report.jsp</TT
>, which uses CeWolf/JfreeChart, to
      generate historical summary reports with pass/fail status and error
      information.  You can edit the file
      <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/inca/xml/statusReport.xml</TT
> to
      change the look and contents of this report.
      The default consumer groups different combinations of sampleSuite series
      and displays the past two
      weeks of results.  Each set of series has a title (e.g., Software
      Deployment Tests) for its grouping and the series nickname, resource
      name, and report label for each series in the group.
      </P
><P
><IMG
SRC="figures/consumer/summary_report.jpg"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="AVE-PASS-REPORT"
>6.2.2. Average Pass Rate by Resource/Suite</A
></H4
><P
>      The second item in the REPORTS menu executes
      <TT
CLASS="FILENAME"
>summary.jsp</TT
>, which uses CeWolf/JfreeChart and
      stylesheets <TT
CLASS="FILENAME"
>seriesAverages.xsl</TT
> and
      <TT
CLASS="FILENAME"
>periodAverages.xsl</TT
> to show the average series pass
      rate by resource and suite for the past week.  Each bar label shows the
      value of
      the average series pass rate for the last week and the difference in
      percentage from the previous week. The color is green if the average pass
      rate is better than the previous week, red if the average pass rate is
      worse, and gray if there was no change. Individual bars can be clicked on
      to show the percentages broken down further for each individual resource
      or suite.
      </P
><P
><IMG
SRC="figures/consumer/summaryJsp.gif"
ALIGN="CENTER"></P
><P
>      Click on any bar to view a more detailed report for that resource or
      suite.  For example, clicking on the bar for the
      'app-support.teragrid.org-4.0.0' suite above shows the average pass
      rates for the 'app-support.teragrid.org-4.0.0' suite for each resource
      (figure below).
      </P
><P
><IMG
SRC="figures/consumer/summaryDetailsJsp.gif"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="SERIES-REPORT"
>6.2.3. Series Error Summary</A
></H4
><P
>      The third item in the REPORTS menu executes
      <TT
CLASS="FILENAME"
>status.jsp</TT
> with
      <TT
CLASS="FILENAME"
>seriesSummary.xsl</TT
> to summarize test series errors
      by time
      period.  Each time period includes the number of errors for the series
      during the time period, the number of unique or distinct errors during
      the period, and the percentage of the total results that passed during
      the period.
      </P
><P
>The time periods and titles (i.e., PAST 4 WEEKS) can be customized 
       using the page described in <A
HREF="#CONFIG-CONSUMER"
>Section 6.4.2</A
>.
      <P
><IMG
SRC="figures/consumer/error-summary-config.gif"
ALIGN="CENTER"></P
>
      </P
><P
>      The change between the total number of errors in the most recent period
      and the total number of errors in the period before it is also given. If
      the number of errors in the most recent period is greater than the number
      of errors in the previous period (+), the number appears in red. If the
      number of errors in the most recent period is less than the number in the
      previous period (-), the number is green.
      <P
><IMG
SRC="figures/consumer/error-summary.gif"
ALIGN="CENTER"></P
>
      </P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="AVE-PASS-HISTORY-REPORT"
>6.2.4. Average Pass History</A
></H4
><P
>      The fourth and fifth items in the REPORTS menu execute
      <TT
CLASS="FILENAME"
>summaryHistory.jsp</TT
>, which uses CeWolf/JfreeChart
      and stylesheets <TT
CLASS="FILENAME"
>seriesAverages.xsl</TT
> and
      <TT
CLASS="FILENAME"
>periodAverages.xsl</TT
> to show the average series pass
      rate over time grouped by resource and suite.  I.e., When grouped by
      suite, a history graph summarizing the average series pass rate is
      displayed for each suite.  By default, multiple lines are used to show
      the summary history on each resource.  To view the total summary history
      percentages for all resources, click the <TT
CLASS="FILENAME"
>total</TT
>
      checkbox in the top right corner and click the 'Filter' button.
      Histories for either specific resources or suites can also be displayed
      thru the form in the top right corner.  The amount of history shown is 4
      weeks by default but can be modified by editing the 'incaQueryStatus'
      query parameters described in
      <A
HREF="#VIEW-QUERY"
>Section 6.3.3</A
>.  
      </P
><P
><IMG
SRC="figures/consumer/summaryHistoryJsp.jpg"
ALIGN="CENTER"></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="QUERY-PAGES"
>6.3. Query</A
></H3
><P
>    The query pages allow users to generate graphs and cache queries to improve
    data display.
    </P
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="GRAPH-SERIES"
>6.3.1. Create Graph</A
></H4
><P
>      The first item of the QUERY menu executes
      <TT
CLASS="FILENAME"
>status.jsp</TT
> with <TT
CLASS="FILENAME"
>graph.xsl</TT
> 
      to create a form that allows you to
      graph the history of more than one series.  The form allows you select
      the set of series of interest via a set of checkboxes.
      </P
><P
><IMG
SRC="figures/consumer/graphForm.jpg"
ALIGN="CENTER"></P
><P
>        After selecting the "vtk-nvgl_version" series and
        clicking on the "graph" button in the form above,
        a graph page similar to the one below is shown with
        an XY plot of the pass/fail status of the selected
        series, a series pass/fail summary table, a bar graph of
        error message frequency (if the selected series have errors),
        a summary table of error messages, and a form to customize the graph
        further.
        <P
><IMG
SRC="figures/consumer/graph1.jpg"
ALIGN="CENTER"></P
>
      </P
><P
>Only two weeks of data are returned
        initially.  To query for all results, clear the "start date"
        field in the "customize graph" section and click "re-graph".
        To retrieve graphs more quickly, data point
        mouseover text and links to
        report details are turned off for the pass/fail graph.
        The data points can be made interactive by choosing "show mouseovers/hyperlinks"
        in the "customize graph" section and clicking on "re-graph".
        Clicking on interactive data points will lead to
        report details pages, mousing over them will show
        collection times and any error messages.
        <P
><IMG
SRC="figures/consumer/graph2.jpg"
ALIGN="CENTER"></P
>
            </P
><P
>Multiple series can also be graphed together as in the image below.
      A table under each graph summarizes results for each series.
        <P
><IMG
SRC="figures/consumer/graph3.jpg"
ALIGN="CENTER"></P
>
            </P
><P
>Graph pages for individual series are also linked from the report details pages.
        <P
><IMG
SRC="figures/consumer/details_graph.gif"
ALIGN="CENTER"></P
>
       </P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="CREATE-QUERY"
>6.3.2. Create Stored Query</A
></H4
><P
>        The second item in the QUERY menu executes
        <TT
CLASS="FILENAME"
>status.jsp</TT
> with
        <TT
CLASS="FILENAME"
>create-query.xsl</TT
> to provide a form for creating a
        cached query.  Unless password protection has been disabled as
        described in <A
HREF="#PASSWORD-CONSUMER"
>Section 6.14</A
>, selecting this item
        causes the consumer to prompt for an id and password.
        The consumer can cache frequently executed depot queries in
        order to improve data display speed.   For example, the latest results
        for a suite can be cached in order to quickly display a suite status
        page.  By default the latest results for the sampleSuite are cached
        every 2 minutes.  Results are also cached each day for historical
        reports.
        </P
><P
><IMG
SRC="figures/consumer/create-query.gif"
ALIGN="CENTER"></P
><P
>        Cached queries can be used to display custom tables of latest results,
        using the queryNames parameter to <TT
CLASS="FILENAME"
>status.jsp</TT
>
        For example, the image below shows the creation of a cached query,
        named gccTests, for two series in the default installation.
        </P
><P
><IMG
SRC="figures/consumer/ug-query-create.png"
ALIGN="CENTER"></P
><P
>        Once this query has been stored and executed, the table shown below can
        be viewed via
        <A
HREF="http://localhost:8080/inca/jsp/status.jsp?queryNames=gccTests&#38;resourceIds=defaultGrid"
TARGET="_top"
>http://localhost:8080/inca/jsp/status.jsp?queryNames=gccTests&#38;resourceIds=defaultGrid</A
>
        </P
><P
><IMG
SRC="figures/consumer/ug-query-table.png"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="VIEW-QUERY"
>6.3.3. Manage Stored Queries</A
></H4
><P
>        The third item in the QUERY menu executes <TT
CLASS="FILENAME"
>query.jsp</TT
>
        to allow management of cached queries.  Unless password protection has
        been disabled as described in <A
HREF="#PASSWORD-CONSUMER"
>Section 6.14</A
>,
        selecting this item causes the consumer to prompt for an id and
        password.  Click on one of the pre-defined
        queries to see its parameters.  Each query has a name, execution
        schedule, depot command it executes and the parameters for the depot
        command executed.
        </P
><P
>        <P
><IMG
SRC="figures/consumer/query.gif"
ALIGN="CENTER"></P
>
        </P
><P
>        By default, the latest instances of all suites are cached every
        2 minutes by predefined queries named
        incaQueryLatest+<STRONG
><FONT
COLOR="RED"
>agentUri</FONT
></STRONG
>_<STRONG
><FONT
COLOR="RED"
>suiteName</FONT
></STRONG
>.
        These
        cached queries are used for the CURRENT DATA menu views described in
        <A
HREF="#CURRENT-DATA"
>Section 6.1</A
>.  Another default query is
        "incaQueryStatus" which retrieves a summary of the number of successes
        and failures for each series for the past 4 weeks.  This cached query
        is used for the several of the reports described in <A
HREF="#REPORTS"
>Section 6.2</A
>.  To display 10 weeks of history instead, modify "28"
        days to "70" and click "Change".  Note that the consumer will
        automatically re-create any of these default queries that are deleted.
        </P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="ADMIN"
>6.4. Admin</A
></H3
><P
>The ADMIN menu item offers two views of the
      running reporters in an Inca deployment and a configuration page.  To
      link other informational pages under this heading, customize the
      <TT
CLASS="FILENAME"
>header.xsl</TT
> file as described in
      <A
HREF="#CUSTOM-HTML-HEADER"
>Section 6.8.3</A
>. </P
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="RUNNING-REPORTERS"
>6.4.1. List Running Reporters</A
></H4
><P
>The "Running Reporters" page displays running reporters series by suite.  
    Each series lists its name, frequency of execution, whether email notification is
    enabled, the reporter script used for the series, and a description of the reporter script.
    Note that in this view, and in the more detailed running reporters view, the reporter names link to a CGI script 
    that will not work for repositories that are not web accessible (like the local default repository).
    Make your repository web accessible and add/commit the repository URL beginning with "http" in order to activate the reporter links.
    </P
><P
><IMG
SRC="figures/consumer/running-reporters.jpg"
ALIGN="CENTER"></P
><P
>The detailed "Running Reporter Series" page below lists the running reporter series and the suite each belongs to, the machine 
      each is scheduled to execute on, whether email notification is configured, and the recipient ("Target") 
      of any notification.</P
><P
><IMG
SRC="figures/consumer/running-reporters-detail.jpg"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="CONFIG-CONSUMER"
>6.4.2. View/Change Configuration</A
></H4
><P
>Here Inca administrators can view and change the global configuration of status pages. Determine whether to allow run nows or the execution of tests via the detailed status pages (see <A
HREF="#CONSUMER-RUN-NOW"
>Section 6.5.2</A
>) and configure the knowledge base (<A
HREF="#CONSUMER-KB"
>Section 6.5.3</A
>), google map (<A
HREF="#GOOGLE-SETUP"
>Section 6.1.3.2</A
>) and series summary (<A
HREF="#SERIES-REPORT"
>Section 6.2.3</A
>) status pages.
      </P
><P
><IMG
SRC="figures/consumer/config-view-change.gif"
ALIGN="CENTER"></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="CONSUMER-REPORT-DETAILS"
>6.5. Report Details</A
></H3
><P
>The Current Data, Reports, and Query views described in previous
    sections provide links to a view that displays the individual report
    details as shown in the figure below. </P
><P
><IMG
SRC="figures/consumer/details_annotated.jpg"></P
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="CONSUMER-REPORT-DETAILS-XML"
>6.5.1. Report Details XML</A
></H4
><P
>The individual report details are generated by a depot query that returns XML formatted like the following (tags are described below):
    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>&#60;reportDetails xmlns="http://inca.sdsc.edu/dataModel/reportDetails_2.1"&#62;
  &#60;suiteId xmlns=""&#62;8140012&#60;/suiteId&#62;
  &#60;seriesConfigId xmlns=""&#62;8156370&#60;/seriesConfigId&#62;
  &#60;seriesId xmlns=""&#62;1712066&#60;/seriesId&#62;
  &#60;reportId xmlns=""&#62;28430963&#60;/reportId&#62;
  &#60;instanceId xmlns=""&#62;30977056&#60;/instanceId&#62;
  &#60;seriesConfig xmlns=""&#62;
    &#60;series&#62;
      &#60;name&#62;cluster.compiler.gcc.version&#60;/name&#62;
      &#60;version&#62;2&#60;/version&#62;
      &#60;uri&#62;http://inca.sdsc.edu/2.0/ctssv3/bin/cluster.compiler.gcc.version&#60;/uri&#62;
      &#60;args&#62;
        &#60;arg&#62;
          &#60;name&#62;log&#60;/name&#62;
          &#60;value&#62;5&#60;/value&#62;
        &#60;/arg&#62;
        &#60;arg&#62;
          &#60;name&#62;version&#60;/name&#62;
          &#60;value&#62;no&#60;/value&#62;
        &#60;/arg&#62;
        &#60;arg&#62;
          &#60;name&#62;help&#60;/name&#62;
          &#60;value&#62;no&#60;/value&#62;
        &#60;/arg&#62;
        &#60;arg&#62;
          &#60;name&#62;verbose&#60;/name&#62;
          &#60;value&#62;1&#60;/value&#62;
        &#60;/arg&#62;
      &#60;/args&#62;
      &#60;limits&#62;
        &#60;wallClockTime&#62;600.0&#60;/wallClockTime&#62;
        &#60;memory&#62;-1.0&#60;/memory&#62;
        &#60;cpuTime&#62;-1.0&#60;/cpuTime&#62;
      &#60;/limits&#62;
      &#60;context&#62;&#60;![CDATA[bash -l -c 'set -a; cd /usr/users/9/inca/inca2install; cp ~/.soft.v3 ~/.soft.v3.$$ &#38;&#38; soft-msc ~/.soft.v3.$$ &#38;&#38; source ~/.soft.v3.$$.cache.sh &#38;&#38; export PERL5LIB=/usr/users/9/inca/inca2install/var/reporter-packages/lib/perl:${HOME}/inca/install/lib/perl &#38;&#38;cluster.compiler.gcc.version -help="no" -log="5" -verbose="1" -version="no"; rm -f ~/.soft.v3.$$*';]]&#62;&#60;/context&#62;
      &#60;nice&#62;false&#60;/nice&#62;
    &#60;/series&#62;
    &#60;nickname&#62;compiler-gnu-version-as-4.0.1&#60;/nickname&#62;
    &#60;resourceHostname&#62;psc-bigben&#60;/resourceHostname&#62;
    &#60;schedule&#62;
      &#60;cron&#62;
        &#60;min&#62;2&#60;/min&#62;
        &#60;hour&#62;17&#60;/hour&#62;
        &#60;mday&#62;*&#60;/mday&#62;
        &#60;wday&#62;*&#60;/wday&#62;
        &#60;month&#62;*&#60;/month&#62;
      &#60;/cron&#62;
      &#60;numOccurs&#62;-1&#60;/numOccurs&#62;
      &#60;suspended&#62;false&#60;/suspended&#62;
    &#60;/schedule&#62;
    &#60;acceptedOutput&#62;
      &#60;comparitor&#62;ExprComparitor&#60;/comparitor&#62;
      &#60;comparison&#62;gcc=~".*"&#60;/comparison&#62;
      &#60;notifications&#62;
        &#60;notification&#62;
          &#60;notifier&#62;EmailNotifier&#60;/notifier&#62;
          &#60;target&#62;FailTo:inca@sdsc.edu&#60;/target&#62;
        &#60;/notification&#62;
      &#60;/notifications&#62;
    &#60;/acceptedOutput&#62;
    &#60;action&#62;add&#60;/action&#62;
  &#60;/seriesConfig&#62;
  &#60;report xmlns=""&#62;...&#60;/report&#62;
  &#60;comparisonResult xmlns=""&#62;Success&#60;/comparisonResult&#62;
  &#60;sysusage xmlns=""&#62;
    &#60;wallClockTime&#62;0.929562&#60;/wallClockTime&#62;
    &#60;memory&#62;0.0&#60;/memory&#62;
    &#60;cpuTime&#62;0.556034&#60;/cpuTime&#62;
  &#60;/sysusage&#62;
  &#60;stderr xmlns=""/&#62;
&#60;/reportDetails&#62;</PRE
></FONT
></TD
></TR
></TABLE
>
  </P
><P
>Report detail output is surrounded by &#60;reportDetails&#62; tags.
A prefix with a tag name that references
http://inca.sdsc.edu/dataModel/reportDetails_2.1, which is the namespace that defines
the report schema, can also be used.</P
><P
>The following tags are defined within a &#60;reportDetails&#62;:</P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="FILENAME"
>suiteId</TT
></DT
><DD
><P
>  (internal) the database identifier for the suite id number this report series belongs to (used in further queries)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>seriesConfigId</TT
></DT
><DD
><P
>  (internal) the database identifier for the series configuration information for this report series (used in futher queries)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>seriesId</TT
></DT
><DD
><P
>  (internal) the database identifier for the series information for this report series (used in further queries)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>reportId</TT
></DT
><DD
><P
>  (internal) the database identifier for the report information for the particular result from this report series (used in further queries)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>instanceId</TT
></DT
><DD
><P
>  (internal) the database identifier for the instance information for the particular time this report series executed (used in futher queries)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>seriesConfig</TT
></DT
><DD
><P
>  all of the configuration options for this report series: name (of reporter), version (of reporter), uri (for reporter), args, limits (for consumption of wall clock time, memory, and cpu time), context (command to execute series), nickname (of series), resourceHostname (where series will execute), schedule (cron for executing series), acceptedOutput (can include "comparison" string to match in the report and "notification" actions to take if the comparison fails)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>report</TT
></DT
><DD
><P
>  report XML like that described in <A
HREF="#REPORTER-OUTPUT"
>Section 7.2.2</A
>
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>comparisonResult</TT
></DT
><DD
><P
>  if series was configured with a comparison, the result of the comparison for this particular report series execution
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>sysusage</TT
></DT
><DD
><P
>  amount of wall clock time, memory and cpu time this particular report series execution consumed
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>stderr</TT
></DT
><DD
><P
>  standard error, if any, for this particular report series execution 
  </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="CONSUMER-RUN-NOW"
>6.5.2. Run Nows</A
></H4
><P
>If the "Allow run nows from web pages" option is checked 
    (see <A
HREF="#CONFIG-CONSUMER"
>Section 6.4.2</A
>), a "Run
    Now" button will appear under the "Command used to execute the reporter"
    heading. This option is useful for system administrators who have fixed an
    issue and want to see the updated result or for those who want to verify that a problem  
    has been resolved.  
    <P
><IMG
SRC="figures/consumer/run-now.gif"
ALIGN="CENTER"></P
>
    </P
><P
>Clicking on the "Run Now" button triggers reporter execution
    on the local machine.  Depending on the reporter execution time and page cache frequency (see <A
HREF="#VIEW-QUERY"
>Section 6.3.3</A
>), results may take a few minutes to propagate 
    to the Inca web pages.</P
><P
><IMG
SRC="figures/consumer/run-now-button.png"
ALIGN="CENTER"></P
><P
>Since authentication is required based on the authentication setup (see
    <A
HREF="#PASSWORD-CONSUMER"
>Section 6.14</A
>), a box will popup such as follows:</P
><P
><IMG
SRC="figures/consumer/security-popup.jpg"
ALIGN="CENTER"></P
><P
>Press 'Continue' and the security login window will display such as
    follows:</P
><P
><IMG
SRC="figures/consumer/security-login.jpg"
ALIGN="CENTER"></P
><P
>Use the username and password specified in
    <TT
CLASS="FILENAME"
>$INCA_DIST/etc/realm.properties</TT
>.  By default, the
    username and password are 'inca'. After the consumer submits the request, 
    you will see a confirmation such as below: </P
><P
><IMG
SRC="figures/consumer/run-now-confirm.jpg"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="CONSUMER-KB"
>6.5.3. Knowledge Base</A
></H4
><P
>The Inca default knowledge base is designed to collect problem resolution information 
    for tests.  System administrators may use solutions stored in the knowledge base when debugging
    issues on their resources. The knowledge base can be configured using the admin page 
    described in <A
HREF="#CONFIG-CONSUMER"
>Section 6.4.2</A
> with the options described after the configuration image below:
    <P
><IMG
SRC="figures/consumer/kb-config.gif"
ALIGN="CENTER"></P
>
    <P
></P
><UL
><LI
><P
>enable:</P
><P
>   If the "enable" value is set to "true" then a "search knowledge base" button
and an "add to knowledge base" button will appear under the "Result" heading of
the reporter details status pages.  If "enable" is set to "false" then the
knowledge base buttons will be hidden and inaccessible.
        </P
></LI
><LI
><P
>searchString:</P
><P
>   The URL that will be visited after clicking on the "search knowledge base"  
button.  The macros "@nickname@", "@reporter@" and "@error@" will be replaced  
by the actual series nickname (e.g. gcc_version), reporter name (e.g. cluster.compiler.gcc.version), 
and error message for each test.  The "+" character will be replaced by "&#38;".
        </P
></LI
><LI
><P
>submitString:</P
><P
>   The URL that will be visited after clicking on the "add to knowledge base"  
button.  The macros "@nickname@", "@reporter@" and "@error@" will be replaced  
by the actual series nickname (e.g. gcc_version), reporter name (e.g. cluster.compiler.gcc.version), 
and error message for each test.  The "+" character will be replaced by "&#38;".
        </P
></LI
><LI
><P
>submitEmailNotification:</P
><P
>   The email address to send new, changed, and removed knowledge base articles to.
By default no email notifications are sent and the "submitEmailNotifications" value
is set to "none".  To add email notifications, change this value to an email address or
a list of email addresses separated by commas (e.g. "email1@loc.edu, email2@loc.edu").
        </P
></LI
></UL
>
    </P
><P
>Once the knowledge base is enabled, two buttons to search and add to the 
    knowledge base will appear on the report details pages:</P
><P
><IMG
SRC="figures/consumer/kb-annotated-details.jpg"
ALIGN="CENTER"></P
><P
>Clicking on the "search knowledge base" button will lead to the URL set as the 
    "searchString" value.  By default, this returns all of the knowledge base articles related to 
    the series:</P
><P
><IMG
SRC="figures/consumer/kb-search.gif"
ALIGN="CENTER"></P
><P
>Clicking on the "add to knowledge base" button will lead to the URL set as the 
    "submitString" value.  By default, this is a form for entering article information.
    Since authentication is required for this form based on the authentication setup (see
    <A
HREF="#PASSWORD-CONSUMER"
>Section 6.14</A
>), a box will popup such as follows:</P
><P
><IMG
SRC="figures/consumer/security-popup.jpg"
ALIGN="CENTER"></P
><P
>Press 'Continue' and the security login window will display such as
    follows:</P
><P
><IMG
SRC="figures/consumer/security-login.jpg"
ALIGN="CENTER"></P
><P
>Use the username and password specified in
    <TT
CLASS="FILENAME"
>$INCA_DIST/etc/realm.properties</TT
>.  By default, the
    username and password are 'inca'. After the consumer submits the request, 
    a form will appear to complete like the one below: </P
><P
><IMG
SRC="figures/consumer/kb-add.gif"
ALIGN="CENTER"></P
><DIV
CLASS="SECTION"
><HR><H5
CLASS="SECTION"
><A
NAME="EXTERNAL-KB"
>6.5.3.1. Using an External or Custom Knowledge Base</A
></H5
><P
>To use an external or custom knowledge base instead of Inca's default internal knowledge base, 
      configure the "searchString" and "submitString" parameters described in <A
HREF="#CONSUMER-KB"
>Section 6.5.3</A
>.  
      For example, to add articles to an external knowledge base with a cgi submission form like</P
><P
><TT
CLASS="FILENAME"
>https://www.teragrid.org/cgi-bin/add-kb.cgi?articleText=text</TT
></P
><P
>change the "submitString" parameter to something like</P
><P
><TT
CLASS="FILENAME"
>https://www.teragrid.org/cgi-bin/add-kb.cgi?articleText=@nickname@%20@error@</TT
></P
><P
>Inca will replace the @nickname@ macro with the actual series nickname (e.g. gcc_version) and the @error@ macro with the series error message.  The "%20" represents a space since Inca replaces the "+" character with "&#38;".  Therefore, if the external knowledge base had a cgi submission form like</P
><P
><TT
CLASS="FILENAME"
>https://www.teragrid.org/cgi-bin/add-kb.cgi?articleTitle=title&#38;articleText=text</TT
></P
><P
>then the "submitString" parameter would be changed to something like</P
><P
><TT
CLASS="FILENAME"
>https://www.teragrid.org/cgi-bin/add-kb.cgi?articleTitle=@nickname@+articleText=@error@</TT
></P
><P
>The same syntax applies to the "searchString" parameter, which Inca uses to search for knowledge article and can be an external or custom URL.</P
></DIV
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="CONSUMER-REPORT-SUMMARY-XML"
>6.6. Report Summaries</A
></H3
><P
>The Current Data and Query views described in previous
    sections display "latest" report summaries like the one shown in the figure below. </P
><P
><IMG
SRC="figures/consumer/sum_page1.gif"></P
><P
>Report summaries are generated by a depot query that returns XML formatted like the following (tags are described below):
    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>&#60;reportSummary xmlns="http://inca.sdsc.edu/queryResult/reportSummary_2.0"&#62;
  &#60;hostname xmlns=""&#62;psc-bigben&#60;/hostname&#62;
  &#60;uri xmlns=""&#62;http://inca.sdsc.edu/2.0/ctssv3/bin/user.basicFunctionality.gridJobSubmission.unit&#60;/uri&#62;
  &#60;nickname xmlns=""&#62;prews-gram-batch-rc-4.0.2&#60;/nickname&#62;
  &#60;seriesConfigId xmlns=""&#62;10129135&#60;/seriesConfigId&#62;
  &#60;instanceId xmlns=""&#62;31005207&#60;/instanceId&#62;
  &#60;gmt xmlns=""&#62;2009-11-02T03:18:55.000-08:00&#60;/gmt&#62;
  &#60;gmtExpires xmlns=""&#62;2009-11-02T18:17:55.278-08:00&#60;/gmtExpires&#62;
  &#60;body xmlns=""&#62;
    &#60;unitTest xmlns:rep="http://inca.sdsc.edu/dataModel/report_2.1"&#62;
      &#60;ID/&#62;
    &#60;/unitTest&#62;
  &#60;/body&#62;
  &#60;errorMessage xmlns=""/&#62;
  &#60;comparisonResult xmlns=""&#62;Success&#60;/comparisonResult&#62;
&#60;/reportSummary&#62;</PRE
></FONT
></TD
></TR
></TABLE
>
  </P
><P
>Report summary output is surrounded by &#60;reportSummary&#62; tags.
A prefix with a tag name that references
http://inca.sdsc.edu/queryResult/reportSummary_2.0, which is the namespace that defines
the report schema, can also be used.</P
><P
>The following tags are defined within a &#60;reportSummary&#62;:</P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="FILENAME"
>hostname</TT
></DT
><DD
><P
>  resource id where the reporter executed
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>uri</TT
></DT
><DD
><P
>  the URI of the reporter repository and the location of the reporter 
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>nickname</TT
></DT
><DD
><P
>  the nickname (short name) for the report series
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>seriesConfigId</TT
></DT
><DD
><P
>  (internal) the database identifier for the series configuration information for this report series (used in futher queries)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>instanceId</TT
></DT
><DD
><P
>  (internal) the database identifier for the instance information for the particular time this report series executed (used in futher queries)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>gmt</TT
></DT
><DD
><P
>  the time this report series executed (ISO 8601 format)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>gmtExpires</TT
></DT
><DD
><P
>  the time when results from this report will become stale (ISO 8601 format)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>body</TT
></DT
><DD
><P
>  results of the reporter's testing
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>errorMessage</TT
></DT
><DD
><P
>  optional string indicating why the reporter failed to complete
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>comparisonResult</TT
></DT
><DD
><P
>  if series was configured with a comparison, the result of the comparison for this particular report series execution 
  </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="FILE-DESC"
>6.7. Description of Data Consumer Files</A
></H3
><P
>      The following table describes the main JSPs contained in the
      default consumer.
      The JSPs generally retrieve XML from depot and agent functions and
      apply XSL stylesheets to display HTML.  If the "debug=1" parameter
      for a JSP is used, the JSP displays the XML. Parameters marked with
      an asterisk (*) are optional.
    </P
><DIV
CLASS="TABLE"
><A
NAME="AEN976"
></A
><P
><B
>Table 2. Default Consumer JSP</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><COL><THEAD
><TR
VALIGN="TOP"
><TH
><P
>Name</P
></TH
><TH
><P
>Purpose</P
></TH
><TH
><P
>Parameters</P
></TH
><TD
>&nbsp;</TD
></TR
></THEAD
><TBODY
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>config.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/config_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Prints description of deployed suites and series.
                Linked at the bottom of <TT
CLASS="FILENAME"
>index.jsp</TT
>
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>xsl *: stylesheet to format returned XML [default: config.xsl]</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/config.jsp"
TARGET="_top"
>http://localhost:8080/inca/jsp/config.jsp</A
></P
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>error.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/errorJsp_sm.gif"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Prints Inca error message page.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>msg: error message from another JSP</P
></LI
><LI
><P
>usage: correct usage of the JSP</P
></LI
></UL
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>graph.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/graph_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Historical graphs of pass/fail status and error frequency.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>series: a series nickname and resource separated by a comma and an optional label</P
></LI
><LI
><P
>legend *: boolean for showing legend</P
></LI
><LI
><P
>legendAnchor *: position of legend</P
></LI
><LI
><P
>height *: graph height in pixels</P
></LI
><LI
><P
>width *: graph width in pixels</P
></LI
><LI
><P
>startDate *: date to start querying data for</P
></LI
><LI
><P
>endDate *: date to stop querying data for</P
></LI
><LI
><P
>bgcolor *: background color of graph images</P
></LI
><LI
><P
>map *: boolean for showing graph links and mouseovers</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/graph.jsp?series=ant_helloworld_compile_test,localResource"
TARGET="_top"
>http://localhost:8080/inca/jsp/graph.jsp?series=ant_helloworld_compile_test,localResource</A
></P
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>index.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/index_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Lists an installation's configured suites and resource
                names in an HTML form whose action is to display results
                for the selected suite and resource.  The consumer
                initially redirects to this page.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>xsl *: stylesheet to format returned XML [default: index.xsl]</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/index.jsp"
TARGET="_top"
>http://localhost:8080/inca/jsp/index.jsp</A
></P
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>instance.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/inst_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Queries depot for report instance and invokes the specified xsl stylesheet on it.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>instanceId: the id of the particular report instance</P
></LI
><LI
><P
>configId: the id of the series config the instance belongs to</P
></LI
><LI
><P
>resourceId: the resource id for series config (for history link)</P
></LI
><LI
><P
>xsl *: name of stylesheet to format returned XML [default: instance.xsl]</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/instance.jsp?instanceId=1&#38;configId=1&#38;resourceId=localResource"
TARGET="_top"
>http://localhost:8080/inca/jsp/instance.jsp?instanceId=1&#38;configId=1&#38;resourceId=localResource</A
></P
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>query.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/query_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Page for managing stored queries in the Consumer.  Queries
  can be added, deleted, changed, viewed or executed (and return XML).
  This jsp page manages the query manipulation via jsp tags and leaves the
  display of the current queries to a stylesheet.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>action: an action to take on the query (see JSP usage for more information)</P
></LI
><LI
><P
>xsl *: name of stylesheet to format returned XML [default: query.xsl]</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/query.jsp"
TARGET="_top"
>http://localhost:8080/inca/jsp/query.jsp</A
></P
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>report.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/summary_report_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Summary report with graphs of pass/fail status and error frequency.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>startDate *: start date for summary report (gets complete history by default)</P
></LI
><LI
><P
>endDate *: end date for summary report (current date by default)</P
></LI
><LI
><P
>xml *: name of xml file to configure report (<TT
CLASS="FILENAME"
>webapps/xml/statusReport.xml</TT
> by default)</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/report.jsp"
TARGET="_top"
>http://localhost:8080/inca/jsp/report.jsp</A
></P
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>seriesConfig.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/configDetail_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Prints detailed (expanded) information about running reporter
                series.  Linked in <TT
CLASS="FILENAME"
>ADMIN menu</TT
>.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>xsl *: stylesheet to format returned XML [default: configDetail.xsl]</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/config.jsp"
TARGET="_top"
>http://localhost:8080/inca/jsp/config.jsp</A
></P
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>status.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/sum_page2_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Displays current results for a set of suites or cached queries.
                This page is the action of the <TT
CLASS="FILENAME"
>index.jsp</TT
> form to display suite results.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>suiteNames *: a comma separated list of suite names.  At least one suite name
    is required if queryNames is empty and the number of suite names
    should match the number of resourceIds.  A suite name is optional if
    queryNames is provided.</P
></LI
><LI
><P
>queryNames *: a comma separated list of cached query names.  At least one name
    is required if suiteNames is empty.</P
></LI
><LI
><P
>resourceIds *: a comma separated list of resource group ids.  At least one
    resource id is required if suiteNames is not empty and the number of
    resourceIds should match the number of suiteNames.  A resource id is
    optional if queryNames is provided.  </P
></LI
><LI
><P
>xml *: a comma separated list of xml files to include.  Can be empty, contain
    one xml file or must match number of suiteNames and resourceIds if
    queryNames is empty. </P
></LI
><LI
><P
>xsl *: name of stylesheet to format returned XML [default: default.xsl]</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite&#38;resourceIds=defaultGrid"
TARGET="_top"
>http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite&#38;resourceIds=defaultGrid</A
></P
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>summary.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/summaryJsp_sm.gif"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Shows the average series pass rate by resource and by suite for a given time period.  Uses
		<TT
CLASS="FILENAME"
>seriesAverages.xsl</TT
> and <TT
CLASS="FILENAME"
>periodAverages.xsl</TT
>
		to calculate statistics.
              </P
></TD
><TD
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/summary.jsp"
TARGET="_top"
>http://localhost:8080/inca/jsp/summary.jsp</A
></P
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>summaryDetails.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/summaryDetailsJsp_sm.gif"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Displays summary statistic details for resource or suite.  Linked from <TT
CLASS="FILENAME"
>summary.jsp</TT
>.
		Uses <TT
CLASS="FILENAME"
>seriesAverages.xsl</TT
> and <TT
CLASS="FILENAME"
>periodAverages.xsl</TT
>
                to calculate statistics.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>resource *: resource to get summary stats for (e.g. localResource)</P
></LI
><LI
><P
>guid *: suite guid to get summary stats for (e.g. incas://localhost:6323/sampleSuite)</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/summaryDetails.jsp?resource=localResource"
TARGET="_top"
>http://localhost:8080/inca/jsp/summaryDetails.jsp?resource=localResource</A
></P
></TD
><TD
>&nbsp;</TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>summaryHistory.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/summaryHistoryJsp_sm.gif"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Displays average series pass rate by resource or suite. Uses
                <TT
CLASS="FILENAME"
>seriesAverages.xsl</TT
> and <TT
CLASS="FILENAME"
>periodAverages.xsl</TT
>
                to calculate statistics.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>groupBy *: if 'resource', displays history grouped by resource or if 'suite' is specified, displays history grouped by suite.  [Default: resource]</P
></LI
><LI
><P
>lines *: if 'multiple', displays individual histories (i.e., if groupBy = 'suite', displays a line for each resource).  If 'total', a single
                  line is displayed representing all resources or suites.
                  [Default: multiple]</P
></LI
><LI
><P
>filterResource*: if specified, only displays histories
                  for specified resources (comma delimited).  </P
></LI
><LI
><P
>filterSuite *: if specified, only displays histories for specified suites (comma delimited).  </P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/jsp/summaryHistory.jsp?groupBy=resource"
TARGET="_top"
>http://localhost:8080/inca/jsp/summaryHistory.jsp?groupBy=resource</A
></P
></TD
><TD
>&nbsp;</TD
></TR
></TBODY
></TABLE
></DIV
><P
>        The default JSPs use the XSL stylesheets in
        <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/xsl</TT
>
           to transform the XML into HTML.
           The following stylesheets are installed
        with the default consumer:</P
><DIV
CLASS="TABLE"
><A
NAME="AEN1198"
></A
><P
><B
>Table 3. Default Consumer XSL</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><THEAD
><TR
VALIGN="TOP"
><TH
><P
>Name</P
></TH
><TH
><P
>Applied To</P
></TH
><TH
><P
>Purpose</P
></TH
></TR
></THEAD
><TBODY
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>config.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/config_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>config.jsp</TT
></P
></TD
><TD
><P
>Prints description of deployed suites and series.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>create-query.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/create-query_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>status.jsp</TT
></P
></TD
><TD
><P
>Prints form to select series and resources to query.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>default.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/sum_page2_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>status.jsp</TT
></P
></TD
><TD
><P
>Prints table of suite(s) results.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>error.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/errorJsp_sm.gif"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>error.jsp</TT
></P
></TD
><TD
><P
>Displays JSP error message and usage information.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>footer.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/footer_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
>(included in most other xsl files)</P
></TD
><TD
><P
>Prints HTML page footer with the Inca logo.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>google.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/google_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>status.jsp</TT
></P
></TD
><TD
><P
>Prints google map summary of current data.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>graph.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/graph_form_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>status.jsp</TT
></P
></TD
><TD
><P
>Prints form to select series to graph.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>header.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/header_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>(included in most other xsl files)</TT
></P
></TD
><TD
><P
>Prints HTML page header.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>inca-common.xsl</TT
></P
></TD
><TD
><P
>(included in most other stylesheets)</P
></TD
><TD
><P
>Common templates for use in Inca stylesheets.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>index.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/index_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>index.jsp</TT
></P
></TD
><TD
><P
>                  Lists all configured suite and resource names in an
                  HTML form whose action is to display results for the
                  selected suite and resource.
                </P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>instance.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/inst_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>instance.jsp</TT
></P
></TD
><TD
><P
>Prints HTML table with report details.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>legend.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/legend_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
>(included in <TT
CLASS="FILENAME"
>default.xsl</TT
>
                  and <TT
CLASS="FILENAME"
>swStack.xsl</TT
>)</P
></TD
><TD
><P
>Prints a key to cell colors and text.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>periodAverages.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/summaryJsp_sm.gif"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>summary.jsp</TT
>, <TT
CLASS="FILENAME"
>summaryDetails.jsp</TT
>,
		<TT
CLASS="FILENAME"
>summaryHistory.jsp</TT
></P
></TD
><TD
><P
>Computes pass percentage for suites and resources for a given period.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>query.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/query_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>query.jsp</TT
></P
></TD
><TD
><P
>Creates form to manipulate hql queries.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>seriesAverages.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/summaryJsp_sm.gif"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>summary.jsp</TT
>, <TT
CLASS="FILENAME"
>summaryDetails.jsp</TT
>,
		<TT
CLASS="FILENAME"
>summaryHistory.jsp</TT
></P
></TD
><TD
><P
>Computes series pass percentages.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>seriesSummary.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/error-summary_sm.gif"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>status.jsp</TT
></P
></TD
><TD
><P
>Print out a table of stats for individual series.
                </P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>swStack.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/swstack_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>status.jsp</TT
></P
></TD
><TD
><P
>Prints table of suite(s) results.  Uses XML file
                  to format table rows by software categories and packages.</P
></TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="CUSTOM-DISPLAY"
>6.8. Changing the Look</A
></H3
><DIV
CLASS="SECTION"
><H4
CLASS="SECTION"
><A
NAME="CUSTOM-COLOR"
>6.8.1. Colors and Fonts</A
></H4
><P
>      Properties such as colors and fonts are controlled by the default CSS
      (Cascading Style Sheet) file
      <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/inca/css/inca.css</TT
>.  The drop
      down nav bar in the header is controlled by
      <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/inca/css/nav.css</TT
>.  You can edit
      these files to customize the consumer display.
      For example, to change the color in the reporter detail pages header bar,
      edit <TT
CLASS="FILENAME"
>inca.css</TT
> and change lines 111-112 to:
        <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>.header {
          background-color: #D07651;</PRE
></FONT
></TD
></TR
></TABLE
>
        The details pages will now look like:
        <P
><IMG
SRC="figures/consumer/color-change.jpg"
ALIGN="CENTER"></P
>
      </P
><P
>For general information, visit the [ <A
HREF="http://www.w3schools.com/css/"
TARGET="_top"
>CSS tutorial</A
> ].</P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="CUSTOM-HTML"
>6.8.2. HTML Layout</A
></H4
><P
>      To modify the default HTML layout, edit the XSL stylesheet that is
      being applied to the JSP or create a new stylesheet in
      in <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/inca/xsl</TT
> and pass it in the
      JSP "xsl" parameter.
      The default JSP and XSL files are described in
      <A
HREF="#FILE-DESC"
>Section 6.7</A
>.</P
><P
>For general information about editing stylesheets,
        visit the [ <A
HREF="http://www.w3schools.com/xsl/"
TARGET="_top"
>XSL tutorial</A
> ].</P
><DIV
CLASS="SECTION"
><HR><H5
CLASS="SECTION"
><A
NAME="CUSTOM-HTML-VALUES"
>6.8.2.1. Custom Values in HTML Table Cells</A
></H5
><P
>To display report values other
          than the default text of either a software version, "pass", or "error"
          on the suite results pages, edit <TT
CLASS="FILENAME"
>default.xsl</TT
>.  </P
><P
> For example, to change the default suite status to print the time successful
          reporters ran and a truncated error message for failures like:
        </P
><P
><P
><IMG
SRC="figures/consumer/text-change.jpg"
ALIGN="CENTER"></P
></P
><P
>Edit <TT
CLASS="FILENAME"
>default.xsl</TT
>, add a new variable for the custom table cell text and
          print the custom cell text rather than the default text:
        </P
><P
>          <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>188  &#60;xsl:variable name="cellText"&#62;
            189    &#60;xsl:choose&#62;
            190      &#60;xsl:when test="string($instance)=''"&#62;
            191        &#60;xsl:value-of select="''" /&#62;
            192      &#60;/xsl:when&#62;
            193      &#60;xsl:when test="string($result/body)!=''
            194             and string($result/errorMessage)=''
            195             and ($comparitor='Success' or count($comparitor)=0)"&#62;
            196               passed:
            197        &#60;!-- get yyyy-mm-dd from gmt timestamp --&#62;
            198        &#60;xsl:value-of select="substring($result/gmt, 1, 10)" /&#62;
            199        &#60;!-- get HH:MM from gmt timestamp --&#62;
            200        &#60;xsl:value-of select="substring($result/gmt, 12, 5)" /&#62;
            201      &#60;/xsl:when&#62;
            202      &#60;xsl:otherwise&#62;
            203               error:
            204        &#60;xsl:value-of select="substring($result/errorMessage, 1, 30)" /&#62;
            205      &#60;/xsl:otherwise&#62;
            206    &#60;/xsl:choose&#62;
            207  &#60;/xsl:variable&#62;
            208  &#60;xsl:choose&#62;
            209    &#60;xsl:when test="$exit!=''"&#62;
            210      &#60;td class="{$exit}"&#62;
            211        &#60;a href="{$href}"&#62;&#60;xsl:value-of select="$cellText"/&#62;&#60;/a&#62;
            212        &#60;xsl:if test="$url[matches(., 'markOld')]"&#62;</PRE
></FONT
></TD
></TR
></TABLE
>
        </P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="CUSTOM-HTML-HEADER"
>6.8.3. Custom Page Header</A
></H4
><P
>The default page header is generated by the inclusion of the
          <TT
CLASS="FILENAME"
>header.xsl</TT
> file in other xsl files.  The header
          is a navigation bar with drop down links to a set of default status
          pages:
          <P
><IMG
SRC="figures/consumer/googleMapMenu.png"
ALIGN="CENTER"></P
>
        </P
><P
>The header's navigation bar is an HTML unordered list that is
        formatted with the <TT
CLASS="FILENAME"
>nav.css</TT
> stylesheet.  To add
        or remove links in the navigation bar, open <TT
CLASS="FILENAME"
>header.xsl</TT
>
          and change the appropriate link.  For example, to show a table of suite
          results for a new suite called "newSuite" on a new resource called "newResource":
        <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>57  &#60;li&#62;&#60;h2&#62;Current Data&#60;/h2&#62;
58    &#60;ul&#62;
59      &#60;li&#62;
60        &#60;a href="'status.jsp?xsl=default.xsl&#38;amp;suiteNames=newSuite&#38;amp;resourceIds=newResource'"&#62;
61           table of newSuite results&#60;/a&#62;
62      &#60;/li&#62;</PRE
></FONT
></TD
></TR
></TABLE
>
        </P
><P
>Any other link can be added or removed as a list element.  The
          stylesheet supports additional levels of nested list links.  Note that
          the top level list elements are displayed from bottom to top (i.e., CURRENT DATA
          is listed last in <TT
CLASS="FILENAME"
>header.xsl</TT
> so it is displayed
          the furthest left in the top level navigation bar).
        </P
><P
>Another example of customizing the HTML header would be to add a call to a custom header stylesheet in the
          "printBodyTitle" template.  Edit <TT
CLASS="FILENAME"
>inca-common.xsl</TT
>:</P
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>13  <STRONG
><FONT
COLOR="RED"
>&#60;xsl:include href="custom-header.xsl"/&#62;</FONT
></STRONG
>
          ...
          24  &#60;xsl:template name="printBodyTitle"&#62;
          25    &#60;xsl:param name="title"/&#62;
          26    <STRONG
><FONT
COLOR="RED"
>&#60;xsl:call-template name="custom-header"/&#62;</FONT
></STRONG
>
          27    &#60;xsl:variable name="datenow" select="date:new()" /&#62;
          28    &#60;xsl:variable name="dateformat" select="sdf:new('MM-dd-yyyy hh:mm a (z)')"/&#62;
          29    &#60;table width="100%" border="0"&#62;
          30      &#60;tr align="left"&#62;</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>Create a <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/xsl/custom-header.xsl</TT
> like:</P
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>&#60;?xml version="1.0" encoding="UTF-8"?&#62;

          &#60;!-- ================================================ --&#62;
          &#60;!-- Prints out custom header for Inca status pages   --&#62;
          &#60;!-- ================================================ --&#62;
          &#60;xsl:stylesheet version="1.0"
          xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
          xmlns="http://www.w3.org/1999/xhtml"&#62;

          &#60;xsl:template name="custom-header"&#62;
          &#60;table class="header" width="100%"&#62;
          &#60;tr&#62;
          &#60;td bgcolor="#003366"&#62;
          &#60;img class="logo" src="img/header.jpg"/&#62;
          &#60;/td&#62;
          &#60;/tr&#62;
          &#60;/table&#62;
          &#60;table class="menu" width="100%"&#62;
          ... custom navigation ...
          &#60;/table&#62;
          &#60;/xsl:template&#62;

          &#60;/xsl:stylesheet&#62;</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>The resulting page would look something like: </P
><P
><P
><IMG
SRC="figures/consumer/custom-header.jpg"
ALIGN="CENTER"></P
></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="CONSUMER-NEUTRAL-ERRS"
>6.9. Displaying Errors Neutrally</A
></H3
><P
>You may wish to display certain errors neutrally in historical reports.  For example, if an error message 
        indicates that a machine was down when the report was collected, you may want to display that error neutrally 
        (i.e. neither as a pass nor a fail).  By default, Inca marks error messages that start with "DOWNTIME" or "NOT_AT_FAULT" 
        neutrally because they are generally the result of report filtering (see <A
HREF="#REPORT-FILTERING"
>Section 11.3</A
>).  Errors that contain "Inca error" or "Unable to fetch proxy for reporter execution" are 
        also marked neutrally since the error may be due to the Inca framework instead of the machine being tested.  To change the 
        errors that are marked neutrally, edit the regular expression that is matched as follows:
    </P
><P
></P
><UL
><LI
><P
>Open the <TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> local file and edit 
          the inca.consumer.ignoreErrors property:
          <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>inca.consumer.ignoreErrors=(^DOWNTIME:.*|^NOT_AT_FAULT.*|.*Inca error.*|.*Unable to fetch proxy for reporter execution.*)</PRE
></FONT
></TD
></TR
></TABLE
>
        </P
></LI
><LI
><P
>Restart the consumer: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca restart consumer</PRE
></FONT
></TD
></TR
></TABLE
></LI
></UL
><P
>Now error messages matching the pattern you chose will be marked neutrally.  For example, the four reports that have 
    error messages that begin with "NOT_AT_FAULT" are marked neutrally as "unknown" in the graph below:
    <P
><IMG
SRC="figures/consumer/neutral-results.jpg"
ALIGN="CENTER"></P
></P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="CONSUMER-ALT-LOCATION"
>6.10. Changing the Installation Location</A
></H3
><P
>You can install the data consumer in a non-default location (e.g., on a machine where the depot and agent are not running) if you: </P
><P
></P
><UL
><LI
><P
>          Copy the <TT
CLASS="FILENAME"
>incaInstall.sh</TT
> script to the machine where the consumer will run.
        </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% wget http://inca.sdsc.edu/releases/2.6/incaInstall.sh</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>          Install consumer on the new machine:
        </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./incaInstall.sh $INCA_DIST consumers</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>          Copy the consumer key, certificate, and trusted directory from the machine where the agent/depot are running (orig.machine)
          to the new machine:
        </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% scp <STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/consumerkey.pem $INCA_DIST/etc/; \
          scp <STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/consumercert.pem $INCA_DIST/etc/;
          scp "<STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/trusted/*" $INCA_DIST/etc/trusted/;</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>Edit the <TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> local file and specify the full hostname
          of the machine where the agent and depot are running:
          <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>114 inca.consumer.agent=incas://<STRONG
><FONT
COLOR="RED"
>agent.hostname</FONT
></STRONG
>:6323
            ...
            128 inca.consumer.depot=incas://<STRONG
><FONT
COLOR="RED"
>depot.hostname</FONT
></STRONG
>:6324</PRE
></FONT
></TD
></TR
></TABLE
>
        </P
></LI
><LI
><P
> Start the consumer component on the new machine: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca start consumer</PRE
></FONT
></TD
></TR
></TABLE
></LI
></UL
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="CONSUMER-PORT"
>6.11. Changing Ports</A
></H3
><P
>      By default, the consumer is started on port 8080 (HTTP) and 8443
      (HTTPS).  To change the port numbers, edit $INCA_DIST/etc/jetty.xml.
      For example to change the HTTP  port to 9080, search for
      'SelectChannelConnector' and change the following line:
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;Set name="port"&#62;8080&#60;/Set&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>to: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;Set name="port"&#62;9080&#60;/Set&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>Likewise to change the HTTPS port to 9443, search for
    'SslSocketConnector' and change the following line: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;Set name="port"&#62;8443&#60;/Set&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>to: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;Set name="port"&#62;9443&#60;/Set&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>If you also have the HTTP port enabled, change the confidentialPort
    tag under its configuration from: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;Set name="confidentialPort"&#62;8443&#60;/Set&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>to: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;Set name="confidentialPort"&#62;9443&#60;/Set&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="DISABLE-HTTP-CONSUMER"
>6.12. Disabling HTTP</A
></H3
><P
>      By default, the consumer is configured as both an HTTP and HTTPS server.
      To disable HTTP, edit
      <TT
CLASS="FILENAME"
>$INCA_DIST/etc/jetty.xml</TT
> and
      comment out the section "Add a HTTP listener on port 8080"
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - --&#62;
      &#60;!-- Add a HTTP listener on port 8080                                --&#62;
      &#60;!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - --&#62;
      &#60;!--
      &#60;Call name="addConnector"&#62;
        &#60;Arg&#62;
            &#60;New class="org.mortbay.jetty.nio.SelectChannelConnector"&#62;
              &#60;Set name="host"&#62;&#60;SystemProperty name="jetty.host" /&#62;&#60;/Set&#62;
              &#60;Set name="port"&#62;&#60;SystemProperty name="jetty.port" default="8080"/&#62;&#60;/Set&#62;
              &#60;Set name="maxIdleTime"&#62;30000&#60;/Set&#62;
              &#60;Set name="Acceptors"&#62;2&#60;/Set&#62;
              &#60;Set name="statsOn"&#62;false&#60;/Set&#62;
              &#60;Set name="confidentialPort"&#62;8443&#60;/Set&#62;
        &#60;Set name="lowResourcesConnections"&#62;5000&#60;/Set&#62;
        &#60;Set name="lowResourcesMaxIdleTime"&#62;5000&#60;/Set&#62;
            &#60;/New&#62;
        &#60;/Arg&#62;
      &#60;/Call&#62;
      --&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>Then restart the consumer. </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      % ./bin/inca restart consumer
    </PRE
></FONT
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="HTTPS-CREDS"
>6.13. Changing HTTPS credential</A
></H3
><P
>By default, the HTTPS server will use the credential stored in
      <TT
CLASS="FILENAME"
>$INCA_DIST/etc/consumerKeystore</TT
>.  Its DN is
      "cn=Inca Consumer SSL, o=SDSC, l=San Diego, st=California, c=US".  If you'd
      like to generate a certificate with a different DN, run the keytool command as
      follows:
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% rm -f etc/consumerKeystore
% keytool -keystore etc/consumerKeystore -alias jetty -genkey -keyalg RSA -dname <STRONG
><FONT
COLOR="RED"
>your_DN</FONT
></STRONG
>
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>keytool will prompt you for a keystore password and a key password.  You can
      either make them different or use the same one.  If you use the password
      "consumer", no further changes are needed.  Otherwise, you will have to modify
      &#60;Set name="keyPassword"&#62;, &#60;Set name="password"&#62;, and
      &#60;Set name="trustPassword"&#62; in the
      "Add a HTTPS SSL listener on port 8443" section in
      <TT
CLASS="FILENAME"
>$INCA_DIST/etc/jetty.xml</TT
>.  You can either put the
      password in there in plain text or obfuscate it using Jetty's password
      utility as follows:
    </P
><P
>      <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% java -classpath lib/jetty-6.1.7.jar:lib/jetty-util-6.1.7.jar org.mortbay.jetty.security.Password <STRONG
><FONT
COLOR="RED"
>your_password</FONT
></STRONG
>
      </PRE
></FONT
></TD
></TR
></TABLE
>
    </P
><P
>It will output two lines such as follows:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>    OBF:1t3b1uh61ugk1t2v
    MD5:482b9f833150f58964b78ddbfa5ab23d
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>Edit <TT
CLASS="FILENAME"
>$INCA_DIST/etc/jetty.xml</TT
> and replace the
    string beginning with OBF in both &#60;Set name="KeyPassword"&#62; and
    &#60;Set name="Password"&#62; with the string
      provided by Jetty's password utility:
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;Set name="password"&#62;OBF:1v8w1v2h1wg01z0d1z0h1wfy1v1x1v9q&#60;/Set&#62;
      &#60;Set name="keyPassword"&#62;OBF:1v8w1v2h1wg01z0d1z0h1wfy1v1x1v9q&#60;/Set&#62;
      &#60;Set name="trustPassword"&#62;OBF:1v8w1v2h1wg01z0d1z0h1wfy1v1x1v9q&#60;/Set&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="PASSWORD-CONSUMER"
>6.14. Adding Password Protection</A
></H3
><P
>      By default, a password is only required on the
      <TT
CLASS="FILENAME"
>query.jsp</TT
> and <TT
CLASS="FILENAME"
>status-auth.jsp</TT
>
      pages.  To expand or remove password protection,
      edit the section 'require authentication on specific status pages'
      in <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/inca/WEB-INF/web.xml</TT
>.
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>    &#60;security-constraint&#62;
      &#60;web-resource-collection&#62;
        &#60;web-resource-name&#62;Inca Status Pages&#60;/web-resource-name&#62;
        &#60;url-pattern&#62;/jsp/admin.jsp&#60;/url-pattern&#62;
        &#60;url-pattern&#62;/jsp/query.jsp&#60;/url-pattern&#62;
        &#60;url-pattern&#62;/jsp/runNow.jsp&#60;/url-pattern&#62;
        &#60;url-pattern&#62;/jsp/status-auth.jsp&#60;/url-pattern&#62;
      &#60;/web-resource-collection&#62;
      &#60;auth-constraint&#62;
        &#60;role-name&#62;*&#60;/role-name&#62;
      &#60;/auth-constraint&#62;
      &#60;user-data-constraint&#62;
        &#60;transport-guarantee&#62;CONFIDENTIAL&#60;/transport-guarantee&#62;
      &#60;/user-data-constraint&#62;
    &#60;/security-constraint&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>Modify or add <TT
CLASS="FILENAME"
>url-pattern</TT
> tags to modify
    password access.  For example to apply password access to all
    Inca status pages, modify the <TT
CLASS="FILENAME"
>url-pattern</TT
> tag to below:
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>        ...
        &#60;url-pattern&#62;/*&#60;/url-pattern&#62;
        ...
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>Or to add password protection to another JSP page like
    <TT
CLASS="FILENAME"
>config.jsp</TT
>, add another
    <TT
CLASS="FILENAME"
>url-pattern</TT
> tag like below:
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>        ...
        &#60;url-pattern&#62;/jsp/query.jsp&#60;/url-pattern&#62;
        &#60;url-pattern&#62;/jsp/config.jsp&#60;/url-pattern&#62;
        ...
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>By default, the username and password for the pages will be "inca".  To
      change this, edit <TT
CLASS="FILENAME"
>$INCA_DIST/etc/realm.properties</TT
> and customize the
      username and password for your installation.  If you do not want to store the
      password in plain text, use Jetty's password utility described in <A
HREF="#HTTPS-CREDS"
>Section 6.13</A
>.</P
><P
>Then restart the consumer. </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca restart  consumer</PRE
></FONT
></TD
></TR
></TABLE
><P
>The next time you view the status pages, you should see a login like:</P
><P
><IMG
SRC="figures/consumer/ug-consumer-password.png"
ALIGN="CENTER"></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-REPORTERS"
>7. Reporters and Repositories</A
></H2
><P
>Inca reporters are executable programs and scripts, generally small, that test
and report the health and characteristics of a system.  The figure below 
illustrates a typical Inca installation where reporters are retrieved from a repository and sent to Reporter 
Managers on Grid resources by the Agent.  The Reporter Managers then execute the reporters based on series configuration from the 
Agent and send the XML reports to the Depot for storage.
  <P
><IMG
SRC="figures/arch/arch-reporters.jpg"
ALIGN="CENTER"></P
></P
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="REPORTER-CMDLINE"
>7.1. Executing Reporters</A
></H3
><P
>Because they are executables, Inca reporters are independent of the rest of the Inca system.
Reporters can be executed manually from a command line or automatically as part of an Inca installation.  
Incorporating your own reporters into a running Inca installation requires only writing the reporters (<A
HREF="#REPORTER-WRITING"
>Section 7.2</A
>), 
including them in a repository (<A
HREF="#REPORTER-REPOSITORIES"
>Section 7.3</A
>), 
and configuring the repository's series using incat (<A
HREF="#USERGUIDE-INCAT"
>Section 5</A
>).  Most developers will execute reporters from the 
command line before adding them to their Inca installation.   After installing Inca, you can try executing some of the reporters that come
with the distribution from the command line:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST/Inca-Reporter-*/bin
% setenv PERL5LIB ../lib/perl
% setenv PYTHONPATH ../lib/python
% ./cluster.compiler.gcc.version </PRE
></FONT
></TD
></TR
></TABLE
>
You should now see XML output like that in <A
HREF="#REPORTER-OUTPUT"
>Section 7.2.2</A
>.</P
><P
>All Inca reporters must support the command line arguments listed in the table
below.  In addition, a reporter may support additional command line arguments
specific to that reporter's task.</P
><DIV
CLASS="TABLE"
><A
NAME="AEN1548"
></A
><P
><B
>Table 4. Reporter Command Line Arguments</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><COL><THEAD
><TR
><TH
><P
>Argument</P
></TH
><TH
><P
>Valid Values</P
></TH
><TH
><P
>Default Value</P
></TH
><TH
><P
>Description</P
></TH
></TR
></THEAD
><TBODY
><TR
><TD
><P
>-help</P
></TD
><TD
><P
>yes|no</P
></TD
><TD
><P
>no</P
></TD
><TD
><P
>    Do not run the reporter; instead, print information on running it.  If
    the value of the verbose argument is 0, this information will be readable
    text; otherwise, it will be reporter XML.
    </P
></TD
></TR
><TR
><TD
><P
>-log</P
></TD
><TD
><P
>0-5|debug|error|info|system|warn</P
></TD
><TD
><P
>0</P
></TD
><TD
><P
>    Include reporter log messages in the reporter output.  The named argument
    values indicate specific types of log messages that should be included.  0
    indicates no log messages should be included; the other numeric values
    indicate error, warn, system, info, and debug messages, cumulatively.  For
    example, --log=2 indicates both error and warn messages should be included,
    while --log=4 includes error, warn, system, and info messages.
    </P
></TD
></TR
><TR
><TD
><P
>-verbose</P
></TD
><TD
><P
>0-2</P
></TD
><TD
><P
>1</P
></TD
><TD
><P
>    Determine what the reporter prints.  A verbose level of 0 indicates that
    the reporter prints only 'completed' or 'failed', depending on the outcome
    of its testing.  Verbose level 1 produces XML that reports the testing
    result, and verbose level 2 adds additional tags to this XML to give
    instructions on running the reporter.
    </P
></TD
></TR
><TR
><TD
><P
>-version</P
></TD
><TD
><P
>yes|no</P
></TD
><TD
><P
>no</P
></TD
><TD
><P
>    Do not run the reporter; instead, print its version number.
    </P
></TD
></TR
></TBODY
></TABLE
></DIV
><P
>Executing a reporter using different arguments:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./cluster.compiler.gcc.version -log=3 
% ./cluster.compiler.gcc.version -help=yes -verbose=0
% ./cluster.compiler.gcc.version -version=yes</PRE
></FONT
></TD
></TR
></TABLE
></P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="REPORTER-WRITING"
>7.2. Writing Reporters</A
></H3
><P
>Reporters can be written in any language as long as 
they output XML according to the schema described in <A
HREF="#REPORTER-SCHEMA"
>Section 7.2.1</A
>.  
New reporter developers may choose to write reporters in Perl or Python since 
the Inca distribution includes sample reporters and API modules in those
languages (<A
HREF="#REPORTER-API"
>Section 7.2.3</A
>) 
for printing XML according to our schema.</P
><P
>NOTE: Because databases impose a 4000 character limit on text fields, the XML portion of the report for logging/debugging and the error message must each be smaller than 4000 characters.  The body XML can be 12000 characters because it is stored in three parts.  If the report XML is greater than its limit, the depot truncates the oversized section from the beginning until it is the right size.</P
><DIV
CLASS="TABLE"
><A
NAME="AEN1606"
></A
><P
><B
>Table 5. Report Character Limits</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><THEAD
><TR
><TH
><P
>Report XML Section</P
></TH
><TH
><P
>Character limit</P
></TH
></TR
></THEAD
><TBODY
><TR
><TD
><P
>log</P
></TD
><TD
><P
>4000</P
></TD
></TR
><TR
><TD
><P
>error (exit) message</P
></TD
><TD
><P
>4000</P
></TD
></TR
><TR
><TD
><P
>body</P
></TD
><TD
><P
>12000</P
></TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="REPORTER-SCHEMA"
>7.2.1. Reporter XML Schema</A
></H4
><P
>In order to promote interoperability between reporters, we define a
specification for how reporter output should be formatted.  Given the
wide acceptance and availability of tools for XML, the specification
requires that reporter output should be formatted using XML.  Furthermore, we
specify a basic schema that the XML should follow so
that we can handle the output in a general manner.   The goal of this schema
is to be flexible enough to express a wide variety of data.</P
><P
>Our approach is to require a number of XML fields which provide metadata about
the output and define one of the fields, body, to be abstract.  The body
field is a placeholder for the formatted output and can be replaced by any XML
 substitution group thereby allowing this schema to accommodate a large variety of output.  In
other words, the basic schema is like an abstract class and the substitution
groups provide for subclassing.  </P
><P
>The reporter schema is visualized in <A
HREF="#REPORTER-SCHEMA-FIG"
>Figure 18</A
>.
<DIV
CLASS="FIGURE"
><A
NAME="REPORTER-SCHEMA-FIG"
></A
><P
><B
>Figure 18. Inca Reporter Schema</B
></P
><P
><IMG
SRC="figures/arch/reporter-schema.jpg"
ALIGN="CENTER"></P
></DIV
></P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="REPORTER-OUTPUT"
>7.2.2. Reporter XML Output</A
></H4
><P
>Here is the output from the successful run of a typical Inca reporter.  The
content and meaning of the XML tags is described below.</P
><DIV
CLASS="FIGURE"
><A
NAME="SAMPLE-REPORT"
></A
><P
><B
>Figure 19. Example of Reporter Output</B
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>&#60;?xml version='1.0'?&#62;
&#60;inca:report xmlns:inca='http://inca.sdsc.edu/dataModel/report_2.1'&#62;
  &#60;gmt&#62;2006-11-17T17:35:40Z&#60;/gmt&#62;
  &#60;hostname&#62;jhayes-Computer.local&#60;/hostname&#62;
  &#60;name&#62;cluster.compiler.gcc.version&#60;/name&#62;
  &#60;version&#62;2&#60;/version&#62;
  &#60;workingDir&#62;/Users/jhayes/Inca/subversion/inca/trunk/devel/reporters/bin&#60;/workingDir&#62;
  &#60;reporterPath&#62;cluster.compiler.gcc.version&#60;/reporterPath&#62;
  &#60;args&#62;
    &#60;arg&#62;
      &#60;name&#62;help&#60;/name&#62;
      &#60;value&#62;no&#60;/value&#62;
    &#60;/arg&#62;
    &#60;arg&#62;
      &#60;name&#62;log&#60;/name&#62;
      &#60;value&#62;0&#60;/value&#62;
    &#60;/arg&#62;
    &#60;arg&#62;
      &#60;name&#62;verbose&#60;/name&#62;
      &#60;value&#62;1&#60;/value&#62;
    &#60;/arg&#62;
    &#60;arg&#62;
      &#60;name&#62;version&#60;/name&#62;
      &#60;value&#62;no&#60;/value&#62;
    &#60;/arg&#62;
  &#60;/args&#62;
  &#60;body&#62;
    &#60;package&#62;
      &#60;ID&#62;gcc&#60;/ID&#62;
      &#60;version&#62;3.3&#60;/version&#62;
    &#60;/package&#62;
  &#60;/body&#62;
  &#60;exitStatus&#62;
    &#60;completed&#62;true&#60;/completed&#62;
  &#60;/exitStatus&#62;
&#60;/inca:report&#62;</PRE
></FONT
></TD
></TR
></TABLE
></DIV
><P
>As shown in <A
HREF="#SAMPLE-REPORT"
>Figure 19</A
>, reporter output begins with an XML preamble and is surrounded by &#60;report&#62; tags.
A prefix with a tag name that references
http://inca.sdsc.edu/dataModel/report_2.1, which is the namespace that defines
the report schema, can also be used.</P
><P
>The following tags are defined within a &#60;report&#62;:</P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="FILENAME"
>gmt</TT
></DT
><DD
><P
>  the time the reporter ran (ISO 8601 format)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>hostname</TT
></DT
><DD
><P
>  host where reporter ran
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>name</TT
></DT
><DD
><P
>  reporter name
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>version</TT
></DT
><DD
><P
>  reporter version number
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>workingDir</TT
></DT
><DD
><P
>  directory where reporter execution begins
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>reporterPath</TT
></DT
><DD
><P
>  local path to reporter file
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>args</TT
></DT
><DD
><P
>	args must contain an arg name/value entry for every argument the reporter supports, 
	including those for which the reporter supplies a default value (help, log, verbose, version)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>log</TT
></DT
><DD
><P
>    OPTIONAL TAG (not shown in <A
HREF="#SAMPLE-REPORT"
>Figure 19</A
> report). Log entries produced by the reporter.  This tag contains one or more
&#60;debug&#62;, &#60;error&#62;, &#60;info&#62;, &#60;system&#62;, and/or &#60;warn&#62;
tags, each of which gives the text of the message and the time it was produced.
Here is a typical example of a log section:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>  &#60;log&#62;
    &#60;system&#62;
      &#60;gmt&#62;2006-11-17T18:28:10Z&#60;/gmt&#62;
      &#60;message&#62;grid-proxy-info 2&#38;gt;&#38;amp;1&#60;/message&#62;
    &#60;/system&#62;
    &#60;debug&#62;
      &#60;gmt&#62;2006-11-17T18:28:10Z&#60;/gmt&#62;
      &#60;message&#62;Checking for grid proxy: Result of command "grid-proxy-info":
         sh: line 1: grid-proxy-info: command not found
      &#60;/message&#62;
    &#60;/debug&#62;
    &#60;error&#62;
      &#60;gmt&#62;2006-11-17T18:28:10Z&#60;/gmt&#62;
      &#60;message&#62;ERROR: Valid proxy needed for file transfer.&#60;/message&#62;
    &#60;/error&#62;
  &#60;/log&#62;</PRE
></FONT
></TD
></TR
></TABLE
>
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>body</TT
></DT
><DD
><P
>    The body tag contains the results of the reporter testing.  The only
requirement for the contents of this tag is that they must be well-formed
XML--tags balanced and no extraneous &#60;, &#62;, and &#38; characters.  <A
HREF="#SAMPLE-REPORT"
>Figure 19</A
>
shows the conventional body for version reporters.
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>exitStatus</TT
></DT
><DD
><P
>Includes the boolean &#60;completed&#62; tag, indicating whether or not the reporter
successfully completed its testing, and the optional &#60;errorMessage&#62; tag,
which contains a string indicating why the reporter failed to complete.
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>help</TT
></DT
><DD
><P
>    OPTIONAL TAG (not shown in <A
HREF="#SAMPLE-REPORT"
>Figure 19</A
> report).  The help tag describes the reporter and how to run it.  Contents include
the reporter name, version, description, and url, detailed descriptions of each
argument, and an optional list of dependencies that the reporter has on other
packages.  For example, here is the &#60;help&#62; section for the gcc version
reporter.
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>  &#60;help&#62;
    &#60;ID&#62;help&#60;/ID&#62;
    &#60;name&#62;cluster.compiler.gcc.version&#60;/name&#62;
    &#60;version&#62;2&#60;/version&#62;
    &#60;description&#62;Reports the version of gcc&#60;/description&#62;
    &#60;url&#62;http://gcc.gnu.org&#60;/url&#62;
    &#60;argDescription&#62;
      &#60;ID&#62;help&#60;/ID&#62;
      &#60;accepted&#62;no|yes&#60;/accepted&#62;
      &#60;description&#62;display usage information (no|yes)&#60;/description&#62;
      &#60;default&#62;no&#60;/default&#62;
    &#60;/argDescription&#62;
    &#60;argDescription&#62;
      &#60;ID&#62;log&#60;/ID&#62;
      &#60;accepted&#62;[012345]|debug|error|info|system|warn&#60;/accepted&#62;
      &#60;description&#62;log message types included in report&#60;/description&#62;
      &#60;default&#62;0&#60;/default&#62;
    &#60;/argDescription&#62;
    &#60;argDescription&#62;
      &#60;ID&#62;verbose&#60;/ID&#62;
      &#60;accepted&#62;[012]&#60;/accepted&#62;
      &#60;description&#62;verbosity level (0|1|2)&#60;/description&#62;
      &#60;default&#62;1&#60;/default&#62;
    &#60;/argDescription&#62;
    &#60;argDescription&#62;
      &#60;ID&#62;version&#60;/ID&#62;
      &#60;accepted&#62;no|yes&#60;/accepted&#62;
      &#60;description&#62;show reporter version (no|yes)&#60;/description&#62;
      &#60;default&#62;no&#60;/default&#62;
    &#60;/argDescription&#62;
    &#60;dependency&#62;
      &#60;ID&#62;Inca::Reporter&#60;/ID&#62;
    &#60;/dependency&#62;
    &#60;dependency&#62;
      &#60;ID&#62;Inca::Reporter::Version&#60;/ID&#62;
    &#60;/dependency&#62;
  &#60;/help&#62;</PRE
></FONT
></TD
></TR
></TABLE
>
  </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="REPORTER-API"
>7.2.3. Reporter APIs</A
></H4
><P
>The Inca release includes a set of <A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/perl.html"
TARGET="_top"
>Perl modules</A
> and a <A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/python.html"
TARGET="_top"
>Python package</A
> that make it easier to
develop reporters that produce output as shown in <A
HREF="#REPORTER-OUTPUT"
>Section 7.2.2</A
>
 and conform to the schema described in <A
HREF="#REPORTER-SCHEMA"
>Section 7.2.1</A
>.  
The following are a list of modules and their purpose (click on module names for manpages):</P
><P
></P
><OL
TYPE="1"
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/Inca/Reporter.html"
TARGET="_top"
>Inca::Reporter</A
></P
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/inca.Reporter-module.html"
TARGET="_top"
>inca.Reporter</A
></P
><P
>  This module is the general reporter API and is the base class for all types
  of reporters.  It automates determination of hostname, gmt, reporter name,sx
  etc.,  handles command-line parsing, provides an interface for log messages,
  and handles XML generation.
  </P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/Inca/Reporter/GlobusUnit.html"
TARGET="_top"
>Inca::Reporter::GlobusUnit</A
></P
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/inca.GlobusUnitReporter-module.html"
TARGET="_top"
>inca.GlobusUnitReporter</A
></P
><P
>  This module is used for Globus unit tests.  it provides methods for running
  Globus jobs.
  </P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/Inca/Reporter/GridProxy.html"
TARGET="_top"
>Inca::Reporter::GridProxy</A
></P
><P
>  The Inca::Reporter::GridProxy package is a pseudo-module indicating that a
  reporter requires a proxy credential in order to execute.  The following is
  an example of a perl reporter that requires a proxy.  Python reporters should
  use the equivalent, reporter.addDependency('inca.GridProxyReporter').
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>#!/usr/bin/env perl

use strict;
use warnings;
use Inca::Reporter::SimpleUnit;

my $reporter = new Inca::Reporter::SimpleUnit(
  name =&#62; 'grid.middleware.globus.unit.proxy',
  version =&#62; 2,
  description =&#62; 'Verifies that user has valid proxy',
  url =&#62; 'http://www.globus.org/security/proxy.html',
  unit_name =&#62; 'validproxy'
);
$reporter-&#62;addDependency( "Inca::Reporter::GridProxy" );
$reporter-&#62;processArgv(@ARGV);

# check to see if proxy has enough time left
$reporter-&#62;log( 'info', "X509_USER_PROXY=$ENV{X509_USER_PROXY}" );
my $output = $reporter-&#62;loggedCommand('grid-proxy-info -exists -hours 4 2&#62;&#38;1');
if( $? != 0 ) {
  $reporter-&#62;unitFailure("grid-proxy-info failed: $! $output");
} else {
  $reporter-&#62;unitSuccess();
}
$reporter-&#62;print();</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/Inca/Reporter/Performance.html"
TARGET="_top"
>Inca::Reporter::Performance</A
></P
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/inca.PerformanceReporter-module.html"
TARGET="_top"
>inca.PerformanceReporter</A
></P
><P
>  This module is used to gather system performance metrics.  It defines a
  common &#60;body&#62; schema for system/software performance metric reporters
  and produces a collection of benchmarks, each a set of parameters
  (name/value) and statistics (name/value/units). A dependent Benchmark class
  is used to define individual benchmarks.
  </P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/Inca/Reporter/SimpleUnit.html"
TARGET="_top"
>Inca::Reporter::SimpleUnit</A
></P
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/inca.SimpleUnitReporter-module.html"
TARGET="_top"
>inca.SimpleUnitReporter</A
></P
><P
>  This module is used for software unit tests.  It defines a common
  &#60;body&#62; schema for unit test reporters and provides methods for
  recording results of unit tests.
  </P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/Inca/Reporter/Usage.html"
TARGET="_top"
>Inca::Reporter::Usage</A
></P
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/inca.UsageReporter-module.html"
TARGET="_top"
>inca.UsageReporter</A
></P
><P
>  This module is used for creating simple usage reports.
  </P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/Inca/Reporter/Version.html"
TARGET="_top"
>Inca::Reporter::Version</A
></P
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/inca.VersionReporter-module.html"
TARGET="_top"
>inca.VersionReporter</A
></P
><P
>  This module is used for reporting software versions.  It defines a common
  &#60;body&#62; schema for version reporters, offers support for subpackage
  versions, and provides convenience methods for common ways of determining
  version.
  </P
></LI
></OL
><P
>The following is the Perl code for a reporter that produces output like <A
HREF="#SAMPLE-REPORT"
>Figure 19</A
>.  This reporter 
uses the Inca::Reporter::Version module to determine the version of gcc.  Examples of reporters that use the other modules are 
located in $INCA_DIST/Inca-Reporter-*/bin.
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>#!/usr/bin/env perl

use strict;
use warnings;
use Inca::Reporter::Version;

my $reporter = new Inca::Reporter::Version(
  name =&#62; 'cluster.compiler.gcc.version',
  version =&#62; 2,
  description =&#62; 'Reports the version of gcc',
  url =&#62; 'http://gcc.gnu.org',
  package_name =&#62; 'gcc'
);
$reporter-&#62;processArgv(@ARGV);

$reporter-&#62;setVersionByExecutable('gcc -dumpversion');
$reporter-&#62;print();</PRE
></FONT
></TD
></TR
></TABLE
></P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="WRITING-TIPS"
>7.2.4. Reporter Writing Tips</A
></H4
><P
>In general using the reporter APIs described in 
<A
HREF="#REPORTER-API"
>Section 7.2.3</A
> will help to produce the most 
efficient reporter code.  There are additional considerations when
writing reporters that:
<P
></P
><UL
><LI
><P
>create temporary files and directories</P
></LI
><LI
><P
>cd to directories with variable names</P
></LI
><LI
><P
>include variable information like timestamps or PIDs in the
exit error message</P
></LI
></UL
></P
><P
>For reporters that create temporary files or directories, the APIs offer 
a function called "tempFile" to remove them.  If the tempFile function is used then 
additional code to remove temporary files or directories (e.g. unlink or rm)
is not required.  The reporter below uses the tempFile function to remove 
the temp $scratchDir it creates.  </P
><P
>It's best practice never to use a PID or variable information as a reporter
argument value or to include PIDs or timestamps in error messages.  Reporters
that incorporate this sort of information will create a new report in the Inca
database each time the reporter runs, which may slow query response.  If a
reporter error message may contain variable information, a function to replace 
the variable can be written to normalize the error (like the "failClean"
function in the reporter below).</P
><P
> <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>#!/usr/bin/env perl

use strict;
use warnings;
use Inca::Reporter::SimpleUnit;
use Date::Parse;
use Cwd;

my $reporter = new Inca::Reporter::SimpleUnit(
  name =&#62; 'security.ca.unit',
  version =&#62; 9,
  description =&#62; 'Checks whether the CA certificates or CRLs have expired',
  unit_name =&#62; 'caCertNCrlExpire'
);

 ...

my $scratchDir = "/tmp/security.ca.unit.$$";
if ( ! mkdir($scratchDir) ) {
  failClean("Cannot mkdir scratch dir $scratchDir"); 
}
$reporter-&#62;tempFile( $scratchDir );
if ( ! chdir($scratchDir) ) {
  failClean("Cannot change to scratch dir $scratchDir"); 
}

 ...

if ($err ne ""){
  failClean($err);
} else {
  $reporter-&#62;unitSuccess();
  $reporter-&#62;print();
}

sub failClean {
  my $err = shift;
  $err =~ s/--\d{2}:\d{2}:\d{2}--/--xx:xx:xx--/g;
  $err =~ s/$$/PID/g;
  $reporter-&#62;failPrintAndExit($err);
}</PRE
></FONT
></TD
></TR
></TABLE
></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="REPORTER-REPOSITORIES"
>7.3. Reporter Repositories</A
></H3
><P
>The Inca system retrieves reporters from external collections called
repositories.  A reporter repository is simply a file directory, accessed via a
file: or http: URL, that contains a catalog file named Packages.gz.  This
gzipped file includes a sequence of name:value attribute pairs for every
reporter and support package in the repository; blank lines separate the
attributes for different reporters.  For example, here is a portion of the
Packages.gz file for the Inca standard reporter repository.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>arguments: help no|yes no;log [012345]|debug|error|info|system|warn 0;verbose [0
12] 1;version no|yes no
dependencies: Inca::Reporter;Inca::Reporter::Version
description: Reports the version of tgusage
file: cluster.accounting.tgusage.version
name: cluster.accounting.tgusage.version
url: http://www.teragrid.org
version: 2

arguments: help no|yes no;log [012345]|debug|error|info|system|warn 0;verbose [0
12] 1;version no|yes no
dependencies: Inca::Reporter;Inca::Reporter::SimpleUnit
description: ant hello world test
file: cluster.admin.ant.unit
name: cluster.admin.ant.unit
version: 3

arguments: help no|yes no;log [012345]|debug|error|info|system|warn 0;verbose [0
12] 1;version no|yes no
dependencies: Inca::Reporter;Inca::Reporter::Version
description: Reports the version of Apache Ant
file: cluster.admin.ant.version
name: cluster.admin.ant.version
version: 2&#13;</PRE
></FONT
></TD
></TR
></TABLE
><P
>Of the attributes shown, only file and name are required.  The file attribute
gives the relative path to the reporter file, and the name attribute specifies
the unique package name of the reporter.  If the reporter requires support
packages to execute, it should include a dependencies attribute with a
semicolon-separated list of package names.  For more information about reporter 
package dependencies see <A
HREF="#PACKAGE-DEPEND"
>Section 7.3.1</A
>.  The incat administration tool uses
the Packages.gz file's arguments and description attributes as part of its series edit dialog.
The value of the arguments attribute is a semicolon-separated list giving the
name, value pattern, and default value, if any, for each supported command-line
argument.</P
><P
>To create a local repository for your own reporters, you only need to collect
them into a directory and create a Packages.gz in that directory. The default Inca installation has a 
Packages.gz file in $INCA_DIST/Inca-Reporter-* that can be added in incat.  Inca also supplies 
<A
HREF="http://inca.sdsc.edu/repository/latest/cgi-bin/list_reporters.cgi"
TARGET="_top"
>a web accessible
repository</A
> that can be added in incat as "http://inca.sdsc.edu/repository/latest/". </P
><P
>The Inca
distribution includes a perl script, incpack, that can create Packages.gz for
you.  Simply run incpack with a list of reporters that you want to include in
Packages.gz, e.g.,</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% perl incpack jade.version f77.unit vim.version</PRE
></FONT
></TD
></TR
></TABLE
><P
>incpack runs each of the listed reporters with --help=yes --verbose=1 to
extract a standard set of attributes.  If your reporters use the Inca reporter
APIs, you might need to run incpack with -I switches to specify the location of
the Inca libraries, like this.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% perl incpack -I ${INCA_DIST}/lib/perl -I ${INCA_DIST}/lib/python jade.version f77.unit vim.version</PRE
></FONT
></TD
></TR
></TABLE
><P
>For more information about incpack usage, click <A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/incpack.html"
TARGET="_top"
>here</A
>.</P
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="PACKAGE-DEPEND"
>7.3.1. Reporter Package Dependencies</A
></H4
><P
>Some reporters may require a CPAN Perl module, C library, compiled executable, or 
some other tar.gz packaged dependency.  Reporters can use packaged
dependencies if the dependencies are 1) bundled into a tar.gz file, 2) added
using incpack to the reporter repository, and 3) noted as a dependency in the
reporters.</P
><P
>For example, the <TT
CLASS="FILENAME"
>cluster.math.blas.unit.level1</TT
> reporter wraps
the Level 1 BLAS Test Suite available from the <A
HREF="http://www.netlib.org/blas/"
TARGET="_top"
>Basic 
Linear Algebra Subprograms (BLAS) website</A
>.  To add the BLAS Test Suite
as a dependency to the <TT
CLASS="FILENAME"
>cluster.math.blas.unit.level1</TT
>
reporter, use the following steps:  </P
><P
></P
><OL
TYPE="1"
><LI
><P
>Package the Level1 BLAS Test Suite files
(fortran code) into a tar.gz called <TT
CLASS="FILENAME"
>blasTestSuite.tar.gz</TT
>
along with a Makefile and configure script.  The <TT
CLASS="FILENAME"
>blasTestSuite.tar.gz</TT
> file 
contains:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>Makefile.in     cblat2d         configure       dblat2.f        dblat3d         sblat2d         zblat1.f        zblat3.f
cblat1.f        cblat3.f        configure.in    dblat2d         sblat1.f        sblat3.f        zblat2.f        zblat3d
cblat2.f        cblat3d         dblat1.f        dblat3.f        sblat2.f        sblat3d         zblat2d</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Update the reporter repository with the package dependency using
an .attrib file.  An .attrib file contains information about the
dependency such as its name, version number, description, a descriptive url
and dependencies.  The .attrib file needs to be prefixed with the
tar.gz name.  For example, the BLAS Test Suite's .attrib would be named
<TT
CLASS="FILENAME"
>blasTestSuite.tar.gz.attrib</TT
> and contain:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>name: blasTestSuite
version: 1.0
description: Test programs for the BLAS library
url: http://inca.sdsc.edu
dependencies:</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>Both the <TT
CLASS="FILENAME"
>blasTestSuite.tar.gz</TT
> and
<TT
CLASS="FILENAME"
>blasTestSuite.tar.gz.attrib</TT
> files are then placed in the
<TT
CLASS="FILENAME"
>share</TT
> directory or can be placed anwhere inside the
repository directory.   Then the dependency is added to the repository using
incpack (see <A
HREF="#UPDATE-REPOSITORY"
>Section 7.3.2</A
>
for more about repository updates):
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% sbin/incpack share/blasTestSuite.tar.gz
Note: Appending to existing Packages.gz file
share/blasTestSuite.tar.gz</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Include the following line in reporters that use the blasTestSuite dependency 
 before $reporter-&#62;processArgv is called.   Use the 
name specified in the .attrib file:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>$reporter-&#62;addDependency('blasTestSuite');</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>Then add the reporter to the repository using incpack:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% sbin/incpack -I lib/perl -I lib/python bin/cluster.math.blas.unit.level1
Note: Appending to existing Packages.gz file
bin/cluster.math.blas.unit.level1</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></OL
><P
>After unzipping and untarring the package file, the reporter manager builds
the package in one of several ways, depending on the contents of the package
directory.  If a <TT
CLASS="FILENAME"
>configure</TT
> is present, the reporter
manager executes these commands to build the package:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./configure --prefix=$RM_INSTALL_DIR/var/reporter-packages
% [g]make
% [g]make install</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>Otherwise, if a <TT
CLASS="FILENAME"
>[Mm]akefile</TT
> is present, then the reporter
manager executes these commands:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% [g]make INSTALL_DIR=$RM_INSTALL_DIR/var/reporter-packages 
% [g]make INSTALL_DIR=$RM_INSTALL_DIR=/var/reporter-packages</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>Otherwise, if a <TT
CLASS="FILENAME"
>Makefile.PL</TT
> file (i.e., Perl package)
is found, then the following is executed:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% perl -I$RM_INSTALL_DIR/var/reporter-packages/lib/perl  Makefile.PL \
  PREFIX=$RM_INSTALL_DIR/var/reporter-packages/lib/perl \
  LIB=$RM_INSTALL_DIR/var/reporter-packages/lib/perl \
  INSTALLDIRS=perl \
  INSTALLSCRIPT=$RM_INSTALL_DIR/var/reporter-packages/bin \
  INSTALLMAN1DIR=$RM_INSTALL_DIR/var/reporter-packages/man/man1 \
  INSTALLMAN3DIR=$RM_INSTALL_DIR/var/reporter-packages/man/man3
% [g]make
% [g]make install</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>Otherwise, if a <TT
CLASS="FILENAME"
>Build.PL</TT
> file is found, then the
following commands are executed:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% perl -I$RM_INSTALL_DIR/var/reporter-packages/lib/perl Build.PL \
  --install_path lib=$RM_INSTALL_DIR/var/reporter-packages/lib/perl \
  --install_path libdoc=$RM_INSTALL_DIR/var/reporter-packages/man/man3 \
  --install_path bindoc=$RM_INSTALL_DIR/var/reporter-packages/man/man1 \
  --install_path bin=$RM_INSTALL_DIR/var/reporter-packages/bin \
  --install_path script=$RM_INSTALL_DIR/var/reporter-packages/bin \
  --install_path arch=$RM_INSTALL_DIR/var/reporter-packages/lib/perl
% perl -I$RM_INSTALL_DIR/var/reporter-packages/lib/perl Build
% perl -I$RM_INSTALL_DIR/var/reporter-packages/lib/perl Build install</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>If none of the files listed above are present, the reporter manager assumes
that no build step is needed for the package.</P
><P
>The reporter manager sets the <TT
CLASS="FILENAME"
>INSTALL_DIR</TT
> environment
variable before running a reporter.  Reporters that depend on other packages
can use this variable to locate the package files--libraries in
<TT
CLASS="FILENAME"
>$INSTALL_DIR/lib</TT
>, binaries in
<TT
CLASS="FILENAME"
>$INSTALL_DIR/bin</TT
>, etc.</P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="UPDATE-REPOSITORY"
>7.3.2. Updating Reporter Repositories</A
></H4
><P
>The Inca agent will detect changes to your reporter repository and
automatically send changes to the appropriate reporter managers if you:</P
><P
></P
><OL
TYPE="1"
><LI
><P
>update the reporter version number (ie. change a line like "version =&#62;
1" to "version =&#62; 2" in the body of the reporter)</P
></LI
><LI
><P
>make sure the reporter permissions are set so the agent can fetch the
reporter (755 is the standard reporter permission)</P
></LI
><LI
><P
>update your Packages.gz file using 
<A
HREF="http://inca.sdsc.edu/releases/2.6/repdocs/incpack.html"
TARGET="_top"
>incpack</A
>.  The command will
be something like:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST/Inca-Reporter-*; ./sbin/incpack -I lib bin/&#60;reportername&#62;</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>wait for the agent to deploy the new reporter automatically (it looks
for new reporters every four hours by default),</P
><P
>*OR*</P
><P
>restart the agent,</P
><P
>*OR*</P
><P
>Connect to the agent in incat, select the Repositories tab, then press the
Refresh button under the repository panel.</P
></LI
></OL
><P
>If the revised reporter still isn't deployed, look for any errors in the
$INCA_DIST/var/agent.log that indicate the
agent was unable to fetch the reporter or skipped over updating it.  Make
sure there is an active series that uses the reporter with "use latest
version" checked on the resource your intend it to run on incat.  Look for
$INCA_DIST/var/repository/repository.xml entries for the
reporter with "&#60;latestVersion&#62;false&#60;/latestVersion&#62;" (should be
"&#60;latestVersion&#62;true&#60;/latestVersion&#62;" to get the updated reporters).</P
></DIV
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-APIS"
>8. Inca Client APIs</A
></H2
><P
>Currently, we provide Perl and Java client APIs to the Inca agent and
depot.</P
><DIV
CLASS="TABLE"
><A
NAME="AEN1858"
></A
><P
><B
>Table 6. Inca client APIs</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><THEAD
><TR
><TH
><P
>Component</P
></TH
><TH
><P
>Java API</P
></TH
><TH
><P
>Perl API</P
></TH
></TR
></THEAD
><TBODY
><TR
><TD
><P
>client</P
></TD
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/javawsdocs/edu/sdsc/inca/Client.html"
TARGET="_top"
>edu.sdsc.inca.Client</A
></P
></TD
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/wsdocs/Inca/Client.html"
TARGET="_top"
>Inca::Client</A
></P
></TD
></TR
><TR
><TD
><P
>agent</P
></TD
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/javawsdocs/edu/sdsc/inca/AgentClient.html"
TARGET="_top"
>edu.sdsc.inca.AgentClient</A
></P
></TD
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/wsdocs/Inca/AgentClient.html"
TARGET="_top"
>Inca::AgentClient</A
></P
></TD
></TR
><TR
><TD
><P
>depot</P
></TD
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/javawsdocs/edu/sdsc/inca/DepotClient.html"
TARGET="_top"
>edu.sdsc.inca.DepotClient</A
></P
></TD
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/wsdocs/Inca/DepotClient.html"
TARGET="_top"
>Inca::DepotClient</A
></P
></TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-WEBSERVICES"
>9. Web Services</A
></H2
><P
>To access Inca from a Web services API, you will need to install the
Inca web services component, <TT
CLASS="FILENAME"
>incaws</TT
>. </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% wget http://inca.sdsc.edu/releases/2.6/incaInstall.sh
% sh incaInstall.sh $INCA_DIST incaws</PRE
></FONT
></TD
></TR
></TABLE
><P
>The results should look similar to:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>Retrieving http://inca.sdsc.edu/releases/latest/Inca-WS.tar.gz
--12:59:23--  http://inca.sdsc.edu/releases/latest/Inca-WS.tar.gz
           =&#62; `Inca-WS.tar.gz'
Resolving inca.sdsc.edu... 198.202.75.28
Connecting to inca.sdsc.edu|198.202.75.28|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1,226,347 (1.2M) [application/x-tar]

100%[====================================&#62;] 1,226,347     --.--K/s             

12:59:23 (81.68 MB/s) - `Inca-WS.tar.gz' saved [1226347/1226347]

Unpacking http://inca.sdsc.edu/releases/latest/Inca-WS.tar.gz
Inca-WS-1.6421/
Inca-WS-1.6421/lib/
...
Inca-WS-1.6421/etc/IncaWS.wsdl
Inca-WS-1.6421/version.svn
Will install Inca prerequisite Net::SSLeay
Will install Inca prerequisite IO::Socket::SSL
Will install Inca prerequisite Expat
Will install Inca prerequisite LWP::UserAgent
Will install Inca prerequisite MIME::Base64
Will install Inca prerequisite SOAP::Lite
Writing Makefile.perl.inc for Inca-WS
Inca-WS installed</PRE
></FONT
></TD
></TR
></TABLE
><P
>To start incaws, specify the port, credentials, and hostname/port for
the Inca agent and depot as below.  Replace "origHost", "agentHost" and "depotHost" with the correct names for your installation.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST
% ./bin/inca incaws \
 --auth=yes \
 --cert=etc/agentcert.pem \
 --key=etc/agentkey.pem \
 --trusted=etc/trusted/<STRONG
><FONT
COLOR="RED"
>origHost</FONT
></STRONG
>cert.pem \
 --port=8001 \
 --password=yes \
 <STRONG
><FONT
COLOR="RED"
>depotHost</FONT
></STRONG
>:6324 \
 <STRONG
><FONT
COLOR="RED"
>agentHost</FONT
></STRONG
>:6323
<STRONG
><FONT
COLOR="RED"
>enter password (no prompt displayed)</FONT
></STRONG
></PRE
></FONT
></TD
></TR
></TABLE
><P
>Check to make sure the incaws is running on port 8001:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% netstat -an | grep 8001
tcp4       0      0  *.8001                 *.*                    LISTEN</PRE
></FONT
></TD
></TR
></TABLE
>
Error logs are in $INCA_DIST/var.</P
><P
>The WSDL file for the incaws component is in <TT
CLASS="FILENAME"
>$INCA_DIST/etc/IncaWS.wsdl</TT
>.  The following table summarizes the available functions. </P
><DIV
CLASS="TABLE"
><A
NAME="AEN1914"
></A
><P
><B
>Table 7. Web services functions</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><THEAD
><TR
><TH
><P
>Function</P
></TH
><TH
><P
>Description</P
></TH
></TR
></THEAD
><TBODY
><TR
><TD
><P
>getCatalog( [$url] )</P
></TD
><TD
><P
>Asks the agent to retrieve and return the package catalog
      from the reporter repository accessed via $url.  An undefined $url
      indicates that the agent should return a merged catalog for all known
      repositories.</P
></TD
></TR
><TR
><TD
><P
>getConfig()</P
></TD
><TD
><P
>Asks the agent to return XML for the Inca deployment
      configuration.  </P
></TD
></TR
><TR
><TD
><P
>pingAgent( $string )</P
></TD
><TD
><P
>Check that the Inca agent is accessible. </P
></TD
></TR
><TR
><TD
><P
>pingDepot( $string )</P
></TD
><TD
><P
>Check that the Inca depot is accessible. </P
></TD
></TR
><TR
><TD
><P
>queryGuids()</P
></TD
><TD
><P
>Asks the depot to return a space-separated list of known suite guids.  </P
></TD
></TR
><TR
><TD
><P
>queryHql($hql)</P
></TD
><TD
><P
>Asks the depot use the HQL select statement $hql to extract
      and return information from the DB.  On success, returns a reference to
      an array that contains the objects selected by the select
      statement.</P
></TD
></TR
><TR
><TD
><P
>queryInstance($instanceId, $configId)</P
></TD
><TD
><P
>Asks the depot to report details about one particular
      invocation of a reporter.  $instanceId is the DB id of the instance for
      the invocation; $configId the related series configuration DB id.  On
      success, returns a reference to a single-element array that contains a
      ReportDetails document (described in <A
HREF="#CONSUMER-REPORT-DETAILS-XML"
>Section 6.5.1</A
>) 
      for the instance.</P
></TD
></TR
><TR
><TD
><P
>querySeries($configId)</P
></TD
><TD
><P
>Asks the depot to retrieve information about all instances
      related to the series configuration identified by $configId.  On
      success, returns a reference to an array that contains a set of
      ReportDetail documents (described in <A
HREF="#CONSUMER-REPORT-DETAILS-XML"
>Section 6.5.1</A
>) 
      related to the series.
      </P
></TD
></TR
><TR
><TD
><P
>querySuite($guid)</P
></TD
><TD
><P
>Asks the depot to retrieve information about all the series
      of the suite identified by $guid.  On success, returns a reference to an
      array that contains a set of ReportSummary documents (described in <A
HREF="#CONSUMER-REPORT-SUMMARY-XML"
>Section 6.6</A
>) related to the
      series configurations of the suite.  </P
></TD
></TR
></TBODY
></TABLE
></DIV
><P
>Below shows an example of how to access the Inca web services from Perl
using SOAP::Lite.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>use SOAP::Lite;
use Cwd;

my $cwd = getcwd();
my $ws = SOAP::Lite-&#62;service("file:$cwd/etc/IncaWS.wsdl");

# check agent and depot are available
print $ws-&#62;pingAgent('hello agent'), "\n";
print $ws-&#62;pingDepot('hello depot'), "\n";

# get the Inca configuration
print $ws-&#62;getConfig(), "\n";
my $guid = $ws-&#62;queryGuids();

# get the latest instances of a suite
my $results = $ws-&#62;querySuite( $guid );
for my $result ( @{$results} ) {
  print $result;
}</PRE
></FONT
></TD
></TR
></TABLE
><P
>Place the above code in a file called <TT
CLASS="FILENAME"
>$INCA_DIST/sampleWS.pl</TT
>
and set the environment variable PERL5LIB to
<TT
CLASS="FILENAME"
>$INCA_DIST/lib/perl</TT
>.  Then type, </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% perl sampleWS.pl</PRE
></FONT
></TD
></TR
></TABLE
><P
>When run against the default installation, the results should look
similar to below.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>hello agent
hello depot
&#60;inca:inca xmlns:inca="http://inca.sdsc.edu/dataModel/inca_2.0"&#62;
&#60;repositories&#62;
  &#60;repository&#62;http://inca.sdsc.edu/repository/latest&#60;/repository&#62;
&#60;/repositories&#62;
&#60;resourceConfig&#62;
  &#60;resources&#62;
    &#60;resource&#62;
        &#60;name&#62;defaultGrid&#60;/name&#62;
        &#60;xpath&#62;//resource[matches(name, "localSite")]&#60;/xpath&#62;
      &#60;macros&#62;
 ...
  &#60;/resources&#62;
&#60;/resourceConfig&#62;
&#60;suites&#62;
  &#60;suite&#62;
    &#60;seriesConfigs&#62;
      &#60;seriesConfig&#62;
        &#60;series&#62;
          &#60;name&#62;cluster.math.atlas.version&#60;/name&#62;
          &#60;uri&#62;http:// ... cluster.math.atlas.version&#60;/uri&#62;
          &#60;args&#62;
            &#60;arg&#62;
              &#60;name&#62;cc&#60;/name&#62;
              &#60;value&#62;cc&#60;/value&#62;
            &#60;/arg&#62;
            &#60;arg&#62;
              &#60;name&#62;dir&#60;/name&#62;
              &#60;value/&#62;&#60;/arg&#62;
            &#60;arg&#62;
              &#60;name&#62;help&#60;/name&#62;
              &#60;value&#62;no&#60;/value&#62;
            &#60;/arg&#62;
            &#60;arg&#62;
              &#60;name&#62;log&#60;/name&#62;
              &#60;value&#62;3&#60;/value&#62;
            &#60;/arg&#62;
            &#60;arg&#62;
              &#60;name&#62;verbose&#60;/name&#62;
              &#60;value&#62;1&#60;/value&#62;
            &#60;/arg&#62;
 ...
        &#60;action&#62;add&#60;/action&#62;
      &#60;/seriesConfig&#62;
    &#60;/seriesConfigs&#62;
    &#60;name&#62;sampleSuite&#60;/name&#62;
    &#60;guid&#62;incas://rocks-101.sdsc.edu:6323/sampleSuite&#60;/guid&#62;
    &#60;description/&#62;
    &#60;version&#62;1&#60;/version&#62;
  &#60;/suite&#62;
&#60;/suites&#62;
&#60;/inca:inca&#62;

&#60;reportSummary xmlns="http://inca.sdsc.edu/queryResult/reportSummary_2.0"&#62;
  &#60;hostname xmlns=""&#62;localResource&#60;/hostname&#62;
  &#60;uri xmlns=""&#62;http:// ... cluster.math.atlas.version&#60;/uri&#62;
  &#60;nickname xmlns=""&#62;atlas_version&#60;/nickname&#62;
  &#60;seriesConfigId xmlns=""&#62;1&#60;/seriesConfigId&#62;
  &#60;instanceId xmlns=""&#62;24&#60;/instanceId&#62;
  &#60;gmt xmlns=""&#62;2007-02-01T13:21:01.000-08:00&#60;/gmt&#62;
  &#60;body xmlns:rep="http://inca.sdsc.edu/dataModel/report_2.1" xmlns=""/&#62;
  &#60;errorMessage xmlns=""&#62;Cannot locate ATLAS installation; use
-dir&#60;/errorMessage&#62;                    
&#60;/reportSummary&#62;
...</PRE
></FONT
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-SECURITY"
>10. Security</A
></H2
><P
>By default, inca components use ssl to communicate with each other.  Credentials are automatically generated with the "bin/inca createauth" command described in step <A
HREF="#QS-STEP4"
>4</A
> of the quickstart guide.  The createauth command creates keys and certificates for each inca component (the agent, depot, consumer and incat) and stores them in the $INCA_DIST/etc directory.</P
><P
>Inca can also be run without ssl communication (credentials then do not need to be created with the "createauth" command).  To turn off ssl communication, edit the $INCA_DIST/etc/common/inca.properties file as follows:
<P
></P
><OL
TYPE="1"
><LI
><P
>replace all instances of "incas" with "inca"</P
></LI
><LI
><P
>change these lines to turn authentication off:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>9 # To turn authentication (i.e., SSL communication) off and on
10 inca.agent.auth=false
11 #inca.agent.auth=true
...
67 # To turn authentication (i.e., SSL communication) off and on
68 inca.depot.auth=false
69 #inca.depot.auth=true
...
110 # To turn authentication (i.e., SSL communication) off and on
111 inca.consumer.auth=false
112 #inca.consumer.auth=true</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></OL
></P
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-ADVANCED-CONFIG"
>11. Advanced Configuration</A
></H2
><P
>This section describes advanced configuration options such as
installing components in non-default locations and changing other default properties.</P
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="COMP-OPTIONS"
>11.1. Inca Component Options</A
></H3
><P
>Each inca component has a set of options that can be set in either the $INCA_DIST/etc/common/inca.properties file or from the command line.  The inca.properties file has a list of name value pairs of the format "inca.component.property=value".  For example, to start the agent on port 5323 instead of 6323 and enter the password on the command line rather than get it from standard in, you could: </P
><P
></P
><OL
TYPE="1"
><LI
><P
>edit $INCA_DIST/etc/common/inca.properties and replace:</P
><P
></P
><UL
><LI
><P
>"inca.agent.port=6323" with "inca.agent.port=5323"</P
></LI
><LI
><P
>"inca.agent.password=stdin:password&#62;" with "inca.agent.password=pass:<STRONG
><FONT
COLOR="RED"
>&#60;password&#62;</FONT
></STRONG
>" (where &#60;password&#62; is the password set with the createauth command)</P
></LI
></UL
><P
>execute:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca start agent</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
><STRONG
><FONT
COLOR="RED"
>OR</FONT
></STRONG
> execute the following command:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca start agent -p 5323 -P pass:<STRONG
><FONT
COLOR="RED"
>&#60;password&#62;</FONT
></STRONG
></PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></OL
><P
>Man pages with component options are described in <A
HREF="#USERGUIDE-MAN"
>Section 12</A
>.</P
><P
>Note:  To change the port of the consumer, see <A
HREF="#CONSUMER-PORT"
>Section 6.11</A
>.</P
><P
>Note: if you have more than 5 reporter managers running, increase the number of agent and depot threads in the inca.properties file 
to be 10 more than the number of reporter managers.  For example, if running 15 reporter managers edit the inca.properties file as follows:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>31 # Maximum number of threads running on the agent
32 inca.agent.numthreads=25
...
82 # Maximum number of threads running on the depot
83 inca.depot.numthreads=25</PRE
></FONT
></TD
></TR
></TABLE
></P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="CUSTOM-NOTIFICATION"
>11.2. Customizing Series Notification</A
></H3
><P
>  To customize the notification you receive whenever the result of a series
  comparison changes, you can either modify the default Inca notification
  scripts (found in the sbin/ subdirectory of your Inca Depot installation) or
  write your own.  Set inca.incat.notifiers in your inca.property file to add a
  new script to the options presented in the incat series dialog.  For example,
  to add a script named "MyNotifier" to the options, you would add the
  following line to inca.properties.
  <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>  inca.incat.notifiers=EmailNotifier,LogNotifier,MyNotifier
  </PRE
></FONT
></TD
></TR
></TABLE
>
  </P
><P
>  The Inca Depot sets environment variables that provide information to the
  notification script about the series and comparison, and the script can
  incorporate these variables into its notification.  For example,
  EmailNotifier uses several of these variables in constructing the email body.
  These are the environment variable names that the Depot defines:
  <DIV
CLASS="TABLE"
><A
NAME="AEN2024"
></A
><P
><B
>Table 8. Email Macro Names</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><THEAD
><TR
><TH
><P
>Name</P
></TH
><TH
><P
>Meaning</P
></TH
></TR
></THEAD
><TBODY
><TR
><TD
><P
>incaargs</P
></TD
><TD
><P
>the arguments passed to the reporter</P
></TD
></TR
><TR
><TD
><P
>incabody</P
></TD
><TD
><P
>the report body</P
></TD
></TR
><TR
><TD
><P
>incacollected</P
></TD
><TD
><P
>the time the reporter ran</P
></TD
></TR
><TR
><TD
><P
>incacommited</P
></TD
><TD
><P
>the time the report was entered in the Depot</P
></TD
></TR
><TR
><TD
><P
>incacomparison</P
></TD
><TD
><P
>the comparison specified for this series</P
></TD
></TR
><TR
><TD
><P
>incacomparisonResult</P
></TD
><TD
><P
>the output of the comparison for this report, typically "SUCCESS" or "FAIL" followed by a list of identifiers</P
></TD
></TR
><TR
><TD
><P
>incacompleted</P
></TD
><TD
><P
>whether or not the reporter completed execution</P
></TD
></TR
><TR
><TD
><P
>incaconfigId</P
></TD
><TD
><P
>the Inca database id of the series configuration</P
></TD
></TR
><TR
><TD
><P
>incacontext</P
></TD
><TD
><P
>the complete command, including arguments, used to execute the reporter</P
></TD
></TR
><TR
><TD
><P
>incacpuLimit</P
></TD
><TD
><P
>the maximum CPU seconds allowed for this reporter to execute</P
></TD
></TR
><TR
><TD
><P
>incacpuUsage</P
></TD
><TD
><P
>the actual CPU seconds used by this reporter execution</P
></TD
></TR
><TR
><TD
><P
>incaerrorMessage</P
></TD
><TD
><P
>any failure message recorded by the reporter</P
></TD
></TR
><TR
><TD
><P
>incahostname</P
></TD
><TD
><P
>the name of the host where the reporter executed</P
></TD
></TR
><TR
><TD
><P
>incainstanceId</P
></TD
><TD
><P
>the Inca database id of this reporter execution</P
></TD
></TR
><TR
><TD
><P
>incalog</P
></TD
><TD
><P
>log messages recorded by the reporter</P
></TD
></TR
><TR
><TD
><P
>incamemoryLimit</P
></TD
><TD
><P
>the maximum memory MB allowed for this reporter to execute</P
></TD
></TR
><TR
><TD
><P
>incamemoryUsage</P
></TD
><TD
><P
>the actual memory MB used by this reporter execution</P
></TD
></TR
><TR
><TD
><P
>incanickname</P
></TD
><TD
><P
>the nickname of this series</P
></TD
></TR
><TR
><TD
><P
>incareportId</P
></TD
><TD
><P
>the Inca database id of the report</P
></TD
></TR
><TR
><TD
><P
>incareporter</P
></TD
><TD
><P
>the name of the reporter</P
></TD
></TR
><TR
><TD
><P
>incareporterPath</P
></TD
><TD
><P
>the path to the reporter on the host where it executed</P
></TD
></TR
><TR
><TD
><P
>incaresource</P
></TD
><TD
><P
>the name of the Inca resource where the reporter executed</P
></TD
></TR
><TR
><TD
><P
>incaresult</P
></TD
><TD
><P
>"PASS" or "FAIL", depending on whether or not the reporter completed execution</P
></TD
></TR
><TR
><TD
><P
>incaschedule</P
></TD
><TD
><P
>the cron spec for this series' schedule</P
></TD
></TR
><TR
><TD
><P
>incaseriesId</P
></TD
><TD
><P
>the Inca database id of this series</P
></TD
></TR
><TR
><TD
><P
>incastderr</P
></TD
><TD
><P
>any text written by the reporter to stderr</P
></TD
></TR
><TR
><TD
><P
>incauri</P
></TD
><TD
><P
>the reporter URI</P
></TD
></TR
><TR
><TD
><P
>incaversion</P
></TD
><TD
><P
>the reporter version</P
></TD
></TR
><TR
><TD
><P
>incawallClockLimit</P
></TD
><TD
><P
>the maximum wall clock seconds allowed for this reporter to execute</P
></TD
></TR
><TR
><TD
><P
>incawallClockUsage</P
></TD
><TD
><P
>the actual wall clock seconds used by this reporter execution</P
></TD
></TR
><TR
><TD
><P
>incaworkingDir</P
></TD
><TD
><P
>the working directory for the reporter manager on the host where the reporter executed</P
></TD
></TR
></TBODY
></TABLE
></DIV
>
  </P
><P
>Values that are specified as the "Script Arguments" in incat are
  passed as arguments to the script.</P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="REPORT-FILTERING"
>11.3. Report Filtering</A
></H3
><P
>The Inca Depot allows you to filtering incoming reports before information
about them is placed in the Inca database.  To do so, you need to write a class
that extends edu.sdsc.inca.depot.util.ReportFilter and set the property
inca.depot.reportFilter to the name of the class.</P
><P
>An Inca report consists of five elements, all strings: the execution context
(reporter name and arguments), the name of the resource where the reporter ran,
the reporter stdout (i.e., report), the reporter stderr, and a report of the
system resources used by the reporter execution.  Of these, stderr may be null;
the other four are required.</P
><P
>The ReportFilter class provides set and get methods for each of these five
elements.  If the inca.depot.reportFilter property is set, the Inca Depot
creates an instance of the named class, then calls each of its set and get
methods in turn to allow it to make changes to any of the elements.  Changes
made by the filter are incorporated into the information stored in the Depot
database.  If a ReportFilter get method for any of the elements other than
stderr returns null, the Depot discards the report.</P
><P
>For example, this class directs the Depot to ignore reports that arrive from
blue.ufo.edu and modifies report stderr values that contain particular messages.</P
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>public class MyReportFilter extends edu.sdsc.inca.depot.util.ReportFilter {

  public String getResource() {
    String resource = super.getResource();
    return resource.equals("blue.ufo.edu") ? null : resource;
  }

  public String getStderr() {
    String stderr = super.getStderr();
    stderr = stderr.replaceAll("Try again.*\n", "");
    return stderr;
  }

}</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>To install your filter, first compile the class.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% javac -classpath lib/inca-depot.jar MyReportFilter.java</PRE
></FONT
></TD
></TR
></TABLE
><P
>Copy the compiled class to your <TT
CLASS="FILENAME"
>$INCA_DIST/lib</TT
> 
directory.  For example, </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cp MyReportFilter.class $INCA_DIST/lib</PRE
></FONT
></TD
></TR
></TABLE
><P
>Then add the inca.depot.reportFilter property to your 
<TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> file.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>...
inca.depot.reportFilter=MyReportFilter
...</PRE
></FONT
></TD
></TR
></TABLE
><P
>Finally, restart the depot.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca restart depot</PRE
></FONT
></TD
></TR
></TABLE
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="DOWNTIME-FILTER"
>11.3.1. Downtime Filter</A
></H4
><P
>The depot has a ready to use filter called "DowntimeFilter" that prefixes
the error messages of resources marked as down with "DOWNTIME: +optionalString+:".  
By default the consumer will display results with a error message starting with 
"DOWNTIME:" neutrally - summary pages print the result as "down" instead of "error" and
historical graphs show the result as "unknown".  The consumer has templates in the 
<TT
CLASS="FILENAME"
>inca-common.xsl</TT
> stylesheet called "getLink" and "getDownErr" to 
display errors generated by the downtime filter in the report summary and details pages.</P
><P
>The downtime filter is included in the inca-depot.jar and looks like:</P
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>package edu.sdsc.inca.depot.util;

import org.apache.log4j.Logger;
import java.net.URL;
import java.util.Properties;
import java.io.InputStream;
import java.io.IOException;

/**
 * Prefixes error messages in depot reports with "DOWNTIME: +optionalString+: "
 * if the resource the report ran on is in downtime.   Resources are determined
 * to be in downtime if they are listed in a downtime properties file.  In order
 * to reduce overhead, the downtime properties file is retrieved and cached at
 * a refresh interval in the getDowntimes() method instead of being retrieved
 * for each filter instance.
 */
public class DowntimeFilter extends edu.sdsc.inca.depot.util.ReportFilter {
  private static Logger logger = Logger.getLogger(DowntimeFilter.class);
  private static Properties downtimes = new Properties();
  private static long lastRefresh = 0;

  /**
   * Returns cached property list of resources in downtime.  Gets and caches
   * property list from file in classpath (downtime.properties) if cache has
   * expired according to refreshMins.
   *
   * The property list file contents can be:
   *
   *  downResource1=optionalErrorMessagePrefixStringForResource1
   *  downResource2=optionalErrorMessagePrefixStringForResource2
   *
   * OR
   *
   *  downResource1
   *  downResource2
   *
   */
  synchronized static Properties getDowntimes()  {
    String downtimePropFile = System.getProperty("inca.depot.downtimeFile");
    if(downtimePropFile == null) {
      downtimePropFile  = "downtime.properties";
    }
    String downtimeRefresh = System.getProperty("inca.depot.downtimeRefresh");
    if(downtimeRefresh == null) {
      downtimeRefresh  = "15";
    }
    Integer refreshMins = Integer.parseInt(downtimeRefresh);
    long minSinceLastRefresh = (System.currentTimeMillis()-lastRefresh)/60000;
    if (minSinceLastRefresh &#62;= refreshMins){
      URL url = ClassLoader.getSystemClassLoader().getResource(downtimePropFile);
      if(url == null) {
        logger.error( downtimePropFile + " not found in classpath" );
      }
      logger.debug( "Located file " + url.getFile() );
      downtimes.clear();
      try {
        InputStream is = url.openStream();
        downtimes.load(is);
        is.close();
      } catch (IOException e){
        logger.error( "Can't load properties file" );
      }
      lastRefresh = System.currentTimeMillis();
    }
    return downtimes;
  }

  /**
   * Writes new report with modified error message to depot if resource is down
   *
   * @return  string with depot report (reporter Stdout)
   */
  public String getStdout() {
    String resourceProp  = getDowntimes().getProperty(super.getResource());
    if (resourceProp != null){
      logger.debug( super.getResource() + " is down " + resourceProp );
      return super.getStdout().replaceFirst(
          "&#60;errorMessage&#62;", "&#60;errorMessage&#62;DOWNTIME:"+ resourceProp +": ");
    } else{
      return super.getStdout();
    }
  }

}</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>To use this filter, first 
write a script that prints the names of down resources to a file called "downtime.properties" 
in the classpath of the depot (e.g. $INCA_DIST/etc/downtime.properties).  If you prefer to 
call the file something besides "downtime.properties", set the name of the file in 
your <TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> file:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>...
inca.depot.downtimePropFile=MyDowntimeFilename
...</PRE
></FONT
></TD
></TR
></TABLE
><P
>In order to reduce depot overhead, the properties file is retrieved and 
cached every 15 minutes by default.  The caching frequency can be changed in 
<TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> to a different number of 
minutes:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>...
inca.depot.downtimeRefresh=5
...</PRE
></FONT
></TD
></TR
></TABLE
><P
>The "downtime.properties" file contents can be something like:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>downResource1=optionalErrorMessagePrefixStringForResource1
downResource2=optionalErrorMessagePrefixStringForResource2</PRE
></FONT
></TD
></TR
></TABLE
>
    OR
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>downResource1
downResource2</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>Next add the inca.depot.reportFilter property to your 
<TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> file.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>...
inca.depot.reportFilter=edu.sdsc.inca.depot.util.DowntimeFilter
...</PRE
></FONT
></TD
></TR
></TABLE
><P
>Finally, restart the depot.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca restart depot</PRE
></FONT
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="ALL2ALL-FILTER"
>11.3.2. All2All Filter</A
></H4
><P
>The depot has a ready to use filter called "All2AllFilter" that prefixes
error messages in depot reports with "NOT_AT_FAULT: " if the resource the 
report ran on is not at fault for the "all2all" error and the
report is not already prefixed with "DOWNTIME" (see <A
HREF="#USERGUIDE-INCAT-ALL2ALL"
>Section 5.8.1</A
> 
for more information about configuring "all2all" tests).  Resources are determined to
not be at fault if the summary property that matches their nickname has failed. 
Summary properties are written for any reports with the "summary.successpct.performance" reporter name.</P
><P
>By default, errors that begin with "NOT_AT_FAULT" are displayed neutrally 
(see <A
HREF="#CONSUMER-NEUTRAL-ERRS"
>Section 6.9</A
>). The all2all filter is included in the inca-depot.jar 
and is configured by adding the inca.depot.reportFilter property to your 
<TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> file</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>...
inca.depot.reportFilter=edu.sdsc.inca.depot.util.All2AllFilter
...</PRE
></FONT
></TD
></TR
></TABLE
><P
>and restarting the depot.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca restart depot</PRE
></FONT
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="MULTIPLE-FILTERS"
>11.3.3. Mutiple Filters</A
></H4
><P
>The depot can apply multiple filters to reports.  To specify more than one filter, use a comma 
separated list for the inca.depot.reportFilter property in <TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
>:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>inca.depot.reportFilter=edu.sdsc.inca.depot.util.DowntimeFilter, edu.sdsc.inca.depot.util.All2AllFilter</PRE
></FONT
></TD
></TR
></TABLE
>
Filters are applied in the order they are listed.</P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="DB-CONFIG"
>11.4. Depot Database Configuration</A
></H3
><P
>The Inca depot uses Hibernate to interface to a relational database backend for 
storing reports and incat configuration.  By default, the Inca depot uses Hibernate's HSQL 
database but can be configured to use any Hibernate supported database.  
We have tested the Inca depot with PostgreSQL and Oracle.</P
><P
>Steps for using a depot database other than HSQL are as follows: </P
><P
></P
><OL
TYPE="1"
><LI
><P
>Stop the depot 
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca stop depot</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Edit $INCA_DIST/etc/hibernate.properties</P
><P
></P
><UL
><LI
><P
>Comment out the first 5 lines which specifies for hibernate to use 
hsql as its backend database: 
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>1 #hibernate.dialect=org.hibernate.dialect.HSQLDialect
2 #hibernate.connection.driver_class=org.hsqldb.jdbcDriver
3 #hibernate.connection.url=jdbc:hsqldb:test
4 #hibernate.connection.username=sa
5 #hibernate.connection.password=</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Uncomment the block which specifies for hibernate to use your database (i.e., for PostgreSQL uncomment 8-13, 
for MySQL uncomment 17-21, for Oracle uncomment 24-28). </P
></LI
><LI
><P
>Change the uncommented hibernate.connection.url, hibernate.connection.username and hibernate.connection.password 
property values to be the host/db name, login username and password for your database.  </P
></LI
></UL
></LI
><LI
><P
>Put JDBC drivers for your database in the $INCA_DIST/lib directory.  Driver download locations:
<A
HREF="http://jdbc.postgresql.org/download.html"
TARGET="_top"
>PostgreSQL</A
>, 
<A
HREF="http://www.mysql.com/products/connector/j/"
TARGET="_top"
>MySQL</A
>,
<A
HREF="http://www.oracle.com/technology/software/tech/java/sqlj_jdbc/"
TARGET="_top"
>Oracle</A
></P
></LI
><LI
><P
>Initialize the depot (set up the Inca tables):
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca depot -d</PRE
></FONT
></TD
></TR
></TABLE
>
You should see something like:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>Initializing c3p0 pool... 
... 
Database Initialization Completed</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Start the depot 
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca start depot</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></OL
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="PEER-DEPOTS"
>11.5. Depot Fault Tolerance</A
></H3
><P
>In order to respond to unexpected depot failure, configure
peer depots to mirror each other so that if one fails another can 
take over.  NOTE: the depots must be using a database other than 
the default hibernate database.  There's a bug in hibernate that
prevents synchronization.  To configure the depot database see
<A
HREF="#DB-CONFIG"
>Section 11.4</A
>. </P
><P
>The steps for depots mirroring are as follows: </P
><P
></P
><OL
TYPE="1"
><LI
><P
>Install the software for each peer depot
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% wget http://inca.sdsc.edu/releases/2.6/incaInstall.sh;
% sh incaInstall.sh $INCA_DIST depot;</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Copy the <TT
CLASS="FILENAME"
>$INCA_DIST/etc/depot.*pem</TT
> and <TT
CLASS="FILENAME"
>$INCA_DIST/etc/trusted/*</TT
>
 files from the original 
depot to the peer depot <TT
CLASS="FILENAME"
>$INCA_DIST/etc</TT
> and <TT
CLASS="FILENAME"
>$INCA_DIST/etc/trusted</TT
>
 directories respectively.</P
></LI
><LI
><P
>Edit <TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> on both the original and peer depot and 
uncomment the blocks which specify the hosts for your depots.  For example, if your 
orginal depot is on rocks-101.sdsc.edu:6324 and your peer depot is on 
cuzco.sdsc.edu:6324, your edits would look like:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>...
# URIs of peer depots
inca.depot.peers=incas://rocks-101.sdsc.edu:6324 incas://cuzco.sdsc.edu:6324
...</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>Edit <TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> where the consumer is installed and
uncomment the block which specifies the hosts for your depots.  For example, if your 
orginal depot is on rocks-101.sdsc.edu:6324 and your peer depot is on 
cuzco.sdsc.edu:6324, your edit would look like:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>...
# URI to the depot -- use incas:// if auth is required and inca:// if not
inca.consumer.depot=incas://rocks-101.sdsc.edu:6324 incas://cuzco.sdsc.edu:6324
...</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>Restart the original server components (depot, agent, consumer).  
Start the peer depot and look for "DB synchronization succeeded" in the 
<TT
CLASS="FILENAME"
>$INCA_DIST/var/depot.log</TT
> of the peer depot:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; bin/inca start depot --sync</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></OL
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-ADVANCED-MANUAL"
>11.6. Manual Access Method</A
></H3
><P
>A resource administrator may be unable to start a reporter manager
using one of the automated methods (ssh, globus2, or local).  In this case, an
Inca administrator can add the resource using the access method 'manual'. 
The following steps will need to be taken by the Inca administrator and
resource administrator:</P
><P
>Inca Administrator</P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>Step <A
HREF="#MAN-ADMIN-CERT"
>3</A
>: Generate a certificate for the
reporter manager.</TD
></TR
><TR
><TD
>Step <A
HREF="#MAN-ADMIN-ADD"
>4</A
>: Add resource in incat with access method 'manual'</TD
></TR
></TBODY
></TABLE
><P
></P
><P
>Resource Administrator</P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>Step <A
HREF="#MAN-SYSADMIN-INSTALL"
>1</A
>: Install reporter manager</TD
></TR
><TR
><TD
>Step <A
HREF="#MAN-SYSADMIN-CRED"
>2</A
>: Generate private key and
certificate request</TD
></TR
><TR
><TD
>Step <A
HREF="#MAN-SYSADMIN-CERT"
>5</A
>: Install certificate and
trusted certificate.</TD
></TR
><TR
><TD
>Step <A
HREF="#MAN-SYSADMIN-START"
>6</A
>: Start reporter manager</TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><OL
TYPE="1"
><LI
><A
NAME="MAN-SYSADMIN-INSTALL"
></A
><P
>RESOURCE ADMIN: install the reporter manager distribution on your resource using the following steps.</P
><P
></P
><OL
TYPE="a"
><LI
><P
>Create an installation directory for the reporter manager (e.g.,
$RM_INSTALL_DIR).  Download the reporter manager tarball and build
script:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $RM_INSTALL_DIR; \
  wget http://inca.sdsc.edu/releases/2.6/Inca-ReporterManager.tar.gz; \
  wget http://inca.sdsc.edu/releases/2.6/buildRM.sh</PRE
></FONT
></TD
></TR
></TABLE
><P
> At this point
      the directory on the remote machine should look something like this:
      <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ls         
Inca-ReporterManager.tar.gz    
buildRM.sh                    </PRE
></FONT
></TD
></TR
></TABLE
>
      </P
></LI
><LI
><P
>Install the reporter manager and list directories to verify files unpacked correctly:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% bash buildRM.sh $RM_INSTALL_DIR Inca-ReporterManager.tar.gz

% ls $RM_INSTALL_DIR 
Inca-ReporterManager-9.6764    build.log    lib    share
Inca-ReporterManager.tar       buildRM.sh   man    var
bin                            etc          sbin
      </PRE
></FONT
></TD
></TR
></TABLE
><P
>Install the default set of reporters and their libraries:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $RM_INSTALL_DIR; wget http://inca.sdsc.edu/releases/2.6/Inca-Reporter.tar.gz
% cd var; tar zxvf ../Inca-Reporter.tar.gz; cd Inca-Reporter-*
% perl Makefile.PL PREFIX=${RM_INSTALL_DIR}/var/reporter-packages \
 INSTALLDIRS=perl LIB=${RM_INSTALL_DIR}/var/reporter-packages/lib/perl \
 INSTALLSCRIPT=${RM_INSTALL_DIR}/var/reporter-packages/bin \
 INSTALLMAN1DIR=${RM_INSTALL_DIR}/var/reporter-packages/man/man1 \
 INSTALLMAN3DIR=${RM_INSTALL_DIR}/var/reporter-packages/man/man3
% make
% make install</PRE
></FONT
></TD
></TR
></TABLE
></LI
></OL
></LI
><LI
><A
NAME="MAN-SYSADMIN-CRED"
></A
><P
>RESOURCE ADMIN: create a set of credentials for the reporter manager (i.e., private
    key and certificate request) using the command below.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $RM_INSTALL_DIR; ./sbin/inca createRmCertRequest -P stdin:password: 
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>Enter a password for your key (to use when you start up
    the reporter manager).  Two files will be created in 
    <TT
CLASS="FILENAME"
>$RM_INSTALL_DIR/etc</TT
>:  
    an encrypted private key called <TT
CLASS="FILENAME"
>rmkey.pem</TT
> and 
    a certificate request called <TT
CLASS="FILENAME"
>rmreq.pem</TT
>.  
    Email <TT
CLASS="FILENAME"
>rmreq.pem</TT
> to your Inca administrator and they
    will generate a certificate for your reporter manager.
    </P
></LI
><LI
><A
NAME="MAN-ADMIN-CERT"
></A
><P
>INCA ADMIN: upon receiving a rmreq.pem file,
    generate a certificate for a reporter manager using the 
    command below.  Replace "rmreq.pem" with to the path to the rmreq.pem
    file that you received from the resource administrator and
    "rmcert-resource.pem" with the path to the reporter manager certificate
    that will be generated by the command.
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca createRmCert -P stdin:password: <STRONG
><FONT
COLOR="RED"
>rmreq.pem</FONT
></STRONG
> <STRONG
><FONT
COLOR="RED"
>rmcert-resource.pem</FONT
></STRONG
>
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>Enter the password for the inca distribution (i.e., created in
    Step <A
HREF="#QS-STEP4"
>4</A
> during the initial installation process).  
    Email the reporter manager certificate, "rmcert-resource.pem",
    and trusted certificate to the resource administrator.  The trusted
    certificate is the file ending with the <TT
CLASS="FILENAME"
>.0</TT
> extension
    in your <TT
CLASS="FILENAME"
>$INCA_DIST/etc/trusted</TT
> directory.  For
    example <TT
CLASS="FILENAME"
>f73fee74.0</TT
> is the trusted certificate in the
    following directory:
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ls etc/trusted/
agentcert.pem  f73fee74.0  rocks-101.sdsc.educert.pem
    </PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><A
NAME="MAN-ADMIN-ADD"
></A
><P
>INCA ADMIN: add the specified resource within incat
    and choose 'manual' as below:
    </P
><DIV
CLASS="FIGURE"
><A
NAME="MANUAL.FIG"
></A
><P
><B
>Figure 20. Add Resource Screen</B
></P
><P
><IMG
SRC="figures/incat/manual.jpg"
ALIGN="CENTER"></P
></DIV
><P
> Make sure the 
    "Equivalent" box is checked, otherwise the depot may discard reports with 
    "unattached to any DB config" warnings.  The new "manualResource" will
    also need to be added to the "defaultGrid" resource in order to run the
    default sampleSuite.  Select "Agent-&#62;Commit" from the menu to
    commit the changes.  
    </P
></LI
><LI
><A
NAME="MAN-SYSADMIN-CERT"
></A
><P
>RESOURCE ADMIN: install the certificate and trusted certificate from the 
    Inca admin in your reporter manager installation.  Replace
    "rmcert-resource.pem" and "trusted.0" with the names of the files
    received from your Inca administrator.
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $RM_INSTALL_DIR
% cp <STRONG
><FONT
COLOR="RED"
>rmcert-resource.pem</FONT
></STRONG
> $RM_INSTALL_DIR/etc/rmcert.pem
% mkdir $RM_INSTALL_DIR/etc/trusted
% cp <STRONG
><FONT
COLOR="RED"
>trusted.0</FONT
></STRONG
> $RM_INSTALL_DIR/etc/trusted
    </PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><A
NAME="MAN-SYSADMIN-START"
></A
><P
>RESOURCE ADMIN: 
    Finally, you can start up the reporter manager using the commands
below.  Replace "depotHost" with the hostname where the depot is running and
replace "manualResource" with the manual resource group name added in step
<A
HREF="#MAN-ADMIN-ADD"
>4</A
>: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $RM_INSTALL_DIR
% ./sbin/inca reporter-manager \
 -a incas://<STRONG
><FONT
COLOR="RED"
>agentHost</FONT
></STRONG
>:6323 \
 -d incas://<STRONG
><FONT
COLOR="RED"
>depotHost</FONT
></STRONG
>:6324 \
 -c etc/rmcert.pem \
 -k etc/rmkey.pem -t etc/trusted \
 -e bin/inca-null-reporter \
 -r var/reporter-packages \
 -R sbin/reporter-instance-manager \
 -v var \
 -w 1 \
 -i <STRONG
><FONT
COLOR="RED"
>manualResource</FONT
></STRONG
> \
 -s suite.xml \
 -L DEBUG \
 -l var/reporter-manager.log \
 -P true
<STRONG
><FONT
COLOR="RED"
>&#60;enter your password&#62;</FONT
></STRONG
></PRE
></FONT
></TD
></TR
></TABLE
><P
>Command will hang until the password for the reporter manager key is entered.  
If the private key is not password protected, don't use the -P option in the command above.
Check to make sure the reporter manager is running by doing a "ps | grep reporter-manager" and 
make sure there aren't errors by doing a "grep ERROR $RM_INSTALL_DIR/var/*".</P
><P
>To stop the reporter manager at any time, type </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./sbin/inca stop reporter-manager</PRE
></FONT
></TD
></TR
></TABLE
><P
>Make sure all reporter-manager ps are stopped</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
> % ps | grep manager </PRE
></FONT
></TD
></TR
></TABLE
></LI
></OL
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-ADVANCED-BATCH"
>11.7. Batch Systems</A
></H3
><P
>  The cluster.batch.wrapper reporter can be useful when running Inca on batch
  systems.  Without an --exec argument, this reporter submits a trivial program
  to the batch scheduler and reporters the amount of time it spends in the queue
  before executing.  If given an --exec argument, cluster.batch.wrapper instead
  submits the argument value (which should contain a reporter invocation) and
  collects and reports it output.  This use allows reporters to be executed on
  batch nodes, rather than on the submission host.  For example, this command
  will report the version of gcc that is installed on the batch nodes of a PBS
  cluster.
  </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cluster.batch.wrapper --scheduler=pbs --exec=cluster.compiler.gcc.version
  </PRE
></FONT
></TD
></TR
></TABLE
><P
>  The --scheduler argument is the only one required; valid values are cobalt,
  dqs, loadleveler, lsf, pbs, and sge.  Additional recognized arguments are as
  follows.
  </P
><DIV
CLASS="TABLE"
><A
NAME="AEN2382"
></A
><P
><B
>Table 9. cluster.batch.wrapper options</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><THEAD
><TR
><TH
><P
>Name</P
></TH
><TH
><P
>Meaning</P
></TH
><TH
><P
>Default value</P
></TH
></TR
></THEAD
><TBODY
><TR
><TD
><P
>account</P
></TD
><TD
><P
>User account to charge</P
></TD
><TD
><P
>none</P
></TD
></TR
><TR
><TD
><P
>nodes</P
></TD
><TD
><P
>Number of batch nodes to request</P
></TD
><TD
><P
>1</P
></TD
></TR
><TR
><TD
><P
>poll</P
></TD
><TD
><P
>How often (in seconds) to check for job completion</P
></TD
><TD
><P
>10</P
></TD
></TR
><TR
><TD
><P
>queue</P
></TD
><TD
><P
>The name of the queue to submit to</P
></TD
><TD
><P
>none</P
></TD
></TR
><TR
><TD
><P
>shell</P
></TD
><TD
><P
>The shell to use to run the batch job</P
></TD
><TD
><P
>/bin/sh</P
></TD
></TR
><TR
><TD
><P
>submitparam</P
></TD
><TD
><P
>Additional batch-scheduler-specific parameters to use in the submission</P
></TD
><TD
><P
>none</P
></TD
></TR
><TR
><TD
><P
>timeout</P
></TD
><TD
><P
>The maximum time (in minutes) the job may wait in the batch queue</P
></TD
><TD
><P
>0 (unlimited)</P
></TD
></TR
><TR
><TD
><P
>type</P
></TD
><TD
><P
>Submission type, used with LoadLeveler (job_type parameter), PBS (-l nodes parameter) and SGE (-pe parameter)</P
></TD
><TD
><P
>none</P
></TD
></TR
><TR
><TD
><P
>var</P
></TD
><TD
><P
>Path to a temp file directory</P
></TD
><TD
><P
>Current working directory</P
></TD
></TR
><TR
><TD
><P
>walllimit</P
></TD
><TD
><P
>The amount of time (in minutes) to request for the job </P
></TD
><TD
><P
>10</P
></TD
></TR
></TBODY
></TABLE
></DIV
><P
>  Here are some additional examples of using cluster.batch.wrapper to submit
  Inca reporters to a batch queue.
  </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cluster.batch.wrapper --scheduler=pbs --account=alf63 \
  --exec=cluster.compiler.gcc.version

% cluster.batch.wrapper --scheduler=loadleveler --queue=normal --type=parallel \
  --exec='network.ping.unit --host=ufo.edu'

% cluster.batch.wrapper --scheduler=sge --submitparam='-js 1' \
  --submitparam='-l h_vmem=600' \
  --exec='cluster.ps.unit --process=init --psargs=-x'
  </PRE
></FONT
></TD
></TR
></TABLE
><P
>  In incat, you can specify that cluster.batch.wrapper should be used to submit
  a series by including its name and arguments in the series context string.
  Inca stores installed reporters in the directory $INSTALL_DIR/bin, so the
  path to cluster.batch.wrapper will be $INSTALL_DIR/bin/cluster.batch.wrapper.
  The figure below shows the context string for the network.ping.unit series
  mentioned above.
  </P
><P
><IMG
SRC="figures/incat/ug-incat-batch.png"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-ADVANCED-RUNNOW"
>11.8. Manual Run Now</A
></H3
><P
>Oftentimes resource or system administrators will want to show that a
problem has been resolved by independently executing inca tests before they are
scheduled to run so that their results appear on status pages.  Rather than
granting resource administrators full privileges just to use incat's "run now"
button, the inca administrator can provide resource administrators with a
"manual run now" option - a command line script to execute tests and send
results to the depot.  A "run now" can also be invoked via the Inca web pages 
if configured (by default "run now" is not enabled).  See <A
HREF="#CONSUMER-REPORT-DETAILS"
>Section 6.5</A
> for more information. </P
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="USERGUIDE-ADVANCED-RUNNOW-CONFIG"
>11.8.1. Configuring the Manual Run Now Script</A
></H4
><P
>The instructions below need to be done *once* by the Inca administrator on each 
resource where the resource administrator would like to manually run tests.</P
><P
></P
><OL
TYPE="1"
><LI
><P
>To allow system administrators or others to execute tests with their own password, 
copy the reporter manager key and cert for them and change the password. The 
old password is the same as the password used in the createauth step of installing inca.
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST/etc; cp rmkey.pem adminkey.pem
% cp rmcert.pem admincert.pem
% chmod 600 adminkey.pem
% ssh-keygen -p

Enter file in which the key is (/home/.ssh/id_rsa):
  /home/incaReporterManager/etc/adminkey.pem
Enter old passphrase: 
Key has comment '/home/incaReporterManager/etc/adminkey.pem'
Enter new passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved with the new passphrase.</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Create a custom wrapper script for <TT
CLASS="FILENAME"
>$INCA_DIST/bin/inca-run-now</TT
> 
called <TT
CLASS="FILENAME"
>$INCA_DIST/bin/admin-run-now</TT
> using the script below as an example. 
Use the agent and depot URIs for your installation as AGENT and DEPOT and the agent's name for the resource as RESOURCE.  
You may need to add the "-u" parameter for the appropriate user if the reporter manager is not running as inca. 
Run the script with the "-h" flag for more information about its input parameters:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% setenv PERL5LIB lib/perl:$PERL5LIB; bin/inca-run-now -h</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>Example wrapper script:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>#!/bin/sh

AGENT=incas://localhost:6323
DEPOT=incas://localhost:6324
RESOURCE=localResource

if ( test -z "${PERL5LIB}" ); then
PERL5LIB=lib/perl
else
PERL5LIB=lib/perl:${PERL5LIB}
fi
export PERL5LIB

./bin/inca-run-now -a $AGENT -c etc/admincert.pem -d $DEPOT \
  -k etc/adminkey.pem -P "stdin:password:" \
  -t etc/trusted -i $RESOURCE $* </PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
> 
<STRONG
><FONT
COLOR="RED"
>(optional)</FONT
></STRONG
>The command to use the <TT
CLASS="FILENAME"
>admin-run-now</TT
> script could be 
added to the reporter details status pages.  This would require editing the <TT
CLASS="FILENAME"
>$INCA_DIST/etc/instance.xsl</TT
> 
file on the machine where the consumer is running and adding the xsl required to print a command like:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
> % cd /home/inca/inca2install; ./bin/admin-run-now ant-unit </PRE
></FONT
></TD
></TR
></TABLE
>
The xsl would be similar to:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>&#60;tr&#62;
  &#60;td colspan="2" class="header"&#62;
    &#60;xsl:text&#62;Run now command (system admins only):&#60;/xsl:text&#62;
  &#60;/td&#62;
&#60;/tr&#62;
&#60;tr&#62;
  &#60;td colspan="2"&#62;
    &#60;xsl:variable name="repPath" select="$report/reporterPath"/&#62;
    &#60;xsl:variable name="incaloc" select=
      "replace($report/reporterPath, '/var/reporter-packages/bin/.*', '')" /&#62;
    &#60;p class="code"&#62; &#60;xsl:text&#62;% cd &#60;/xsl:text&#62;
    &#60;xsl:value-of select="$incaloc"/&#62;
    &#60;xsl:text&#62;; ./bin/admin-run-now &#60;/xsl:text&#62;
    &#60;xsl:value-of select="$nickName"/&#62;&#60;/p&#62;
  &#60;/td&#62;
&#60;/tr&#62;</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></OL
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="USERGUIDE-ADVANCED-RUNNOW-USING"
>11.8.2. Using the Manual Run Now Script</A
></H4
><P
></P
><OL
TYPE="1"
><LI
><P
> 
Log into the inca account on the desired resource and change to the $INCA_DIST directory.
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
> 
Execute <TT
CLASS="FILENAME"
>admin-run-now</TT
> script using the series nickname as the 
input parameter and the password from your inca administrator: 
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/admin-run-now ant_version
password:*********
Started Inca reporter-manager</PRE
></FONT
></TD
></TR
></TABLE
>
You can also print the XML result that gets sent to the Inca server 
in <TT
CLASS="FILENAME"
>$INCA_DIST/var/run-now.log</TT
> 
by using the "-L DEBUG" flag:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/admin-run-now -L DEBUG ant_version
password:*********
Started Inca reporter-manager</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
> 
Check for errors in <TT
CLASS="FILENAME"
>$INCA_DIST/var/run-now.log</TT
>.
Wait about 10-15 minutes to view the result on your inca status page (data is 
cached and takes a few minutes to update).</P
></LI
><LI
><P
> 
<STRONG
><FONT
COLOR="RED"
>(optional)</FONT
></STRONG
>Execute multiple tests: in order 
to specify that more than one test be executed, 
use a Perl regex expression instead of the test name like:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/admin-run-now &#60;perl regex&#62;</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>For example, to execute all ant tests
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/admin-run-now "ant.*"</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>In order to check your regular expression, you can use the "-l" flag. 
This option will list the tests but will NOT execute them. 
For example, to display all ant tests that would be executed:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/admin-run-now -l "ant.*"
Suite:  sampleSuite (2 series)
ant_helloworld_compile_test
ant_version</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>To view all tests, use the regular expression ".*" as below:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/admin-run-now -l ".*"</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>You will notice that test names are listed under a "Suite: &#60;name&#62;" header. 
You can also use that suite name to execute all of the tests included in it. 
For example, the following shows the tests available in the sampleSuite kit:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>Suite:  sampleSuite (10 series)
ant_helloworld_compile_test
ant_version
gcc_hello_world
gcc_version
java_hello_world
java_version
openssh_version
openssl_version
vtk-nvgl_version
wget_page_test</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>To execute all test in a kit using the suite name, type:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/admin-run-now sampleSuite</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></OL
><P
>Run the script with the "-h" flag for help information:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/admin-run-now -h</PRE
></FONT
></TD
></TR
></TABLE
></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-ADVANCED-SRCDIST"
>11.9. Source Distributions</A
></H3
><P
>  Source distributions of the Inca components are also available.  The 
  following table lists the Inca component source distributions and shows how
  to build each of them.  Note, that <A
HREF="http://ant.apache.org"
TARGET="_top"
>Apache
  Ant</A
> is needed for the Inca components implemented in Java.  </P
><DIV
CLASS="TABLE"
><A
NAME="AEN2528"
></A
><P
><B
>Table 10. Inca component source distributions</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><THEAD
><TR
><TH
><P
>Component</P
></TH
><TH
><P
>Build</P
></TH
></TR
></THEAD
><TBODY
><TR
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/inca-agent-src.tar.gz"
TARGET="_top"
>agent</A
></P
></TD
><TD
><P
>ant -Dinstalldir=$INCA_DIST install</P
></TD
></TR
><TR
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/inca-common-java-src.tar.gz"
TARGET="_top"
>common</A
> (used by all Inca Java components)</P
></TD
><TD
><P
>ant -Dinstalldir=$INCA_DIST install</P
></TD
></TR
><TR
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/inca-consumers-src.tar.gz"
TARGET="_top"
>consumer</A
></P
></TD
><TD
><P
>ant -Dinstalldir=$INCA_DIST install</P
></TD
></TR
><TR
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/inca-depot-src.tar.gz"
TARGET="_top"
>depot</A
></P
></TD
><TD
><P
>ant -Dinstalldir=$INCA_DIST install</P
></TD
></TR
><TR
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/incat-src.tar.gz"
TARGET="_top"
>incat</A
></P
></TD
><TD
><P
>ant -Dinstalldir=$INCA_DIST install</P
></TD
></TR
><TR
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/Inca-Reporter.tar.gz"
TARGET="_top"
>reporters</A
></P
></TD
><TD
><P
>make &#60;options&#62;</P
></TD
></TR
><TR
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/Inca-ReporterManager.tar.gz"
TARGET="_top"
>reporter manager</A
></P
></TD
><TD
><P
>perl Makefile.PL &#60;options&#62;</P
></TD
></TR
><TR
><TD
><P
><A
HREF="http://inca.sdsc.edu/releases/2.6/Inca-WS.tar.gz"
TARGET="_top"
>web services</A
></P
></TD
><TD
><P
>perl Makefile.PL &#60;options&#62;</P
></TD
></TR
></TBODY
></TABLE
></DIV
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-MAN"
>12. Component Man Pages</A
></H2
><P
>Each of the inca components has options that can be set in either the inca.properties file or on the command line as described in <A
HREF="#COMP-OPTIONS"
>Section 11.1</A
>.  To see a list components use the bin/inca help command:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST
% bin/inca help
Usage:  inca &#60;subcommand&#62; [options] [args]

Type 'inca help &#60;component&#62;' for help on a specific component

Available subcommands:
  createauth
  default
  init
  help
  restart
  start
  stop
  version
  agent
  depot
  incat
  incaws 
  reporter-manager 
  consumer</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>For example, here are the options for the depot, agent, reporter-manager, consumer and incat components:</P
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="MAN-DEPOT"
>12.1. Depot</A
></H3
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% bin/inca help depot
java edu.sdsc.inca.Depot
  P|password   str     Specify how to obtain encryption password
  V|version    null    Display program version
  a|auth       boolean Authenticated (secure) connection?
  c|cert       path    Path to the authentication certificate
  d|dbinit     null    init depot DB tables
  h|help       null    Print help/usage
  h|hostname   str     Hostname the server should provide to clients
  i|init       path    Path to properties file
  k|key        path    Path to the authentication key
  l|logfile    str     Route log messages to a file
  n|numthreads int     # threads in worker pool
  p|port       int     Server listening port
  r|remove     null    remove depot DB tables
  t|trusted    path    Path to authentication trusted certificate dir
  v|var        path    Absolute path to server temp dir</PRE
></FONT
></TD
></TR
></TABLE
></P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="MAN-AGENT"
>12.2. Agent</A
></H3
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% bin/inca help agent
java edu.sdsc.inca.Agent
  C|check            str     check the reporter manager on resources
  D|depot            str     Depot specification; host:port
  H|hostname         str     Hostname where the server is running
  P|password         str     Specify how to obtain encryption password
  R|refreshPkgs      int     repository check period for package updates
  S|server           str     Server specification; host:port
  S|startAttempt     int     re-start attempt period fpr the manager
  U|upgradeTargets   str     makefile targets to execute during upgrade
  V|version          null    Display program version
  a|auth             boolean Authenticated (secure) connection?
  b|buildscript      str     path to reporter manager build script
  c|cert             path    Path to the authentication certificate
  e|email            str     email to send notices of manager restarts
  h|help             null    Print help/usage
  i|init             path    Path to properties file
  k|key              path    Path to the authentication key
  l|logfile          str     Route log messages to a file
  n|numthreads       int     # threads in worker pool
  p|port             int     Server listening port
  r|rmdist           str     path to reporter manager tarball distribution
  s|stayAlive        int     stay alive ping period for the manager
  t|trusted          path    Path to authentication trusted certificate dir
  u|upgradeResources str     upgrade managers in specified resource group
  v|var              path    Absolute path to server temp dir</PRE
></FONT
></TD
></TR
></TABLE
></P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="MAN-RM"
>12.3. Reporter Manager</A
></H3
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% sbin/inca help reporter-manager
Usage:
    reporter-manager [-a|-s] [options]

Options:
    a|--agent
         A string containing the URI to the Reporter Agent process that will
         be responsible for the reporter manager. Either this option or -s
         must be specified. Currently accepted URIs include:

         incas://host:port inca://host:port

    -c|--cert
         A path to a valid certificate file [default: none]

    -d|--depot
         A string containing the URI of a depot to send its reporter data
         to. Currently accepted URIs include:

         incas://host:port inca://host:port file://path

         This option can be specified more than once. The report will be
         sent to the first specified depot. If the first depot is
         unreacheable, the next depots in the list will be tried.

    -e|--error-reporter
         A string containing a path to the error reporter. E.g.,
         inca-null-reporter

    -h|--help
         Print help/usage information

    -i|-id
         The resource identifier supplied by the reporter agent that the
         reporter manager will use to identify itself back to the reporter
         agent.

    -k|--key
         A path to a valid key file [default: none]

    -l|--logfile
         A string containing a path to the file where the log messages can
         be stored. If not specified, log messages will be printed to the
         console.

    -L|--level
         A string containing the log message level (i.e., print statements
         of this level and higher). [default: INFO]

    -P|--passphrase
         Read a passphrase for key from stdin

    -r|--reporter-cache
         A string containing the path to the local cache of reporters.

    -R|--rim
         A string containing a path to the reporter-instance-manager script.
         If not specified, this script will look into the directory where
         itself is located.

    -s|--suite
         A string containing a path to the Inca suite file containing the
         reporters to be executed.

    -t|--trusted
         A path to either a directory or file of trusted certificates
         [default: none]

    -v|--var
         A string containing a path to a temporary file space that Inca can
         use while executing reporters

    -w|--wait
         A positive integer indicating the period in seconds of which to
         check the reporter for a timeout [default: 2]</PRE
></FONT
></TD
></TR
></TABLE
> </P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="MAN-CONSUMER"
>12.4. Consumer</A
></H3
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% bin/inca help consumer
java edu.sdsc.inca.Consumer
  P|password str     Specify how to obtain encryption password
  V|version  null    Display program version
  a|agent    str     URI to the Inca agent
  a|auth     boolean Authenticated (secure) connection?
  c|cert     path    Path to the authentication certificate
  d|depot    str     URI to the Inca depot
  h|help     null    Print help/usage
  i|init     path    Path to properties file
  k|key      path    Path to the authentication key
  l|logfile  str     Route log messages to a file
  m|maxWait  int     Max wait time a JSP tag should wait on a cached item
  r|reload   int     Reload period for cached objects (e.g., suites)
  t|trusted  path    Path to authentication trusted certificate dir
  v|var      path    Path to temporary directory</PRE
></FONT
></TD
></TR
></TABLE
> </P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="MAN-INCAT"
>12.5. Incat</A
></H3
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% bin/inca help incat
java incat
  A|agent    str     Agent specification; host:port
  P|password str     Specify how to obtain encryption password
  V|version  null    Display program version
  a|auth     boolean Authenticated (secure) connection?
  c|cert     path    Path to the authentication certificate
  f|file     path    Inca installation configuration file path
  h|help     null    Print help/usage
  i|init     path    Path to properties file
  k|key      path    Path to the authentication key
  l|logfile  str     Route log messages to a file
  t|trusted  path    Path to authentication trusted certificate dir</PRE
></FONT
></TD
></TR
></TABLE
> </P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="MAN-INCAWS"
>12.6. Inca Web Services</A
></H3
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca help incaws
incaws [opts] depot agent
  --auth=yes/no
  --cert=path
  --help=yes/no
  --init=path
  --key=path
  --logfile=path
  --password=str
  --port=int
  --trusted=path
  --version=yes/no</PRE
></FONT
></TD
></TR
></TABLE
> </P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-TROUBLESHOOTING"
>13. Troubleshooting</A
></H2
><P
>This section describes some useful tips for troubleshooting problems
with an Inca deployment.</P
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-LOGGING"
>13.1. Log Files</A
></H3
><P
>The agent, depot and consumer logs are located in the $INCA_DIST/var directory.  Reporter manager logs are located in each manager's install directory under the var directory (e.g. ~/incaReporterManager/var). </P
><P
>Logging is informational by default, but can be adjusted to be more verbose ('info' to 'debug') or less verbose ('info' to 'error') by editing the $INCA_DIST/etc/common/log4j.properties file and then restarting inca components.  Note that passwords are logged when 'debug' logging is turned on.  Logging for the inca components can be adjusted by editing lines 26 and 27 ("log4j.rootLogger=info, stdout" and "log4j.logger.edu.sdsc.inca=info").  To log the most verbose globus error messages change line 33 in log4j.properties from "log4j.logger.org.globus=error" to "log4j.logger.org.globus=debug". </P
><P
>If a reporter manager is not started on a resource after you have
scheduled reporters to run there, it is likely the build on that resource
failed.  You can confirm by looking for "Unable to stage reporter manager to "
in $INCA_DIST/var/agent.log.  If found, look for errors on the resource in the
2 build log files from the reporter manager build attempt:
~/incaReporterManager/build.log and
~/incaReporterManager/Inca-ReporterManager-*/build.log.  The most common
build failure is a bad build of the dependency Net::SSLeay which is
required for secure communication; the build for Net::SSLeay will fail if it
is unable to find OpenSSL on the resource.  The Perl SSL modules 
call the same functions as "openssl verify". </P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-AUTHPROB"
>13.2. Authentication Problems</A
></H3
><P
>If you observe that a reporter manager on a resource is having trouble
connecting to either the agent or depot, there could be a problem with either
the installed SSL libraries or certificates.  To test, use the
<TT
CLASS="FILENAME"
>pingClient</TT
> command as in the example below. 
Replace $RM_INSTALL_DIR with the path to the
directory where the reporter manager is installed. Supply the appropriate
hostname and port for either the depot or agent.  After pressing return, type
the password for the certificates.  </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd <STRONG
><FONT
COLOR="RED"
>$RM_INSTALL_DIR</FONT
></STRONG
>
% sbin/inca pingClient \
  -c etc/rmcert.pem \
  -k etc/rmkey.pem -P true -t etc/trusted \
  -uri incas://<STRONG
><FONT
COLOR="RED"
>&#60;agent or depot hostname&#62;</FONT
></STRONG
>:<STRONG
><FONT
COLOR="RED"
>&#60;port&#62;</FONT
></STRONG
>
<STRONG
><FONT
COLOR="RED"
>&#60;your password&#62;</FONT
></STRONG
></PRE
></FONT
></TD
></TR
></TABLE
><P
> If there are no problems contacting either the agent or depot, the exit
code will be 0 and nothing will be printed to the screen.  If there is an
authentication problem, the exit code will be non-zero and a message such as
the following will be printed to stderr:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>ERROR - Unable to create Inca::IO socket: : IO::Socket::INET configuration failed
Error contacting Inca server 'incas://rocks-101:6325' at bin/inca-ping-client line 137, &#60;STDIN&#62; line 1.</PRE
></FONT
></TD
></TR
></TABLE
><P
>One possible cause of connection problems may occur when the agent does a local lookup of 'localhost' for its hostname but Java doesn't find the fully qualified hostname.  An example is when the logged agent hostname is something like 'agent-machine:6323' but should be 'agent-machine.sdsc.edu:6323'.  You can override this by adding the fully qualified hostname to your $INCA_DIST/etc/common/inca.properties file on the agent (add 'inca.agent.hostname=agent-machine.sdsc.edu' to inca.properties in this case).  Change other properties with 'localhost' values to your fully qualified hostname, e.g.:

<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>inca.agent.depot=incas://depot-machine.sdsc.edu:6324
...
details at http://consumer-machine.sdsc.edu:8080/inca/xslt.jsp?xsl=instance.xsl&#38;instanceID=@instanceId@&#38;configID=@configId@&#38;resourceName=@resource@\n\n
...
inca.consumer.agent=incas://agent-machine.sdsc.edu:6323
...
inca.consumer.depot=incas://depot-machine.sdsc.edu:6324</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>After you do this, you may need to remove the reporter manager directories on your Grid machines and re-initialize the configuration with the "bin/inca default" command so that new suite names are created with the correct hostname.  If you've already invested a lot in your configuration and don't want to re-initialize, email inca@sdsc.edu for help. </P
><P
>Please email inca@sdsc.edu if you are unable to determine the cause of 
the authentication problem.</P
></DIV
></DIV
></DIV
></BODY
></HTML
>