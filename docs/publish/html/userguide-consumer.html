<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Data Display (Data Consumers)</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="HOME"
TITLE="Inca 2.2 User's Guide"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Administering Inca with incat"
HREF="userguide-incat.html"><LINK
REL="NEXT"
TITLE="Reporters and Repositories"
HREF="userguide-reporters.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="inca.css"></HEAD
><BODY
CLASS="SECTION"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Inca 2.2 User's Guide: [<A
HREF="userguide-one.html"
TARGET="_top"
>Single page</A
>, <A
HREF="userguide-index.html"
TARGET="_top"
>Multiple pages</A
>]</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="userguide-incat.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="userguide-reporters.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECTION"
><H1
CLASS="SECTION"
><A
NAME="USERGUIDE-CONSUMER"
>6. Data Display (Data Consumers)</A
></H1
><P
>The data that the Inca depot stores, as with all database data, can be
    displayed in many ways.  An Inca data consumer is anything that retrieves data
    from the depot and displays it (e.g. a JSP, SQL query, CGI, etc.).</P
><P
><IMG
SRC="figures/arch-consumer.jpg"
ALIGN="CENTER"></P
><P
>Data consumers can query the Inca depot to produce current and historical
    reports and graphs or customized status information.  The Inca depot has Perl
    and Java client APIs for its pre-defined queries (see <A
HREF="userguide-apis.html"
>Section 8</A
>). </P
><DIV
CLASS="SECTION"
><H2
CLASS="SECTION"
><A
NAME="DEFAULT-CONSUMER"
>6.1. Default Data Consumer</A
></H2
><P
>The default data consumer is a <A
HREF="http://en.wikipedia.org/wiki/Sun_WAR_%28file_format%29"
TARGET="_top"
>Web ARchive (WAR)
      file</A
> that contains a collection of <A
HREF="http://java.sun.com/products/jsp/"
TARGET="_top"
>JavaServer Pages (JSP)</A
> and
      their associated files.  The WAR file is initially installed as
      <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/war/inca.war</TT
> and is deployed with <A
HREF="http://www.mortbay.org/"
TARGET="_top"
>Jetty</A
> when the consumer is started (e.g.
      ./bin/inca start consumer).  The default consumer creates a Jetty directory
      like <TT
CLASS="FILENAME"
>$INCA_DIST/var/jetty*/webapp</TT
> for each WAR file in
      <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/war</TT
> - custom WAR files can be dropped into
      the <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/war</TT
> directory and deployed by
      restarting the consumer.  Currently Inca WAR files cannot be deployed outside
      of the Inca consumer server (e.g. in Apache Tomcat).  The consumer will start
      on port 8080 unless the <TT
CLASS="FILENAME"
>$INCA_DIST/etc/jetty.xml</TT
> is edited
      as described in <A
HREF="userguide-consumer.html#CONSUMER-PORT"
>Section 6.4</A
>.</P
><P
>      There are four main JSP contained in the
      <TT
CLASS="FILENAME"
>inca.war</TT
>.
      The JSP generally return XML from depot and agent functions and
      apply XSL stylesheets to display HTML.  If the "xsl" parameter
      for the JSP is removed, the JSP prints the XML returned.
    </P
><DIV
CLASS="TABLE"
><A
NAME="AEN458"
></A
><P
><B
>Table 2. Default Consumer JSP</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><COL><THEAD
><TR
VALIGN="TOP"
><TH
><P
>Name</P
></TH
><TH
><P
>Purpose</P
></TH
><TH
><P
>Server Functions Called</P
></TH
><TH
><P
>Parameters</P
></TH
></TR
></THEAD
><TBODY
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>index.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/index_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Lists an installation's configured suites and resource
                names in an HTML form whose action is to display results
                for the selected suite and resource.  The consumer
                initially redirects to this page.
              </P
></TD
><TD
><P
>Depot's
                <A
HREF="http://inca.sdsc.edu/releases/2.2/javawsdocs/edu/sdsc/inca/DepotClient.html#queryGuids()"
TARGET="_top"
>queryGuids()</A
>
                function for current suite configuration
                and agent's <A
HREF="http://inca.sdsc.edu/releases/2.1/javawsdocs/edu/sdsc/inca/AgentClient.html#getConfig()"
TARGET="_top"
>getConfig()</A
>
                function for cached resource configuration information.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>xsl: stylesheet to format returned XML</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/index.jsp"
TARGET="_top"
>http://localhost:8080/inca/index.jsp</A
></P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>config.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/config_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Prints description of deployed suites and series.
                Linked at the bottom of <TT
CLASS="FILENAME"
>index.jsp</TT
>
              </P
></TD
><TD
><P
>Agent's <A
HREF="http://inca.sdsc.edu/releases/2.2/javawsdocs/edu/sdsc/inca/AgentClient.html#getCatalogAsXml()"
TARGET="_top"
>getCatalogAsXml()</A
>
                function for current catalog configuration and
                <A
HREF="http://inca.sdsc.edu/releases/2.1/javawsdocs/edu/sdsc/inca/AgentClient.html#getConfig()"
TARGET="_top"
>getConfig()</A
>
                function for cached suite configuration infomation.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>xsl: stylesheet to format returned XML</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/config.jsp?xsl=config.xsl"
TARGET="_top"
>http://localhost:8080/inca/config.jsp?xsl=config.xsl</A
></P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>xslt.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/sum_page2_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Displays current results for a set of suites or reporter details.
                This page is the action of the <TT
CLASS="FILENAME"
>index.jsp</TT
> form to display a single suite's results.
              </P
></TD
><TD
><P
>Agent's <A
HREF="http://inca.sdsc.edu/releases/2.2/javawsdocs/edu/sdsc/inca/AgentClient.html#getCatalogAsXml()"
TARGET="_top"
>getCatalogAsXml()</A
>
                function for current catalog configuration and
                <A
HREF="http://inca.sdsc.edu/releases/2.1/javawsdocs/edu/sdsc/inca/AgentClient.html#getConfig()"
TARGET="_top"
>getConfig()</A
>
                function for cached suite configuration infomation.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>suiteName: comma separated list of test suite
                    names to get data for</P
></LI
><LI
><P
>resourceID: comma separated list of resource group
                    names to get data for</P
></LI
><LI
><P
>instanceID: test instance ID number to get data for</P
></LI
><LI
><P
>configID: test configuration ID number to get data for</P
></LI
><LI
><P
>xmlFile: name of XML file whose contents will be appended to
                  cached depot results</P
></LI
><LI
><P
>xsl: name of stylesheet to format returned XML</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/xslt.jsp?suiteName=sampleSuite&#38;resourceID=defaultGrid&#38;xsl=default.xsl"
TARGET="_top"
>http://localhost:8080/inca/xslt.jsp?suiteName=sampleSuite&#38;resourceID=defaultGrid&#38;xsl=default.xsl</A
></P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>graph.jsp</TT
>
                <P
><IMG
SRC="figures/consumer/graph_sm.jpg"
ALIGN="CENTER"></P
>
              </P
></TD
><TD
><P
>                Historical graphs of pass/fail status and error frequency.
              </P
></TD
><TD
><P
>Depot's <A
HREF="http://inca.sdsc.edu/releases/2.2/javawsdocs/edu/sdsc/inca/DepotClient.html#queryHql(java.lang.String)"
TARGET="_top"
>queryHql()</A
>
                function to query for historical infomation.
              </P
></TD
><TD
><P
></P
><UL
><LI
><P
>configID: comma separated list of configuration IDs to
                  get data for</P
></LI
><LI
><P
>seriesLabel: comma separated list of legend labels</P
></LI
><LI
><P
>title: title of pass/fail status graph</P
></LI
><LI
><P
>alias: boolean for image anti-aliasing</P
></LI
><LI
><P
>legend: boolean for showing legend</P
></LI
><LI
><P
>legendAnchor: position of legend</P
></LI
><LI
><P
>height: graph height in pixels</P
></LI
><LI
><P
>width: graph width in pixels</P
></LI
><LI
><P
>mime: boolean for image MIME</P
></LI
><LI
><P
>xaxislabel: label for x-axis of pass/fail graph</P
></LI
><LI
><P
>xmin: date to start querying data for</P
></LI
><LI
><P
>xmax: date to stop querying data for</P
></LI
><LI
><P
>start: boolean for getting only past two weeks of data</P
></LI
><LI
><P
>yaxislabel: label for y-axis of pass/fail graph</P
></LI
><LI
><P
>ymin: y-axis min for pass/fail graph</P
></LI
><LI
><P
>ymax: y-axis max for pass/fail graph</P
></LI
><LI
><P
>ytick: tick increment for y-axis pass/fail graph</P
></LI
><LI
><P
>bgcolor: background color of graph images</P
></LI
><LI
><P
>map: boolean for showing graph links and mouseovers</P
></LI
></UL
><P
>e.g. <A
HREF="http://localhost:8080/inca/graph.jsp?configID=1"
TARGET="_top"
>http://localhost:8080/inca/graph.jsp?configID=1</A
></P
></TD
></TR
></TBODY
></TABLE
></DIV
><P
>        The default JSP scripts retrieve XML data from the
        agent and depot and then use the XSL stylesheets in
        <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/xsl</TT
> are used
           to transform the XML into HTML.
           The following stylesheets are installed
        with the default consumer:</P
><DIV
CLASS="TABLE"
><A
NAME="AEN589"
></A
><P
><B
>Table 3. Default Consumer XSL</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><THEAD
><TR
VALIGN="TOP"
><TH
><P
>Name</P
></TH
><TH
><P
>Applied To</P
></TH
><TH
><P
>Purpose</P
></TH
></TR
></THEAD
><TBODY
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>index.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/index_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>index.jsp</TT
></P
></TD
><TD
><P
>                  Lists all configured suite and resource names in an
                  HTML form whose action is to display results for the
                  selected suite and resource.
                </P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>config.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/config_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>config.jsp</TT
></P
></TD
><TD
><P
>Prints description of deployed suites and series.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>default.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/sum_page2_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>xslt.jsp</TT
></P
></TD
><TD
><P
>Prints table of suite(s) results.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>swStack.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/swstack_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>xslt.jsp</TT
></P
></TD
><TD
><P
>Prints table of suite(s) results.  Uses XML file
                  to format table rows by software categories and packages.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>summary.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/summary_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>xslt.jsp</TT
></P
></TD
><TD
><P
>Prints summary results table with a list of
                  resources in the left column and
                  a list of the suite tests each resource is failing
                  in the right column.  Failing tests are listed by name
                  and by overall percentage passing in suite.
                  Uses XML file (<TT
CLASS="FILENAME"
>swStack.xml</TT
> by default) to get test groups.
                </P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>google.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/google_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>xslt.jsp</TT
></P
></TD
><TD
><P
>Prints google map summary of current data.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>graph.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/graph_form_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>xslt.jsp</TT
></P
></TD
><TD
><P
>Prints form to select series to graph.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>instance.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/inst_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>xslt.jsp</TT
></P
></TD
><TD
><P
>Prints HTML table with report details.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>header.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/header_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
><TT
CLASS="FILENAME"
>(included in most other xsl files)</TT
></P
></TD
><TD
><P
>Prints HTML page header.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>footer.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/footer_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
>(included in most other xsl files)</P
></TD
><TD
><P
>Prints HTML page footer with the Inca logo.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>legend.xsl</TT
>
                  <P
><IMG
SRC="figures/consumer/legend_sm.jpg"
ALIGN="CENTER"></P
>
                </P
></TD
><TD
><P
>(included in <TT
CLASS="FILENAME"
>default.xsl</TT
>
                  and <TT
CLASS="FILENAME"
>swStack.xsl</TT
>)</P
></TD
><TD
><P
>Prints a key to cell colors and text.</P
></TD
></TR
><TR
VALIGN="TOP"
><TD
><P
><TT
CLASS="FILENAME"
>inca-common.xsl</TT
></P
></TD
><TD
><P
>(included in most other stylesheets)</P
></TD
><TD
><P
>Common templates for use in Inca stylesheets.</P
></TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECTION"
><H3
CLASS="SECTION"
><A
NAME="CURRENT-DATA"
>6.1.1. Current Data Pages</A
></H3
><DIV
CLASS="SECTION"
><H4
CLASS="SECTION"
><A
NAME="GOOGLE"
>6.1.1.1. Map View using Google Map API</A
></H4
><DIV
CLASS="SECTION"
><H5
CLASS="SECTION"
><A
NAME="GOOGLE-OVERVIEW"
>6.1.1.1.1. Overview</A
></H5
><P
>The map view provides a summary view of the current status
          of resources on a Google map.  For each resource, the summary view will
          provide the percentage of reports passed, number of passed reports, number
          of failed reports, and a list of the failed tests (with a link to the report
          details page).  A resource is represented on the map as a marker and colored
          red, green, or orange based on the number of tests that have passed and/or
          failed.  The figure below shows the Inca Google map view for the NEON
          testbed (four resources at SDSC and one resource at James Reserve).  All
          resources are passing their tests so every resource marker is green.
        </P
><P
><IMG
SRC="figures/consumer/googleNeon.png"
ALIGN="CENTER"></P
><P
>          Clicking on a marker will display an info window with the name of the
          resource and the status information as show below.
        </P
><P
><IMG
SRC="figures/consumer/googleNeonInfo.png"
ALIGN="CENTER"></P
><P
>          Clicking on the "Toggle ping status" button will display the status of the
          cross-site ping test as show below.
        </P
><P
><IMG
SRC="figures/consumer/googleNeonPing.png"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><H5
CLASS="SECTION"
><A
NAME="GOOGLE-SETUP"
>6.1.1.1.2. Setting up Google Map View</A
></H5
><P
>          The Google Map View is generated by running the
          <TT
CLASS="FILENAME"
>google.xsl</TT
> stylesheet over the XML collected by
          <TT
CLASS="FILENAME"
>xslt.jsp</TT
>.  To load the Google map for your Inca
          default deployment, click on the "map of sampleSuite results" link
          underneath the "CURRENT DATA" menu item in the navigation bar.
        </P
><P
><IMG
SRC="figures/consumer/googleMapMenu.png"
ALIGN="CENTER"></P
><P
>Or you can view the map using the following url:  </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>          http://<STRONG
><FONT
COLOR="RED"
>yourhost</FONT
></STRONG
>:8080/inca/xslt.jsp?xsl=google.xsl&#38;xmlFile=google.xml&#38;suiteName=sampleSuite&#38;resourceID=defaultGrid
        </PRE
></FONT
></TD
></TR
></TABLE
><P
>          The tags "suiteName" and "resourceID" can be a comma delimited list to show
          the resource status for multiple suites.
        </P
><P
>          If this is your first time loading the page, you will see
          a Javascript alert box such as that below.</P
><P
><IMG
SRC="figures/consumer/googlePopUp.png"
ALIGN="CENTER"></P
><P
>          To utilize the Google map server, you need a "Google Maps API key" for
          your Inca consumer.  To generate one, go the Google Maps API web page at
          <A
HREF="http://www.google.com/apis/maps/signup.html"
TARGET="_top"
>http://www.google.com/apis/maps/signup.html</A
>
          and type in "http://<STRONG
><FONT
COLOR="RED"
>yourHost</FONT
></STRONG
>:8080 in the
          "My web site URL" text box and click the "Generate API key" button.  A
          page will be generated displaying a new key for your server that looks
          something like this:
          ABQIAAAA_4IHDoSvxQqISMa1RKFLQBSSlCzupJMr-Xoh__duR37DAX9UVBRVn9-X9_4ILpmvilr4hN-QZU8pNQ.
          Next, open <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/xml/google.xml</TT
> and go to
          line 12.
        </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>          ...
          &#60;!-- Google key for your Inca server.  Go to the following website and put
          http://yourservername:8080 in the "My web site URL" textbox at:
          http://www.google.com/apis/maps/signup.html --&#62;
          &#60;key&#62;Insert key here&#60;/key&#62;
          ...
        </PRE
></FONT
></TD
></TR
></TABLE
><P
>Replace "Insert key here" with your new Google Maps API key as below
          and save the file.
        </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>          ...
          &#60;!-- Google key for your Inca server.  Go to the following website and put
          http://yourservername:8080 in the "My web site URL" textbox at:
          http://www.google.com/apis/maps/signup.html --&#62;
          &#60;key&#62;ABQIAAAA_4IHDoSvxQqISMa1RKFLQBSSlCzupJMr-Xoh__duR37DAX9UVBRVn9-X9_4ILpmvilr4hN-QZU8pNQ&#60;/key&#62;
          ...
        </PRE
></FONT
></TD
></TR
></TABLE
><P
>Next, reload the web page and the default configuration will show
          one resource (indicated by the orange marker) and the Inca logo as below.
        </P
><P
><IMG
SRC="figures/consumer/googleDefaultMap.jpg"
ALIGN="CENTER"></P
><P
>Clicking on the orange marker will display an info box as below
          indicating "vtk-ngl_version" as the only test that has failed. Clicking on
          "vtk-ngl_version" will take you to the reporter details page.</P
><P
><IMG
SRC="figures/consumer/googleDefaultMapInfo.jpg"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><H5
CLASS="SECTION"
><A
NAME="GOOGLE-CUSTOM"
>6.1.1.1.3. Customizing the Google Map View</A
></H5
><P
>          The configuration information for the Google Map View is located in a
          XML file at <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/xml/google.xml</TT
>.
          Below is a list of customizations you can make to your Google display.
        </P
><P
></P
><DIV
CLASS="VARIABLELIST"
><P
><B
>Customizations</B
></P
><DL
><DT
><TT
CLASS="FILENAME"
>map size</TT
></DT
><DD
><P
>                The size of the Google map can be customized using the &#60;width&#62; and
                &#60;height&#62; tags on lines 14-15.  By default the map is 800x500.
                <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                  13  &#60;!-- The size of the map graphic (in pixels) that will be generated --&#62;
                  14  &#60;width&#62;800&#60;/width&#62;
                  15  &#60;height&#62;500&#60;/height&#62;
                </PRE
></FONT
></TD
></TR
></TABLE
>
              </P
></DD
><DT
><TT
CLASS="FILENAME"
>map center</TT
></DT
><DD
><P
>                The center of the map is expressed in latitude/longitude coordinates on
                lines 18-21.  By default, the center of the map corresponds to the
                center of the U.S.
                <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                  17   &#60;!-- The center of the map in latitude/longitude coordinates --&#62;
                  18   &#60;center&#62;
                  19     &#60;latitude&#62;37&#60;/latitude&#62;
                  20     &#60;longitude&#62;982&#60;/longitude&#62;
                  21   &#60;/center&#62;
                </PRE
></FONT
></TD
></TR
></TABLE
>
              </P
></DD
><DT
><TT
CLASS="FILENAME"
>magnification level</TT
></DT
><DD
><P
>                The initial magnification or zoom level of the map is expressed as
                a number between 1 and 12 and is located on line 24.  A zoom level of 1
                will give you the entire world and a zoom level of 12 will allow you to
                read street names.  By default the initial zoom level is 4 which allows
                most of the U.S. to be viewed.
                <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                  23   &#60;!-- The initial zoom level of the map (higher is closer up) --&#62;
                  24   &#60;magnificationLevel&#62;4&#60;/magnificationLevel&#62;
                </PRE
></FONT
></TD
></TR
></TABLE
>
              </P
></DD
><DT
><TT
CLASS="FILENAME"
>marker distance</TT
></DT
><DD
><P
>                If there is more than one resource at a particular site, the resources
                will be layed in a circle around the site center.  By default, the
                distance between the markers will be determined by the chosen
                magnificationLevel so that the markers do not overlap each other.  To
                increase or decrease the distance in between the markers (expressed in
                latitude/longitude), uncomment the &#60;markerDist&#62; tag on line 29.
                <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                  26   &#60;!-- The distance in between resource markers at a site.  A default value
                  27        is available based on the magnificationLevel.  To override the default,
                  28        uncommment the line below and set a new value
                  29   &#60;markerDist&#62;1.00&#60;/markerDist&#62;
                  30   --&#62;
                </PRE
></FONT
></TD
></TR
></TABLE
>
              </P
></DD
><DT
><TT
CLASS="FILENAME"
>number of errors displayed in info window</TT
></DT
><DD
><P
>                If there are more than fifteen errors at a resource, only the first fifteen
                errors will be displayed in the info window that is displayed when a
                resource is clicked.  To override, edit the &#60;maxErrors&#62; tag on line
                33.
                <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                  32   &#60;!-- The maximum number of errors to display in the info window --&#62;
                  33   &#60;maxErrors&#62;15&#60;/maxErrors&#62;
                </PRE
></FONT
></TD
></TR
></TABLE
>
              </P
></DD
><DT
><TT
CLASS="FILENAME"
>cross-site test line colors</TT
></DT
><DD
><P
>                If a suite contains a cross-site test, a button will be displayed below
                the map named "Toggle &#60;testName&#62; status".  When the button is
                clicked, the status of an individual cross-site test will be expressed as
                a line in between the source resource and the destination resource.
                The color of the line used to represent the test status can be customized.
                By default, green represents the test passed and red represents the test
                failed.  To change, edit lines 37-40.
                <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                  35   &#60;!-- For cross-site tests, a line will be displayed in between the 2 sites to
                  36        indicate the test status.  Customize the colors for pass fail below. --&#62;
                  37   &#60;line&#62;
                  38     &#60;pass&#62;#228B22&#60;/pass&#62;
                  39     &#60;fail&#62;#FF0000&#60;/fail&#62;
                  40   &#60;/line&#62;
                </PRE
></FONT
></TD
></TR
></TABLE
>
              </P
></DD
><DT
><TT
CLASS="FILENAME"
>resource markers</TT
></DT
><DD
><P
>                A resource is represented by a Google marker and the color varies
                on the number of tests that it failed:
                all tests passed = <IMG
SRC="figures/consumer/mm_20_green.png"
ALIGN="CENTER">, at least one test failed = <IMG
SRC="figures/consumer/mm_20_orange.png"
ALIGN="CENTER">,
                all tests failed = <IMG
SRC="figures/consumer/mm_20_red.png"
ALIGN="CENTER">.  Suppose you wanted to change the icons displayed to
                weather icons found at <A
HREF="http://econym.googlepages.com/geicons.htm"
TARGET="_top"
>http://econym.googlepages.com/geicons.htm</A
> such as follows:
                all tests passed = <IMG
SRC="figures/consumer/icon33.png"
ALIGN="CENTER">, at least one test failed = <IMG
SRC="figures/consumer/icon34.png"
ALIGN="CENTER">,
                all tests failed = <IMG
SRC="figures/consumer/icon36.png"
ALIGN="CENTER">.  Use the following steps:

                <P
></P
><OL
TYPE="i"
><LI
><P
>Find the size of the icons and modify the tags &#60;iconWidth&#62; and
                      &#60;iconHeight&#62;.  These weather icons are 32x32 so we would change lines
                      46 and 47 as follows:
                      <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                        46     &#60;iconWidth&#62;32&#60;/iconWidth&#62;
                        47     &#60;iconHeight&#62;32&#60;/iconHeight&#62;
                      </PRE
></FONT
></TD
></TR
></TABLE
>
                    </P
></LI
><LI
><P
>Pick the anchor point for the icon to be placed in relation to
                      the resource's place on the map.  Since we want the middle of
                      the icon to be placed on the map, we choose the coordinates (16, 16)
                      and modify line 50 as follows:
                      <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                        50     &#60;iconAnchorCoord&#62;16, 16&#60;/iconAnchorCoord&#62;
                      </PRE
></FONT
></TD
></TR
></TABLE
>
                    </P
></LI
><LI
><P
>Then we also need to determine the anchor point for the info
                      window to pop up relative to the icon.  Since we want the info window
                      to appear in the top middle, we choose the coordinates (16, 10) and
                      modify line 54 as follows:
                      <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                        54     &#60;iconInfoWindowAnchorCoord&#62;16, 10&#60;/iconInfoWindowAnchorCoord&#62;
                      </PRE
></FONT
></TD
></TR
></TABLE
>
                    </P
></LI
><LI
><P
>The three weather icons are located on the Google server at:
                      <A
HREF="http://maps.google.com/mapfiles/kml/pal4/icon33.png"
TARGET="_top"
>http://maps.google.com/mapfiles/kml/pal4/icon33.png</A
>,
                      <A
HREF="http://maps.google.com/mapfiles/kml/pal4/icon34.png"
TARGET="_top"
>http://maps.google.com/mapfiles/kml/pal4/icon34.png</A
>,
                      <A
HREF="http://maps.google.com/mapfiles/kml/pal4/icon36.png"
TARGET="_top"
>http://maps.google.com/mapfiles/kml/pal4/icon36.png</A
>.  Modify lines 61-67 as follows:
                      <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                        61  &#60;iconUrlPrefix&#62;http://maps.google.com/mapfiles/kml/pal4/icon&#60;/iconUrlPrefix&#62;
                        62  &#60;iconStatus&#62;
                        63    &#60;fail&#62;36&#60;/fail&#62;
                        64    &#60;pass&#62;33&#60;/pass&#62;
                        65    &#60;warn&#62;34&#60;/warn&#62;
                        66  &#60;/iconStatus&#62;
                        67  &#60;iconUrlSuffix&#62;.png&#60;/iconUrlSuffix&#62;
                      </PRE
></FONT
></TD
></TR
></TABLE
>
                    </P
></LI
><LI
><P
>Finally, we specify the url to the shadow icon using
                      &#60;shadowIconUrl&#62;, &#60;shadowIconWidth&#62;, and
                      &#60;shadowIconHeight&#62; tags on lines 70-74 as follows:
                      <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>                        69  &#60;!-- Url of a icon to use for the shadow of the resource icon --&#62;
                        70  &#60;shadowIconUrl&#62;http://maps.google.com/mapfiles/kml/pal4/icon36s.png&#60;/shadowIconUrl&#62;
                        71
                        72  &#60;!-- the size of the shadow icon --&#62;
                        73  &#60;shadowIconWidth&#62;59&#60;/shadowIconWidth&#62;
                        74  &#60;shadowIconHeight&#62;32&#60;/shadowIconHeight&#62;
                      </PRE
></FONT
></TD
></TR
></TABLE
>
                    </P
></LI
></OL
>
              </P
></DD
><DT
><TT
CLASS="FILENAME"
>sites</TT
></DT
><DD
><P
>                By default, resources will be displayed around in the map center.
                To specify a site (i.e., a location on the map with its resources), use
                the &#60;site&#62; tag from lines 80 to 111.  Provide a site name using the
                &#60;name&#62; tag, latitude/longitude coordinates using the &#60;latitude&#62;
                and &#60;longitude&#62; tags.  There are online tools, like
                <A
HREF="http://netgeo.caida.org/perl/netgeo.cgi/"
TARGET="_top"
>CAIDA's NetGeo script</A
>,
                to help convert the IP addresses of your resources to latitude/longitude.
                Specify a list of resource names at a site using the &#60;resource&#62; tag.
                Optionally you can specify a logo for the site
                using the &#60;logo&#62; tag.  Specify the size of the logo (&#60;width&#62;
                and &#60;height&#62;), angle from 0 degrees (&#60;angle&#62;), and logo
                anchor coordinates (&#60;logoAnchorX&#62;, &#60;logoAnchorY&#62;) as
                shown in the below figure.
                <P
><IMG
SRC="figures/consumer/googleSite.png"
ALIGN="CENTER"></P
>
              </P
></DD
></DL
></DIV
></DIV
></DIV
></DIV
><DIV
CLASS="SECTION"
><H3
CLASS="SECTION"
><A
NAME="HISTORICAL-DATA"
>6.1.2. Historical Data Pages</A
></H3
><P
>All reporter data collected by Inca is stored in the depot.
        The depot can then be queried to produce graphs of historical information.
        Inca's default data consumer uses
        <A
HREF="http://cewolf.sourceforge.net/"
TARGET="_top"
>Cewolf</A
>,
        a JSP tag library for graphing based on
        <A
HREF="http://www.object-refinery.com/jfreechart/"
TARGET="_top"
>JFreeChart</A
>.
        The default consumer includes a basic graph of the historical pass/fail status of
        reporter series and a graph of error message counts if there are
        any reporter errors.  The pass/fail status is either the
        comparitor status (if the series
        has a comparitor) or the reporter's exit status.
      </P
><P
>The section for historical data in the
        default page header is a form to select series from the
        sampleSuite suite.  To link other historical
      pages under this heading (e.g. a form to select series from
        other suites, customize the
      <TT
CLASS="FILENAME"
>header.xsl</TT
> file as described in
      <A
HREF="userguide-consumer.html#CUSTOM-HTML-HEADER"
>Section 6.2.3</A
>.</P
><P
>If <TT
CLASS="FILENAME"
>graph.xsl</TT
> is used as the xsl parameter for the
        <TT
CLASS="FILENAME"
>xslt.jsp</TT
> script that displays suite results,
        a form will be generated to select suite series to graph.  For
        example, <A
HREF="http://localhost:8080/inca/xslt.jsp?xsl=graph.xsl&#38;suiteName=sampleSuite&#38;resourceID=defaultGrid"
TARGET="_top"
>http://localhost:8080/inca/xslt.jsp?xsl=graph.xsl&#38;suiteName=sampleSuite&#38;resourceID=defaultGrid</A
> will generate:
        <P
><IMG
SRC="figures/consumer/graphForm.jpg"
ALIGN="CENTER"></P
>
      </P
><P
>        After selecting the "vtk-nvgl_version" series and
        clicking on the "graph" button in the form above,
        a graph page is shown with
        an XY plot of the pass/fail status of the selected
        series, a series pass/fail summary table, a bar graph of
        error message frequency (if the selected series have errors),
        a summary table of error messages, and a form to customize the graph
        further (as in the image below).
        This graph page is generated by the <TT
CLASS="FILENAME"
>graph.jsp</TT
>
        script with Cewolf tags.
        <P
><IMG
SRC="figures/consumer/graph1.jpg"
ALIGN="CENTER"></P
>
      </P
><P
>To improve query speed, only two weeks of data are returned
        initially.  To query for all results, clear the "start date"
        field in the "customize graph" section and click "re-graph".
        Also to improve graph generate speed, data point
        mouseover text and links to
        report details are turned off for the pass/fail graph.
        The data points can be made interactive by choosing "show mouseovers/hyperlinks"
        in the "customize graph" section and clicking on "re-graph".
        Clicking on interactive data points will lead to
        report details pages, mousing over them will show
        collection times and any error messages.
        <P
><IMG
SRC="figures/consumer/graph2.jpg"
ALIGN="CENTER"></P
>
            </P
><P
>Multiple series can also be graphed together as in the image below.
      A table under each graph summarizes results for each series.
        <P
><IMG
SRC="figures/consumer/graph3.jpg"
ALIGN="CENTER"></P
>
            </P
><P
>Graph pages for individual series are also linked from the report details pages.
        <P
><IMG
SRC="figures/consumer/details_graph.png"
ALIGN="CENTER"></P
>
       </P
></DIV
><DIV
CLASS="SECTION"
><H3
CLASS="SECTION"
><A
NAME="INFO"
>6.1.3. Info Pages</A
></H3
><P
>Currently the only informational page is a list of
      all running reporters in an inca deployment.  To link other informational
      pages under this heading, customize the
      <TT
CLASS="FILENAME"
>header.xsl</TT
> file as described in
      <A
HREF="userguide-consumer.html#CUSTOM-HTML-HEADER"
>Section 6.2.3</A
>.</P
><P
><IMG
SRC="figures/consumer/running-reporters.jpg"
ALIGN="CENTER"></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><H2
CLASS="SECTION"
><A
NAME="CUSTOM-DISPLAY"
>6.2. Changing the Look</A
></H2
><DIV
CLASS="SECTION"
><H3
CLASS="SECTION"
><A
NAME="CUSTOM-COLOR"
>6.2.1. Colors and Fonts</A
></H3
><P
>        Properties such as colors and fonts are controlled by the default CSS (Cascading Style Sheet) located in
        <TT
CLASS="FILENAME"
>$INCA_DIST/var/jetty*/webapp/css/inca.css</TT
>.  The drop down nav bar in the header is controlled by
        <TT
CLASS="FILENAME"
>$INCA_DIST/var/jetty*/webapp/css/nav.css</TT
>.
        For example, to change the color in the reporter detail pages header bar
        open <TT
CLASS="FILENAME"
>inca.css</TT
> and change lines 111-112 to:
        <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>.header {
          background-color: #D07651;</PRE
></FONT
></TD
></TR
></TABLE
>
        The details pages will now look like:
        <P
><IMG
SRC="figures/consumer/color-change.jpg"
ALIGN="CENTER"></P
>
      </P
><P
>For general information, visit the [ <A
HREF="http://www.w3schools.com/css/"
TARGET="_top"
>CSS tutorial</A
> ].</P
></DIV
><DIV
CLASS="SECTION"
><H3
CLASS="SECTION"
><A
NAME="CUSTOM-HTML"
>6.2.2. HTML Layout</A
></H3
><P
>        To modify the default HTML layout, edit the XSL stylesheet that is being applied to the JSP or create a new stylesheet
        in <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/xsl</TT
> and pass it to the JSP as the "xsl" parameter.  </P
><P
>For general information about editing stylesheets,
        visit the [ <A
HREF="http://www.w3schools.com/xsl/"
TARGET="_top"
>XSL tutorial</A
> ].</P
><DIV
CLASS="SECTION"
><H4
CLASS="SECTION"
><A
NAME="CUSTOM-HTML-VALUES"
>6.2.2.1. Custom Values in HTML Table Cells</A
></H4
><P
>To display report values other
          than the default text of either a software version, "pass", or "error"
          on the suite results pages, edit <TT
CLASS="FILENAME"
>default.xsl</TT
>.  </P
><P
> For example, to change the default suite status to print the time successful
          reporters ran and a truncated error message for failures like:
        </P
><P
><P
><IMG
SRC="figures/consumer/text-change.jpg"
ALIGN="CENTER"></P
></P
><P
>Edit <TT
CLASS="FILENAME"
>default.xsl</TT
>, add a new variable for the custom table cell text and
          print the custom cell text rather than the default text:
        </P
><P
>          <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>188  &#60;xsl:variable name="cellText"&#62;
            189    &#60;xsl:choose&#62;
            190      &#60;xsl:when test="string($instance)=''"&#62;
            191        &#60;xsl:value-of select="''" /&#62;
            192      &#60;/xsl:when&#62;
            193      &#60;xsl:when test="string($result/body)!=''
            194             and string($result/errorMessage)=''
            195             and ($comparitor='Success' or count($comparitor)=0)"&#62;
            196               passed: 
            197        &#60;!-- get yyyy-mm-dd from gmt timestamp --&#62;
            198        &#60;xsl:value-of select="substring($result/gmt, 1, 10)" /&#62; 
            199        &#60;!-- get HH:MM from gmt timestamp --&#62;
            200        &#60;xsl:value-of select="substring($result/gmt, 12, 5)" /&#62;
            201      &#60;/xsl:when&#62;
            202      &#60;xsl:otherwise&#62;
            203               error:
            204        &#60;xsl:value-of select="substring($result/errorMessage, 1, 30)" /&#62;
            205      &#60;/xsl:otherwise&#62;
            206    &#60;/xsl:choose&#62;
            207  &#60;/xsl:variable&#62;
            208  &#60;xsl:choose&#62;
            209    &#60;xsl:when test="$exit!=''"&#62;
            210      &#60;td class="{$exit}"&#62;
            211        &#60;a href="{$href}"&#62;&#60;xsl:value-of select="$cellText"/&#62;&#60;/a&#62;
            212        &#60;xsl:if test="$url[matches(., 'markOld')]"&#62;</PRE
></FONT
></TD
></TR
></TABLE
>
        </P
></DIV
></DIV
><DIV
CLASS="SECTION"
><H3
CLASS="SECTION"
><A
NAME="CUSTOM-HTML-HEADER"
>6.2.3. Custom Page Header</A
></H3
><P
>An example of customizing the HTML header would be to add a call to a custom header stylesheet in the
          "printBodyTitle" template.  Edit <TT
CLASS="FILENAME"
>inca-common.xsl</TT
>:</P
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>13  <STRONG
><FONT
COLOR="RED"
>&#60;xsl:include href="custom-header.xsl"/&#62;</FONT
></STRONG
>
          ...
          24  &#60;xsl:template name="printBodyTitle"&#62;
          25    &#60;xsl:param name="title"/&#62;
          26    <STRONG
><FONT
COLOR="RED"
>&#60;xsl:call-template name="custom-header"/&#62;</FONT
></STRONG
>
          27    &#60;xsl:variable name="datenow" select="date:new()" /&#62;
          28    &#60;xsl:variable name="dateformat" select="sdf:new('MM-dd-yyyy hh:mm a (z)')"/&#62;
          29    &#60;table width="100%" border="0"&#62;
          30      &#60;tr align="left"&#62;</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>Create a <TT
CLASS="FILENAME"
>$INCA_DIST/webapps/xsl/custom-header.xsl</TT
> like:</P
><P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>&#60;?xml version="1.0" encoding="UTF-8"?&#62;

          &#60;!-- ================================================ --&#62;
          &#60;!-- Prints out custom header for Inca status pages   --&#62;
          &#60;!-- ================================================ --&#62;
          &#60;xsl:stylesheet version="1.0"
          xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
          xmlns="http://www.w3.org/1999/xhtml"&#62;

          &#60;xsl:template name="custom-header"&#62;
          &#60;table class="header" width="100%"&#62;
          &#60;tr&#62;
          &#60;td bgcolor="#003366"&#62;
          &#60;img class="logo" src="img/header.jpg"/&#62;
          &#60;/td&#62;
          &#60;/tr&#62;
          &#60;/table&#62;
          &#60;table class="menu" width="100%"&#62;
          ... custom navigation ...
          &#60;/table&#62;
          &#60;/xsl:template&#62;

          &#60;/xsl:stylesheet&#62;</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>The resulting page would look something like: </P
><P
><P
><IMG
SRC="figures/consumer/custom-header.jpg"
ALIGN="CENTER"></P
></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><H2
CLASS="SECTION"
><A
NAME="CONSUMER-ALT-LOCATION"
>6.3. Changing the Installation Location</A
></H2
><P
>You can install the data consumer in a non-default location (e.g. on a machine where the depot and agent are not running) if you: </P
><P
></P
><UL
><LI
><P
>          Copy the <TT
CLASS="FILENAME"
>incaInstall.sh</TT
> script to the machine where the consumer will run.
        </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% wget http://inca.sdsc.edu/releases/2.2/incaInstall.sh</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>          Install consumer on the new machine:
        </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./incaInstall.sh $INCA_DIST consumers</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>          Copy the consumer key, certificate, and trusted directory from the machine where the agent/depot are running (orig.machine)
          to the new machine:
        </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% scp <STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/consumerkey.pem $INCA_DIST/etc/; \
          scp <STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/consumercert.pem $INCA_DIST/etc/;
          scp "<STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/trusted/*" $INCA_DIST/etc/trusted/;</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>Edit the <TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> local file and specify the full hostname
          of the machine where the agent and depot are running:
          <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>114 inca.consumer.agent=incas://<STRONG
><FONT
COLOR="RED"
>agent.hostname</FONT
></STRONG
>:6323
            ...
            128 inca.consumer.depot=incas://<STRONG
><FONT
COLOR="RED"
>depot.hostname</FONT
></STRONG
>:6324</PRE
></FONT
></TD
></TR
></TABLE
>
        </P
></LI
><LI
><P
> Start the consumer component on the new machine: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca start consumer</PRE
></FONT
></TD
></TR
></TABLE
></LI
></UL
></DIV
><DIV
CLASS="SECTION"
><H2
CLASS="SECTION"
><A
NAME="CONSUMER-PORT"
>6.4. Changing the Port</A
></H2
><P
>      By default, the consumer is started on port 8080.  To change this, edit
      the etc/jetty.xml file and search for 'SocketListener'.  To change the
      port to say 8085, change the following line:
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;Set name="Port"&#62;&#60;SystemProperty name="jetty.port" default="8080"/&#62;&#60;/Set&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>to: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;Set name="Port"&#62;8085&#60;/Set&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECTION"
><H2
CLASS="SECTION"
><A
NAME="HTTPS-CONSUMER"
>6.5. Enabling https</A
></H2
><P
>      By default, the consumer is configured as an http server.  To
      disable http and enable https, edit the <TT
CLASS="FILENAME"
>jetty.xml</TT
>
      file in <TT
CLASS="FILENAME"
>$INCA_DIST/etc</TT
> and
      <P
></P
><OL
TYPE="1"
><LI
><P
>          comment out the section "Add and configure a HTTP listener to port 8080"
        </P
></LI
><LI
><P
>          uncomment the section "Add a HTTPS SSL listener on port 8443".
        </P
></LI
></OL
>
    </P
><P
>Note that the example below is to disable http and enable https.
    However, http and https can be enabled simultaneously if both sections are left uncommented.
  </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - --&#62;
      &#60;!-- Add and configure a HTTP listener to port 8080                  --&#62;
      &#60;!-- The default port can be changed using: java -Djetty.port=80     --&#62;
      &#60;!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - --&#62;
      &#60;!--
      &#60;Call name="addListener"&#62;
      &#60;Arg&#62;
      &#60;New class="org.mortbay.http.SocketListener"&#62;
      &#60;Set name="Port"&#62;&#60;SystemProperty name="jetty.port"
      default="8080"/&#62;&#60;/Set&#62;
      &#60;Set name="PoolName"&#62;P1&#60;/Set&#62;
      &#60;Set name="MinThreads"&#62;20&#60;/Set&#62;
      &#60;Set name="MaxThreads"&#62;200&#60;/Set&#62;
      &#60;Set name="lowResources"&#62;50&#60;/Set&#62;
      &#60;Set name="MaxIdleTimeMs"&#62;30000&#60;/Set&#62;
      &#60;Set name="LowResourcePersistTimeMs"&#62;2000&#60;/Set&#62;
      &#60;Set name="acceptQueueSize"&#62;0&#60;/Set&#62;
      &#60;Set name="ConfidentialPort"&#62;8443&#60;/Set&#62;
      &#60;Set name="IntegralPort"&#62;8443&#60;/Set&#62;
      &#60;/New&#62;
      &#60;/Arg&#62;
      &#60;/Call&#62;
      --&#62;


      &#60;!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - --&#62;
      &#60;!-- Add a HTTPS SSL listener on port 8443                           --&#62;
      &#60;!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - --&#62;
      &#60;Call name="addListener"&#62;
      &#60;Arg&#62;
      &#60;New class="org.mortbay.http.SslListener"&#62;
      &#60;Set name="Port"&#62;8443&#60;/Set&#62;
      &#60;Set name="PoolName"&#62;P1&#60;/Set&#62;
      &#60;Set name="MaxIdleTimeMs"&#62;30000&#60;/Set&#62;
      &#60;Set name="lowResources"&#62;30&#60;/Set&#62;
      &#60;Set name="LowResourcePersistTimeMs"&#62;2000&#60;/Set&#62;
      &#60;Set name="Keystore"&#62;etc/consumerKeystore&#60;/Set&#62;
      &#60;Set name="KeyPassword"&#62;OBF:1v8w1v2h1wg01z0d1z0h1wfy1v1x1v9q&#60;/Set&#62;
      &#60;Set name="Password"&#62;OBF:1v8w1v2h1wg01z0d1z0h1wfy1v1x1v9q&#60;/Set&#62;
      &#60;Set name="HttpHandler"&#62;
      &#60;New class="org.mortbay.http.handler.MsieSslHandler"&#62;
      &#60;Set name="UserAgentSubString"&#62;MSIE 5&#60;/Set&#62;
      &#60;/New&#62;
      &#60;/Set&#62;
      &#60;/New&#62;
      &#60;/Arg&#62;
      &#60;/Call&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>Then restart the consumer. </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      % ./bin/inca stop consumer; ./bin/inca start consumer
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>The https server will be on port 8443.  </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>https://<STRONG
><FONT
COLOR="RED"
>hostname</FONT
></STRONG
>:8443</PRE
></FONT
></TD
></TR
></TABLE
><DIV
CLASS="NOTE"
><P
></P
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="./stylesheet-images/note.gif"
HSPACE="5"
ALT="Note"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>By default, the https server will use the credential stored in
      <TT
CLASS="FILENAME"
>$INCA_DIST/etc/consumerKeystore</TT
>.  Its DN is
      "cn=Inca Consumer SSL, o=SDSC, l=San Diego, st=California, c=US".  If you'd
      like to generate a certificate with a different DN, run the keytool command as
      follows:
    </P
></TD
></TR
></TABLE
></DIV
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% rm -f etc/consumerKeystore; keytool -keystore etc/consumerKeystore \
      -alias jetty -genkey -keyalg RSA -dname <STRONG
><FONT
COLOR="RED"
>your_DN</FONT
></STRONG
>
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>It will prompt you for a keystore password and a key password.  You can
      either make them different or use the same one.  If you use the password
      "consumer", no further changes are needed.  Otherwise, you will have to modify
      &#60;Set name="KeyPassword"&#62; and &#60;Set name="Password"&#62; in the
      "Add a HTTPS SSL listener on port 8443" section in <TT
CLASS="FILENAME"
>jetty.xml</TT
>.
      You can either put the password in there in plain text or obfuscate it using
      Jetty's password utility as follows:
    </P
><P
>      <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% java -classpath lib/org.mortbay.jetty-5.1.10.jar:lib/commons-logging-1.0.4.jar \
        org.mortbay.util.Password <STRONG
><FONT
COLOR="RED"
>your_password</FONT
></STRONG
>
      </PRE
></FONT
></TD
></TR
></TABLE
>
    </P
><P
>It will output two lines such as follows:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      OBF:1v8w1v2h1wg01z0d1z0h1wfy1v1x1v9q
      MD5:1005b14bd29466723ace30d26f602f5b
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>Open <TT
CLASS="FILENAME"
>etc/jetty.xml</TT
> and replace the string beginning with OBF in both &#60;Set
      name="KeyPassword"&#62; and &#60;Set name="Password"&#62; with the string
      provided by Jetty's password utility:
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;Set name="KeyPassword"&#62;OBF:1v8w1v2h1wg01z0d1z0h1wfy1v1x1v9q&#60;/Set&#62;
      &#60;Set name="Password"&#62;OBF:1v8w1v2h1wg01z0d1z0h1wfy1v1x1v9q&#60;/Set&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECTION"
><H2
CLASS="SECTION"
><A
NAME="PASSWORD-CONSUMER"
>6.6. Adding Password Protection</A
></H2
><P
>      By default, a password is not required for a user to access the status pages
      served by the consumer.  To require a password, edit <TT
CLASS="FILENAME"
>$INCA_DIST/etc/webdefault.xml</TT
>
      and uncomment the section "Require password authentication
      to access Inca status pages".  Note that there are two sections with that
      title -- one for http and the other for https.  Uncomment the appropriate
      section such as:
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>      &#60;!-- ==================================================================== --&#62;
      &#60;!-- Require password authentication to access Inca status pages          --&#62;
      &#60;!--                        (http version)                                --&#62;
      &#60;!-- ==================================================================== --&#62;
      &#60;security-constraint&#62;
      &#60;web-resource-collection&#62;
      &#60;web-resource-name&#62;Any User&#60;/web-resource-name&#62;
      &#60;url-pattern&#62;/*&#60;/url-pattern&#62;
      &#60;/web-resource-collection&#62;
      &#60;auth-constraint&#62;
      &#60;role-name&#62;*&#60;/role-name&#62;
      &#60;/auth-constraint&#62;
      &#60;/security-constraint&#62;

      &#60;login-config&#62;
      &#60;auth-method&#62;BASIC&#60;/auth-method&#62;
      &#60;realm-name&#62;Inca Status Pages&#60;/realm-name&#62;
      &#60;/login-config&#62;
    </PRE
></FONT
></TD
></TR
></TABLE
><P
>By default, the username and password for the pages will be "inca".  To
      change this, edit <TT
CLASS="FILENAME"
>$INCA_DIST/etc/realm.properties</TT
> and customize the
      username and password for your installation.  If you do not want to store the
      password in plain text, use Jetty's password utility described in <A
HREF="userguide-consumer.html#HTTPS-CONSUMER"
>Section 6.5</A
>.</P
><P
>Then restart the consumer. </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca stop consumer; ./bin/inca start consumer</PRE
></FONT
></TD
></TR
></TABLE
><P
>The next time you view the status pages, you should see a login like:</P
><P
><IMG
SRC="figures/ug-consumer-password.png"
ALIGN="CENTER"></P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="userguide-incat.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="userguide-reporters.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Administering Inca with incat</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Reporters and Repositories</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>