  <section id="userguide-writing-consumer">
    <title>Writing Custom Data Consumers</title>
    <para>The default Inca consumers described in <xref linkend="FILE-DESC"> are generally created by 
fetching XML reporter information and applying XSL to produce HTML tables and graphs.  XML can be fetched for
specific Inca suites (or stored queries), resources, series and time frames.  A number of methods are available
for fetching Inca XML: <link linkend="rest">REST URLs</link>, <link linkend="FILE-DESC">JSPs</link> (using the "debug=1" parameter), <link linkend="USERGUIDE-APIS">Inca Client APIs</link>, and <link linkend="USERGUIDE-WEBSERVICES">Web Services</link>.  The different types of XML returned from these methods are described in <xref linkend="UNDERSTANDING-XML">.  
    </para><para>Once custom XML is retrieved (see <xref linkend="retrieving-data">), new XSL can be created to display the results according to individual requirements or the XML can be consumed by custom JSPs or other code.  Examples of XSL and JSP are located in the <filename>webapps/inca/xsl</filename> and <filename>webapps/inca/jsp</filename> directories respectively.  Below are 
some examples of the way XML can be transformed to produce the basic status pages.</para>
<para><xref linkend="pass-fail-table"> shows an example of XML that is transformed via XSL to produce a pass/fail table of test results. The XML is an array of <link linkend="consumer-report-summaries-xml">report summaries</link>, which are the result of querying for a suite or stored query.  The exit status or body of each report summary is matched to a resource by the XSL to show the latest result for each resource. If the report summary has a comparison result, it will be used instead of the exit status to determine whether the test passed or failed.  Comparison results are checks that are added before the report is stored - one example might be checking whether the software version found in the report was greater than a certain version number.</para>
<figure id="pass-fail-table">
  <title>Pass/Fail Table</title>
  <graphic fileref="figures/consumer/build-consumer.jpg" align="center">
  </graphic>
</figure>
<para>Another consumer example using <link linkend="consumer-report-summaries-xml">report summaries</link> XML is shown in <xref linkend="perf-table">.  Here the XML is transformed via XSL to produce a table of performance results. Like the pass/fail table, the XSL matches results and resources, but here XPath is used to display a statistic in the body instead of a pass/fail exit status. </para>
<figure id="perf-table">
  <title>Performance Body Stats Table</title>
  <graphic fileref="figures/consumer/build-consumer-perf.jpg" align="center">
  </graphic>
</figure>
<para>Simple pass/fail graphs are produced by transforming the <link linkend="consumer-graph-instance-xml">graph instance</link> XML as shown in <xref linkend="graph-example">.  The graph is produced by using the exit status values for the y-axis and the collected date values for the x-axis.</para>
<figure id="graph-example">
  <title>Pass/Fail Graph</title>
  <graphic fileref="figures/consumer/build-consumer-graph.jpg" align="center">
  </graphic>
</figure>
<para>The w3schools site offers an <ulink url="http://www.w3schools.com/xsl/">XSL tutorial</ulink> and an <ulink url="http://www.w3schools.com/xpath/xpath_intro.asp">XPath tutorial</ulink> for more general information about XSL and XPath.</para>

    <section id="retrieving-data">
    <title>Retrieving Data</title>
    <section id="rest">
      <title>REST URLs</title>
      <para>Inca provides the ability to fetch suite or stored query data in XML or HTML
      format using REST URLs.  By default, the consumer recognizes a 
      REST URL using the following format:
      </para>

      <para><filename>http://localhost:8080/inca/XML|HTML/rest/&lt;suiteName&gt;|&lt;queryName&gt;[/&lt;resourceId&gt;[/&lt;seriesNickname&gt;[/week|month|quarter|year]]]</filename></para>

  <table><title>Examples of Inca REST URLs</title>
  <tgroup cols="2">
  <thead>
    <row>
      <entry><para>REST URL (Equivalent URL shown under REST URL)</para></entry>
      <entry><para>Returns</para></entry>
    </row>
  </thead>
  <tbody>
    <row>
      <entry><para><ulink url="http://localhost:8080/inca/HTML/rest/sampleSuite">http://localhost:8080/inca/HTML/rest/sampleSuite</ulink></para><para>equivalent to:</para><para><ulink url="http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite">http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite</ulink></para></entry>
      <entry><para>An HTML table of latest results for the specified suite (or query).  Generated by applying an XSL stylesheet to an array of <link linkend="consumer-report-summaries-xml">report summaries</link>.</para><para><graphic fileref="figures/consumer/sum_page2_sm.jpg" align="center"></graphic> </para></entry>
    </row>
    <row>
      <entry><para><ulink url="http://localhost:8080/inca/HTML/rest/sampleSuite/defaultGrid">http://localhost:8080/inca/HTML/rest/sampleSuite/defaultGrid</ulink></para><para>equivalent to:</para><para><ulink url="http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite&amp;resourceIds=defaultGrid">http://localhost:8080/inca/jsp/status.jsp?suiteNames=sampleSuite&amp;resourceIds=defaultGrid</ulink></para></entry>
      <entry><para>An HTML table of latest results for the specified suite and resource.  Generated by applying an XSL stylesheet to an array of <link linkend="consumer-report-summaries-xml">report summaries</link>.</para><para><graphic fileref="figures/consumer/sum_page2_sm.jpg" align="center"></graphic></para></entry>
    </row>
    <row>
      <entry><para><ulink url="http://localhost:8080/inca/HTML/rest/sampleSuite/localResource/ant_version">http://localhost:8080/inca/HTML/rest/sampleSuite/localResource/ant_version</ulink></para><para>equivalent to:</para><para><ulink url="http://localhost:8080/inca/jsp/instance.jsp?nickname=ant_version&amp;resource=localResource&amp;collected=2010-06-14T12:52:00.000-07:00">http://localhost:8080/inca/jsp/instance.jsp?nickname=ant_version&amp;resource=localResource&amp;collected=2010-06-14T12:52:00.000-07:00</ulink> (collected param would vary)</para></entry>
      <entry><para>An HTML table of the latest <link linkend="consumer-report-details-xml">report details</link>
        for the specified suite, resource and series.</para><para> <graphic fileref="figures/consumer/inst_sm.jpg" align="center"></graphic> </para></entry>
    </row>
    <row>
      <entry><para><ulink url="http://localhost:8080/inca/HTML/rest/sampleSuite/localResource/ant_version/week">http://localhost:8080/inca/HTML/rest/sampleSuite/localResource/ant_version/week</ulink></para><para>equivalent to:</para><para><ulink url="http://localhost:8080/inca/jsp/graph.jsp?series=ant_helloworld_compile_test,localResource&amp;startDate=060710">http://localhost:8080/inca/jsp/graph.jsp?series=ant_helloworld_compile_test,localResource&amp;startDate=060710</ulink> (startDate param would vary)</para></entry>
      <entry><para>Graph of weekly historical results the specified suite, resource and series (also available for month, quarter or year). Generated by graphing an array of <link linkend="consumer-graph-instance-xml">graph instances</link>.</para><para><graphic fileref="figures/consumer/graph_sm.jpg" align="center"></graphic></para></entry>
    </row>
  </tbody>
  </tgroup>
</table>
      
     <para>If you want to fetch the data in XML, just replace HTML 
      as below:</para>

      <para><ulink url="http://localhost:8080/inca/XML/rest/sampleSuite/localResource">http://localhost:8080/inca/XML/rest/sampleSuite/localResource</ulink></para>

      <para>If you would like to change the id 'rest' to a more transparent id
      such as 'kit-status-v1', edit &lt;context-param&gt; in 
      <filename>$INCA_DIST/webapps/inca/WEB-INF/web.xml</filename> and restart the consumer.
      For example, change </para>

      <screen>
      &lt;context-param&gt;
        &lt;param-name&gt;restId&lt;/param-name&gt;
        &lt;param-value&gt;rest&lt;/param-value&gt;
      &lt;/context-param&gt;
      </screen>

      <para>to</para>

      <screen>
      &lt;context-param&gt;
        &lt;param-name&gt;restId&lt;/param-name&gt;
        &lt;param-value&gt;kit-status-v1&lt;/param-value&gt;
      &lt;/context-param&gt;
      </screen>
      
    </section>
<section id="userguide-apis">
<title>Inca Client APIs</title>

<para>Currently, we provide Perl and Java client APIs to the Inca agent and
depot. A number of the API functions return XML that can be used in custom Inca data consumers. For example, the DepotClient's queryInstance, queryLatest, and queryPeriod functions respectively return the report details, report summary, and graph instance XML document types described in <xref linkend="UNDERSTANDING-XML">.</para>

  <table><title>Inca client APIs</title>
  <tgroup cols="3">
  <thead>
    <row>
      <entry><para>Component</para></entry>
      <entry><para>Java API</para></entry>
      <entry><para>Perl API</para></entry>
    </row>
  </thead>
  <tbody>
    <row>
      <entry><para>client</para></entry>
      <entry><para><ulink url="http://inca.sdsc.edu/releases/&ugVersion/javawsdocs/edu/sdsc/inca/Client.html">edu.sdsc.inca.Client</ulink></para></entry>
      <entry><para><ulink url="http://inca.sdsc.edu/releases/&ugVersion/wsdocs/Inca/Client.html">Inca::Client</ulink></para></entry>
    </row>
    <row>
      <entry><para>agent</para></entry>
      <entry><para><ulink url="http://inca.sdsc.edu/releases/&ugVersion/javawsdocs/edu/sdsc/inca/AgentClient.html">edu.sdsc.inca.AgentClient</ulink></para></entry>
      <entry><para><ulink url="http://inca.sdsc.edu/releases/&ugVersion/wsdocs/Inca/AgentClient.html">Inca::AgentClient</ulink></para></entry>
    </row>
    <row>
      <entry><para>depot</para></entry>
      <entry><para><ulink url="http://inca.sdsc.edu/releases/&ugVersion/javawsdocs/edu/sdsc/inca/DepotClient.html">edu.sdsc.inca.DepotClient</ulink></para></entry>
      <entry><para><ulink url="http://inca.sdsc.edu/releases/&ugVersion/wsdocs/Inca/DepotClient.html">Inca::DepotClient</ulink></para></entry>
    </row>
  </tbody>
  </tgroup>
</table>


</section>
<section id="userguide-webservices">
<title>Web Services</title>

<para>Like the <link linkend="userguide-apis">Inca Client APIs</link>, a number of Inca Web services functions
return XML that can be used in custom Inca data consumers.
To access Inca from a Web services API, you will need to install the
Inca web services component, <filename>incaws</filename>. </para>

<screen>% wget http://inca.sdsc.edu/releases/&ugVersion/incaInstall.sh
% sh incaInstall.sh $INCA_DIST incaws</screen>

<para>The results should look similar to:</para>

<screen>
Retrieving http://inca.sdsc.edu/releases/latest/Inca-WS.tar.gz
--12:59:23--  http://inca.sdsc.edu/releases/latest/Inca-WS.tar.gz
           => `Inca-WS.tar.gz'
Resolving inca.sdsc.edu... 198.202.75.28
Connecting to inca.sdsc.edu|198.202.75.28|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1,226,347 (1.2M) [application/x-tar]

100%[====================================>] 1,226,347     --.--K/s             

12:59:23 (81.68 MB/s) - `Inca-WS.tar.gz' saved [1226347/1226347]

Unpacking http://inca.sdsc.edu/releases/latest/Inca-WS.tar.gz
Inca-WS-1.6421/
Inca-WS-1.6421/lib/
...
Inca-WS-1.6421/etc/IncaWS.wsdl
Inca-WS-1.6421/version.svn
Will install Inca prerequisite Net::SSLeay
Will install Inca prerequisite IO::Socket::SSL
Will install Inca prerequisite Expat
Will install Inca prerequisite LWP::UserAgent
Will install Inca prerequisite MIME::Base64
Will install Inca prerequisite SOAP::Lite
Writing Makefile.perl.inc for Inca-WS
Inca-WS installed
</screen>

<para>To start incaws, specify the port, credentials, and hostname/port for
the Inca agent and depot as below.  Replace "origHost", "agentHost" and "depotHost" with the correct names for your installation.</para>

<screen>
% cd $INCA_DIST
% ./bin/inca incaws \
 --auth=yes \
 --cert=etc/agentcert.pem \
 --key=etc/agentkey.pem \
 --trusted=etc/trusted/<emphasis role="red">origHost</emphasis>cert.pem \
 --port=8001 \
 --password=yes \
 <emphasis role="red">depotHost</emphasis>:6324 \
 <emphasis role="red">agentHost</emphasis>:6323
<emphasis role="red">enter password (no prompt displayed)</emphasis>
</screen> 

<para>Check to make sure the incaws is running on port 8001 (error logs are in $INCA_DIST/var):
<screen>% netstat -an | grep 8001
tcp4       0      0  *.8001                 *.*                    LISTEN
</screen>
</para>

<para>The WSDL file for the incaws component is	in <filename>$INCA_DIST/etc/IncaWS.wsdl</filename>.  Documentation	for the file can be found <ulink url="http://inca.sdsc.edu/releases/&ugVersion/wsdocs/IncaWS_wsdl.html">here</ulink>.

<para>Below shows an example of how to access the Inca web services from Perl
using SOAP::Lite.</para>

<screen>
use SOAP::Lite;
use Cwd;

my $cwd = getcwd();
my $ws = SOAP::Lite->service("file:$cwd/etc/IncaWS.wsdl");

# check agent and depot are available
print $ws->pingAgent('hello agent'), "\n";
print $ws->pingDepot('hello depot'), "\n";

# get the Inca configuration
print $ws->getConfig(), "\n";
my $guid = $ws->queryGuids();

# get the latest instances of a suite
my $results = $ws->querySuite( $guid );
for my $result ( @{$results} ) {
  print $result;
}
</screen>

<para>Place the above code in a file called <filename>$INCA_DIST/sampleWS.pl</filename>
and set the environment variable PERL5LIB to
<filename>$INCA_DIST/lib/perl</filename>.  Then type, </para>

<screen>% perl sampleWS.pl</screen>

<para>When run against the default installation, the results should look
similar to below.</para>

<screen>
hello agent
hello depot
&lt;inca:inca xmlns:inca="http://inca.sdsc.edu/dataModel/inca_2.0"&gt;
&lt;repositories&gt;
  &lt;repository&gt;http://inca.sdsc.edu/repository/latest&lt;/repository&gt;
&lt;/repositories&gt;
&lt;resourceConfig&gt;
  &lt;resources&gt;
    &lt;resource&gt;
        &lt;name&gt;defaultGrid&lt;/name&gt;
        &lt;xpath&gt;//resource[matches(name, "localSite")]&lt;/xpath&gt;
      &lt;macros&gt;
 ...
  &lt;/resources&gt;
&lt;/resourceConfig&gt;
&lt;suites&gt;
  &lt;suite&gt;
    &lt;seriesConfigs&gt;
      &lt;seriesConfig&gt;
        &lt;series&gt;
          &lt;name&gt;cluster.math.atlas.version&lt;/name&gt;
          &lt;uri&gt;http:// ... cluster.math.atlas.version&lt;/uri&gt;
          &lt;args&gt;
            &lt;arg&gt;
              &lt;name&gt;cc&lt;/name&gt;
              &lt;value&gt;cc&lt;/value&gt;
            &lt;/arg&gt;
            &lt;arg&gt;
              &lt;name&gt;dir&lt;/name&gt;
              &lt;value/&gt;&lt;/arg&gt;
            &lt;arg&gt;
              &lt;name&gt;help&lt;/name&gt;
              &lt;value&gt;no&lt;/value&gt;
            &lt;/arg&gt;
            &lt;arg&gt;
              &lt;name&gt;log&lt;/name&gt;
              &lt;value&gt;3&lt;/value&gt;
            &lt;/arg&gt;
            &lt;arg&gt;
              &lt;name&gt;verbose&lt;/name&gt;
              &lt;value&gt;1&lt;/value&gt;
            &lt;/arg&gt;
 ...
        &lt;action&gt;add&lt;/action&gt;
      &lt;/seriesConfig&gt;
    &lt;/seriesConfigs&gt;
    &lt;name&gt;sampleSuite&lt;/name&gt;
    &lt;guid&gt;incas://rocks-101.sdsc.edu:6323/sampleSuite&lt;/guid&gt;
    &lt;description/&gt;
    &lt;version&gt;1&lt;/version&gt;
  &lt;/suite&gt;
&lt;/suites&gt;
&lt;/inca:inca&gt;

&lt;reportSummary xmlns="http://inca.sdsc.edu/queryResult/reportSummary_2.0"&gt;
  &lt;hostname xmlns=""&gt;localResource&lt;/hostname&gt;
  &lt;uri xmlns=""&gt;http:// ... cluster.math.atlas.version&lt;/uri&gt;
  &lt;nickname xmlns=""&gt;atlas_version&lt;/nickname&gt;
  &lt;seriesConfigId xmlns=""&gt;1&lt;/seriesConfigId&gt;
  &lt;instanceId xmlns=""&gt;24&lt;/instanceId&gt;
  &lt;gmt xmlns=""&gt;2007-02-01T13:21:01.000-08:00&lt;/gmt&gt;
  &lt;body xmlns:rep="http://inca.sdsc.edu/dataModel/report_2.1" xmlns=""/&gt;
  &lt;errorMessage xmlns=""&gt;Cannot locate ATLAS installation; use
-dir&lt;/errorMessage&gt;                    
&lt;/reportSummary&gt;
...
</screen> 

</section>
   </section>
   <section id="understanding-xml">
    <title>Understanding Inca XML Data</title>
    <para>Inca reporters are executable programs that measure some aspect of the system or installed software. 
Reporters support a set of command-line options and write XML reports to stdout.  The report schema is flexible and 
can capture multiple types of data.
<graphic fileref="figures/reporter/reporter-to-xml.jpg" align="center"></graphic></para>
    <para>The XML document produced by Inca reporters is called a report and it has a header, body and footer.  The header contains metadata, the body contains the data
collected by the reporter and has a 4000 character limit, and the footer captures whether the report was successfully gathered or not:
<graphic fileref="figures/reporter/reporter-xml.jpg" align="center"></graphic></para>
    <para>Most of the Inca XML types relate to the basic report type.  Some definitions to help understand the XML schemas
are:
<variablelist>
  <varlistentry><term><filename>report series</filename></term>
  <listitem><para>
  set of reports collected at different points in time by executing a reporter with a 
  set of arguments in a context on a particular resource
  </para> </listitem>
  </varlistentry>
  <varlistentry><term><filename>series config</filename></term>
  <listitem><para>
  used to create the report series and has hostname, args, reporter name/version, schedule, comparitor (extra check to determine pass/fail), and context (optional string used when executing the reporter, e.g. to add a softenv key: "soft add +atlas; cluster.math.atlas.version -args")
  </para> </listitem>
  </varlistentry>
  <varlistentry><term><filename>suite</filename></term>
  <listitem><para>
  group of series configs that share a common theme, for example data management, job management, or file transfer
  </para> </listitem>
  </varlistentry>
  <varlistentry><term><filename>resource group</filename></term>
  <listitem><para>
  two or more related resources that share a characteristic like a site, architecture or virtual organization.  A resource can be a cluster, supercomputer, or server.  The resource group XML is returned along with queries so that they can be matched to test results.  Below is a figure to illustrate resource groups:
<graphic fileref="figures/consumer/resource-groups.jpg" align="center"></graphic>
  </para> </listitem>
  </varlistentry>
  <varlistentry><term><filename>runtime data</filename></term>
  <listitem><para>
  in addition to the main body of data returned by reports, other runtime information is calculated after the report is executed and returned with it.  This data includes logged commands, usage information (how much memory, CPU and wallclock time a reporter consumes during execution) and comparison results (extra tests used to calculate whether a test passed or fails, e.g. whether the software version found matches a version requirement)
  </para> </listitem>
  </varlistentry>
</variablelist>

  <figure id="schemas">
  <title>Some Inca XML Types</title>
<graphic fileref="figures/arch/uml-schemas.jpg" align="center"></graphic>
</figure>
</para>
    <para>Inca depot query results are formatted as XML, most are an array of reporter execution <link linkend="consumer-report-summaries-xml">summary</link>, <link linkend="consumer-graph-instance-xml">graph</link> or <link linkend="consumer-report-details-xml">detail</link> information. These results can be retrieved from the REST, JSP, Client and Web services interfaces described in the previous section.</para>
   <section id="consumer-report-summaries-xml">
    <title>Report Summaries</title>
    <para>Report summaries return XML formatted like the following (tags are described below):
    <screen>&lt;reportSummary xmlns="http://inca.sdsc.edu/queryResult/reportSummary_2.0"&gt;
 &lt;hostname xmlns=""&gt;localResource&lt;/hostname&gt;
 &lt;uri xmlns=""&gt;file:///Inca-Reporter-5.12450/bin/cluster.compiler.any.unit&lt;/uri&gt;
 &lt;nickname xmlns=""&gt;java_hello_world&lt;/nickname&gt;
 &lt;seriesConfigId xmlns=""&gt;5&lt;/seriesConfigId&gt;
 &lt;instanceId xmlns=""&gt;49&lt;/instanceId&gt;
 &lt;gmt xmlns=""&gt;2010-06-08T15:25:01.000-07:00&lt;/gmt&gt;
 &lt;gmtExpires xmlns=""&gt;2010-06-08T15:45:01.027-07:00&lt;/gmtExpires&gt;
 &lt;body xmlns=""&gt;
  &lt;unitTest xmlns:rep="http://inca.sdsc.edu/dataModel/report_2.1"&gt;
   &lt;ID&gt;javac&lt;/ID&gt;
  &lt;/unitTest&gt;
 &lt;/body&gt;
 &lt;errorMessage xmlns=""/&gt;
 &lt;comparisonResult xmlns=""&gt;Success&lt;/comparisonResult&gt;
&lt;/reportSummary&gt;</screen>
  </para>
<para>
Report summaries use a prefix with a tag name that references the
http://inca.sdsc.edu/queryResult/reportSummary_2.0 namespace.
</para><para>
The following tags are defined within query results:
</para>

<variablelist>
  <varlistentry><term><filename>hostname</filename></term>
  <listitem><para>
  resource id where the reporter executed
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>uri</filename></term>
  <listitem><para>
  the URI of the reporter repository and the location of the reporter
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>nickname</filename></term>
  <listitem><para>
  the nickname (short name) for the report series
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>seriesConfigId</filename></term>
  <listitem><para>
  (internal) the database identifier for the series configuration information for this report summary (used in futher queries)
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>instanceId</filename></term>
  <listitem><para>
  (internal) the database identifier for the instance information for the particular time this report series executed (used in futher queries)
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>gmt</filename></term>
  <listitem><para>
  the time this report series executed (ISO 8601 format)
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>gmtExpires</filename></term>
  <listitem><para>
  the time when results from this report will become stale (ISO 8601 format)
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>body</filename></term>
  <listitem><para>
  results of the reporter's testing
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>errorMessage</filename></term>
  <listitem><para>
  optional string indicating why the reporter failed to complete
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>comparisonResult</filename></term>
  <listitem><para>
  if series was configured with a comparison, the result of the comparison for this particular report series execution
  </para> </listitem>
  </varlistentry>
</variablelist>
    
   </section>
   <section id="consumer-graph-instance-xml">
    <title>Graph Instances</title>
    <para>Graph instances return XML formatted like the following (tags are described below):
    <screen>&lt;row&gt;
 &lt;resource&gt;sapa&lt;/resource&gt;
 &lt;nickname&gt;cvs_repo&lt;/nickname&gt;
 &lt;instanceId&gt;41518967&lt;/instanceId&gt;
 &lt;reportId&gt;20958820&lt;/reportId&gt;
 &lt;configId&gt;20437465&lt;/configId&gt;
 &lt;collected&gt;2010-06-01T00:11:03.000-07:00&lt;/collected&gt;
 &lt;exit_status&gt;0&lt;/exit_status&gt;
 &lt;exit_message/&gt;
 &lt;body xmlns:rep="http://inca.sdsc.edu/dataModel/report_2.1"/&gt;
 &lt;comparisonResult&gt;Success&lt;/comparisonResult&gt;
&lt;/row&gt;</screen>
  </para>
<para>
Graph instances use a prefix with a tag name that references the
http://inca.sdsc.edu/dataModel/graphSeries_2.0 namespace.
</para><para>
The following tags are defined within query results:
</para>

<variablelist>
  <varlistentry><term><filename>resource</filename></term>
  <listitem><para>
  resource id where the reporter executed
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>nickname</filename></term>
  <listitem><para>
  the nickname (short name) for the report series
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>instanceId</filename></term>
  <listitem><para>
  (internal) the database identifier for the instance information for the particular time this report series executed (used in futher queries)
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>reportId</filename></term>
  <listitem><para>
  (internal) the database identifier for the report information for the particular result from this report series (used in further queries)
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>configId</filename></term>
  <listitem><para>
  (internal) the database identifier for the series configuration information for this report summary (used in futher queries)
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>collected</filename></term>
  <listitem><para>
  the time this report series executed (ISO 8601 format)
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>exit_status</filename></term>
  <listitem><para>
boolean indicating whether or not the reporter successfully completed its testing
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>exit_message</filename></term>
  <listitem><para>
  optional string indicating why the reporter failed to complete
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>body</filename></term>
  <listitem><para>
  results of the reporter's testing
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>comparisonResult</filename></term>
  <listitem><para>
  if series was configured with a comparison, the result of the comparison for this particular report series execution
  </para> </listitem>
  </varlistentry>
</variablelist>
    
   </section>
   <section id="consumer-report-details-xml">
    <title>Report Details</title>
    <para>The individual report details are generated by a depot query that returns XML formatted like the following (tags are described below):
    <screen>&lt;reportDetails xmlns="http://inca.sdsc.edu/dataModel/reportDetails_2.1"&gt;
  &lt;suiteId xmlns=""&gt;8140012&lt;/suiteId&gt;
  &lt;seriesConfigId xmlns=""&gt;8156370&lt;/seriesConfigId&gt;
  &lt;seriesId xmlns=""&gt;1712066&lt;/seriesId&gt;
  &lt;reportId xmlns=""&gt;28430963&lt;/reportId&gt;
  &lt;instanceId xmlns=""&gt;30977056&lt;/instanceId&gt;
  &lt;seriesConfig xmlns=""&gt;
    &lt;series&gt;
      &lt;name&gt;cluster.compiler.gcc.version&lt;/name&gt;
      &lt;version&gt;2&lt;/version&gt;
      &lt;uri&gt;http://inca.sdsc.edu/2.0/ctssv3/bin/cluster.compiler.gcc.version&lt;/uri&gt;
      &lt;args&gt;
        &lt;arg&gt;
          &lt;name&gt;log&lt;/name&gt;
          &lt;value&gt;5&lt;/value&gt;
        &lt;/arg&gt;
        &lt;arg&gt;
          &lt;name&gt;version&lt;/name&gt;
          &lt;value&gt;no&lt;/value&gt;
        &lt;/arg&gt;
        &lt;arg&gt;
          &lt;name&gt;help&lt;/name&gt;
          &lt;value&gt;no&lt;/value&gt;
        &lt;/arg&gt;
        &lt;arg&gt;
          &lt;name&gt;verbose&lt;/name&gt;
          &lt;value&gt;1&lt;/value&gt;
        &lt;/arg&gt;
      &lt;/args&gt;
      &lt;limits&gt;
        &lt;wallClockTime&gt;600.0&lt;/wallClockTime&gt;
        &lt;memory&gt;-1.0&lt;/memory&gt;
        &lt;cpuTime&gt;-1.0&lt;/cpuTime&gt;
      &lt;/limits&gt;
      &lt;context&gt;&lt;!&#91;CDATA&#91;bash -l -c 'set -a; cd /usr/users/9/inca/inca2install; export PERL5LIB=/usr/users/9/inca/inca2install/var/reporter-packages/lib/perl:${HOME}/inca/install/lib/perl &amp;&amp;cluster.compiler.gcc.version -help="no" -log="5" -verbose="1" -version="no";';&#93;&#93;&gt;&lt;/context&gt;
      &lt;nice&gt;false&lt;/nice&gt;
    &lt;/series&gt;
    &lt;nickname&gt;compiler-gnu-version-as-4.0.1&lt;/nickname&gt;
    &lt;resourceHostname&gt;psc-bigben&lt;/resourceHostname&gt;
    &lt;schedule&gt;
      &lt;cron&gt;
        &lt;min&gt;2&lt;/min&gt;
        &lt;hour&gt;17&lt;/hour&gt;
        &lt;mday&gt;*&lt;/mday&gt;
        &lt;wday&gt;*&lt;/wday&gt;
        &lt;month&gt;*&lt;/month&gt;
      &lt;/cron&gt;
      &lt;numOccurs&gt;-1&lt;/numOccurs&gt;
      &lt;suspended&gt;false&lt;/suspended&gt;
    &lt;/schedule&gt;
    &lt;acceptedOutput&gt;
      &lt;comparitor&gt;ExprComparitor&lt;/comparitor&gt;
      &lt;comparison&gt;gcc=~".*"&lt;/comparison&gt;
      &lt;notifications&gt;
        &lt;notification&gt;
          &lt;notifier&gt;EmailNotifier&lt;/notifier&gt;
          &lt;target&gt;FailTo:inca@sdsc.edu&lt;/target&gt;
        &lt;/notification&gt;
      &lt;/notifications&gt;
    &lt;/acceptedOutput&gt;
    &lt;action&gt;add&lt;/action&gt;
  &lt;/seriesConfig&gt;
  &lt;report xmlns=""&gt;...&lt;/report&gt;
  &lt;comparisonResult xmlns=""&gt;Success&lt;/comparisonResult&gt;
  &lt;sysusage xmlns=""&gt;
    &lt;wallClockTime&gt;0.929562&lt;/wallClockTime&gt;
    &lt;memory&gt;0.0&lt;/memory&gt;
    &lt;cpuTime&gt;0.556034&lt;/cpuTime&gt;
  &lt;/sysusage&gt;
  &lt;stderr xmlns=""/&gt;
&lt;/reportDetails&gt;</screen>
  </para>
<para>
Report detail output is surrounded by &lt;reportDetails&gt; tags.
A prefix with a tag name that references
http://inca.sdsc.edu/dataModel/reportDetails_2.1, which is the namespace that defines
the report schema, can also be used.
</para><para>
The following tags are defined within a &lt;reportDetails&gt;:
</para>

<variablelist>
  <varlistentry><term><filename>suiteId</filename></term>
  <listitem><para>
  (internal) the database identifier for the suite id number this report series belongs to (used in further queries)
  </para> </listitem>
  </varlistentry>

  <varlistentry><term><filename>seriesConfigId</filename></term>
  <listitem><para>
  (internal) the database identifier for the series configuration information for this report series (used in futher queries)
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>seriesId</filename></term>
  <listitem><para>
  (internal) the database identifier for the series information for this report series (used in further queries)
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>reportId</filename></term>
  <listitem><para>
  (internal) the database identifier for the report information for the particular result from this report series (used in further queries)
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>instanceId</filename></term>
  <listitem><para>
  (internal) the database identifier for the instance information for the particular time this report series executed (used in futher queries)
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>seriesConfig</filename></term>
  <listitem><para>
  all of the configuration options for this report series: name (of reporter), version (of reporter), uri (for reporter), args, limits (for consumption of wall clock time, memory, and cpu time), context (command to execute series), nickname (of series), resourceHostname (where series will execute), schedule (cron for executing series), acceptedOutput (can include "comparison" string to match in the report and "notification" actions to take if the comparison fails)
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>report</filename></term>
  <listitem><para>
  report XML like that described in <xref linkend="reporter-output">
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>comparisonResult</filename></term>
  <listitem><para>
  if series was configured with a comparison, the result of the comparison for this particular report series execution
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>sysusage</filename></term>
  <listitem><para>
  amount of wall clock time, memory and cpu time this particular report series execution consumed
  </para> </listitem>
  </varlistentry>
  
  <varlistentry><term><filename>stderr</filename></term>
  <listitem><para>
  standard error, if any, for this particular report series execution 
  </para> </listitem>
  </varlistentry>
</variablelist>
    
   </section>
   
   </section>

  </section>
