<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Inca 2.0 User's Guide</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="inca.css"></HEAD
><BODY
CLASS="ARTICLE"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN1"
>Inca 2.0 User's Guide</A
></H1
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
>1. <A
HREF="#USERGUIDE-INTRO"
>Introduction</A
></DT
><DT
>2. <A
HREF="#USERGUIDE-REQUIREMENTS"
>Requirements</A
></DT
><DT
>3. <A
HREF="#USERGUIDE-RECOMMENDATIONS"
>Recommendations</A
></DT
><DT
>4. <A
HREF="#USERGUIDE-QUICKSTART"
>Quick Start</A
></DT
><DT
>5. <A
HREF="#USERGUIDE-ADVANCED-CONFIG"
>Advanced Configuration</A
></DT
><DD
><DL
><DT
>5.1. <A
HREF="#POSTGRES"
>Using Postgres as DB Backend</A
></DT
></DL
></DD
><DT
>6. <A
HREF="#USERGUIDE-INCAT"
>Administering Inca with incat</A
></DT
><DD
><DL
><DT
>6.1. <A
HREF="#USERGUIDE-INCAT-REPOS"
>Repositories</A
></DT
><DT
>6.2. <A
HREF="#USERGUIDE-INCAT-RESOURCES"
>Resources</A
></DT
><DT
>6.3. <A
HREF="#USERGUIDE-INCAT-SUITES"
>Suites</A
></DT
><DT
>6.4. <A
HREF="#USERGUIDE-INCAT-COMMITS"
>Committing/Saving</A
></DT
><DT
>6.5. <A
HREF="#USERGUIDE-INCAT-REMOTE"
>Other Resource Options</A
></DT
><DT
>6.6. <A
HREF="#USERGUIDE-INCAT-MACROS"
>Using Resource Macros</A
></DT
><DT
>6.7. <A
HREF="#USERGUIDE-INCAT-COMPARISON"
>Series Comparison and Notification</A
></DT
></DL
></DD
><DT
>7. <A
HREF="#USERGUIDE-CONSUMER"
>Data Display (Data Consumers)</A
></DT
><DT
>8. <A
HREF="#USERGUIDE-REPORTERS"
>Reporters and Repositories</A
></DT
><DD
><DL
><DT
>8.1. <A
HREF="#REPORTER-CMDLINE"
>Executing Reporters</A
></DT
><DT
>8.2. <A
HREF="#REPORTER-WRITING"
>Writing Reporters</A
></DT
><DT
>8.3. <A
HREF="#REPORTER-REPOSITORIES"
>Reporter Repositories</A
></DT
></DL
></DD
><DT
>9. <A
HREF="#USERGUIDE-WEBSERVICES"
>Web Services and APIs</A
></DT
><DT
>10. <A
HREF="#USERGUIDE-TROUBLESHOOT"
>Troubleshooting</A
></DT
></DL
></DIV
><DIV
CLASS="SECTION"
><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-INTRO"
>1. Introduction</A
></H2
><P
>Determining whether a Grid is up in the face of complex Grid software
deployments can be difficult and depends on the types of applications and
users that utilize it.  By detailing a set of software, services, and features
that should be available on a Grid in a machine-readable format, a Grid can be
tested periodically by an automated system to verify its health and usability
to users.  To this end, we have developed Inca as a flexible framework to
perform periodic, user-level functionality testing and performance measurement
of Grid systems.  It includes mechanisms to schedule the execution of
information gathering scripts, and to collect, archive, publish, and display
data    </P
><P
>The architecture of Inca and a description of its components is shown in the
below figures.  </P
><DIV
CLASS="FIGURE"
><A
NAME="ARCH.FIG"
></A
><P
><B
>Figure 1. Inca architecture</B
></P
><P
><IMG
SRC="figures/arch.jpg"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="INFORMALTABLE"
><P
></P
><A
NAME="AEN10"
></A
><TABLE
BORDER="0"
FRAME="void"
CLASS="CALSTABLE"
><COL><COL><TBODY
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/ug-reporter-icon.png"></P
></TD
><TD
><P
> 
  A <EM
><FONT
>reporter</FONT
></EM
> is an executable program that tests or
  measures some aspect of the system or installed software.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/ug-report-icon.png"></P
></TD
><TD
><P
> 
  A <EM
><FONT
>report</FONT
></EM
> is the output of a reporter and is a XML
  document complying to the reporter schema in <A
HREF="#REPORTER-SCHEMA"
>Section 8.2.1</A
>.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/ug-suite-icon.png"></P
></TD
><TD
><P
> 
  A <EM
><FONT
>suite</FONT
></EM
> specifies a set of reporters to execute on
  selected resources, their configuration, and frequency of execution.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/ug-repository-icon.png"></P
></TD
><TD
><P
>  A <EM
><FONT
>reporter repository</FONT
></EM
> contains a collection of reporters and is available
  via an URL.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/ug-manager-icon.png"></P
></TD
><TD
><P
>  A <EM
><FONT
>reporter manager</FONT
></EM
> is responsible for managing the
  schedule and execution of reporters on a single resource.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/ug-agent-icon.png"></P
></TD
><TD
><P
>  A <EM
><FONT
>agent</FONT
></EM
> is a server that implements the configuration
  specified by the Inca Administrator.  
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/ug-incat-icon.png"></P
></TD
><TD
><P
>  <EM
><FONT
>incat</FONT
></EM
> is a GUI used by the Inca administrator to
  control and configure the Inca deployment on a set of resources.
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/ug-depot-icon.png"></P
></TD
><TD
><P
>  A <EM
><FONT
>depot</FONT
></EM
> is a server that is responsible for storing the
  data produced by reporters. 
  </P
></TD
></TR
><TR
><TD
ALIGN="CENTER"
><P
><IMG
SRC="figures/ug-consumer-icon.png"></P
></TD
><TD
><P
>  A <EM
><FONT
>data consumer</FONT
></EM
> is typically a web page client that
  queries a depot for data and displays it in a user-friendly format. 
  </P
></TD
></TR
></TBODY
></TABLE
><P
></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-REQUIREMENTS"
>2. Requirements</A
></H2
><P
>      The initial default installation of Inca has the following 
      requirements:
    </P
><P
></P
><UL
><LI
><P
>JDK or JRE 1.4.2_09 or greater</P
></LI
><LI
><P
>Perl 5.8.x or greater</P
></LI
><LI
><P
>OpenSSL-0.9.6[jkl] or OpenSSL-0.9.7b or greater</P
></LI
><LI
><P
>GNU tar (i.e., no limit on filename length)</P
></LI
></UL
><P
>      For each resource Inca will be monitoring, the following is
      required:
    </P
><P
></P
><UL
><LI
><P
>Perl 5.8.x or greater</P
></LI
><LI
><P
>OpenSSL-0.9.6[jkl] or OpenSSL-0.9.7b or greater</P
></LI
><LI
><P
>GNU tar (i.e., no limit on filename length)</P
></LI
></UL
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-RECOMMENDATIONS"
>3. Recommendations</A
></H2
><P
>We recommend that Inca be run under a regular user account and not as root for the following reasons:</P
><P
></P
><UL
><LI
><P
>    To best detect user-level problems, Inca should be run under a regular
    user account with the default environment setup.
    </P
></LI
><LI
><P
>    Inca does not require any special privileges to run.
    </P
></LI
></UL
><P
>Furthermore, we recommend that a valid GSI credential be obtained for this
regular user account so that tests of Grid software requiring proxy
certificates can be executed. Please request a GSI credential from your
virtual organization's Certificate Authority (CA) and consult your
organization's security policy regarding GSI credential use.  
<A
HREF="#PROXIES"
>Section 6.5.2</A
> describes using proxy credentials in the Inca framework.</P
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-QUICKSTART"
>4. Quick Start</A
></H2
><P
>This section describes how to download, install and verify the Inca 2.0 beta
binary release. The figure below represents a typical installation. </P
><DIV
CLASS="FIGURE"
><A
NAME="INSTALL-ARCH"
></A
><P
><B
>Figure 2. Inca Installation</B
></P
><P
><IMG
SRC="figures/arch-install.jpg"
ALIGN="CENTER"></P
></DIV
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>Step <A
HREF="#QS-STEP1"
>1</A
>: Download the installer script</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP2"
>2</A
>: Run the installer script</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP3"
>3</A
>: Change to the Inca installation directory</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP4"
>4</A
>: Create credentials for Inca components</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP5"
>5</A
>: Start up Inca components with a sample default configuration</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP6"
>6</A
>: View the Inca web server pages</TD
></TR
><TR
><TD
>Step <A
HREF="#QS-STEP7"
>7</A
>: View the sample default configuration using the Inca GUI tool</TD
></TR
></TBODY
></TABLE
><P
></P
><P
></P
><OL
TYPE="1"
><LI
><A
NAME="QS-STEP1"
></A
><P
>     Download the <TT
CLASS="FILENAME"
>incaInstall.sh</TT
> script:
    </P
><P
>    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% wget http://inca.sdsc.edu/releases/2.0beta/incaInstall.sh</PRE
></FONT
></TD
></TR
></TABLE
>
    </P
></LI
><LI
><A
NAME="QS-STEP2"
></A
><P
>    Execute the install script to download the binary distribution from our
    website and unpack it into an installation directory.  The installation directory is represented by 
    the $INCA_DIST environment variable - it may be useful to set this variable now. 
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% sh incaInstall.sh $INCA_DIST all</PRE
></FONT
></TD
></TR
></TABLE
><P
>$INCA_DIST is the location of the directory where you want to
    install Inca.  You should see something like:
    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>Retrieving http://inca.sdsc.edu/releases/current/inca-common-java-bin.tar.gz
--12:49:38--  http://inca.sdsc.edu/releases/current/inca-common-java-bin.tar.gz
=&#62; `inca-common-java-bin.tar.gz'
Resolving inca.sdsc.edu... 198.202.75.28
Connecting to inca.sdsc.edu|198.202.75.28|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5,921,461 [application/x-tar]

100%[======================&#62;] 5,921,461    1.23M/s  ETA 00:00

12:49:43 (1.18 MB/s) - `inca-common-java-bin.tar.gz' saved [5921461/5921461] 
...
common-java installed ...
agent installed ...
consumers installed ...
depot installed ...
incat installed</PRE
></FONT
></TD
></TR
></TABLE
>
      </P
></LI
><LI
><A
NAME="QS-STEP3"
></A
><P
>    Change to the top level directory of your Inca installation:
    </P
><P
>    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST</PRE
></FONT
></TD
></TR
></TABLE
>
    </P
></LI
><LI
><A
NAME="QS-STEP4"
></A
><P
>    Create certificates for the Inca components (enables secure component
    communication): 
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca createauth</PRE
></FONT
></TD
></TR
></TABLE
><P
>    The output will look similar to below and when it is completed, you should
    see a certificate/key created for each of the four Inca components and
    stored in $INCA_DIST/etc: 
    </P
><P
>    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>password&#62; (choose a password for the administration of your Inca installation)
Generating a 512 bit RSA private key
.++++++++++++
writing new private key to 'clientx.sdsc.edukey.pem'
-----
agent
Generating a 512 bit RSA private key
.++++++++++++
writing new private key to 'agentkey.pem' ...
writing new private key to 'consumerkey.pem' ...
writing new private key to 'depotkey.pem' ...
writing new private key to 'incatkey.pem' ...</PRE
></FONT
></TD
></TR
></TABLE
>
  </P
></LI
><LI
><A
NAME="QS-STEP5"
></A
><P
>    Start the Inca server components and deploy the sample default
    configuration (<STRONG
><FONT
COLOR="RED"
>NOTE:</FONT
></STRONG
> this command only needs to 
be executed ONCE.  The components started in this step can later be stopped with "./bin/inca stop all" and started with 
"./bin/inca start all").  The Inca server components are agent, depot, and consumer
    and will be started on ports 6323, 6324, and 8080 respectively.  Please
    edit the inca.properties file in etc/common to change these defaults.
    More information can be found in <A
HREF="#USERGUIDE-TROUBLESHOOT"
>Section 10</A
>.
    </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca default</PRE
></FONT
></TD
></TR
></TABLE
><P
>    You should see something like:
    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>password&#62; (enter password from the last step)
Preparing to deploy default Inca configuration...
Initializing Inca configuration...
** Warning:  this will erase any previously collected reporter
    state on the Inca depot and configuration on the agent 
    Do you wish to continue (y/n)? y
Initializing depot...
Initializing c3p0 pool... com.mchange.v2.c3p0.PoolBackedDataSource@904b13 [ connectionPoolDataSource -&#62; com.mchange.v2.c3p0.WrapperConnectionPoolDataSource@58bc22 [ acquireIncrement -&#62; 1, acquireRetryAttempts -&#62; 30, acquireRetryDelay -&#62; 1000, autoCommitOnClose -&#62; false, automaticTestTable -&#62; null, breakAfterAcquireFailure -&#62; false, checkoutTimeout -&#62; 0, connectionTesterClassName -&#62; com.mchange.v2.c3p0.impl.DefaultConnectionTester, factoryClassLocation -&#62; null, forceIgnoreUnresolvedTransactions -&#62; false, idleConnectionTestPeriod -&#62; 0, initialPoolSize -&#62; 3, maxIdleTime -&#62; 1800, maxPoolSize -&#62; 10, maxStatements -&#62; 50, maxStatementsPerConnection -&#62; 0, minPoolSize -&#62; 3, nestedDataSource -&#62; com.mchange.v2.c3p0.DriverManagerDataSource@e8b5fe [ description -&#62; null, driverClass -&#62; null, factoryClassLocation -&#62; null, jdbcUrl -&#62; jdbc:hsqldb:test, properties -&#62; {user=******, password=******} ] , preferredTestQuery -&#62; null, propertyCycle -&#62; 300, testConnectionOnCheckin -&#62; false, testConnectionOnCheckout -&#62; false, usesTraditionalReflectiveProxies -&#62; false ] , factoryClassLocation -&#62; null, numHelperThreads -&#62; 3, poolOwnerIdentityToken -&#62; 904b13 ] 
Database Initialization Completed
done
Initializing agent
done
Started Inca agent
Started Inca consumer
Started Inca depot
Sleeping for 20 seconds while the components come online
Deploying default configuration</PRE
></FONT
></TD
></TR
></TABLE
>
      </P
><P
>During this step:</P
><P
></P
><UL
><LI
><P
>three server components are started on localhost:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ps | grep java
 3527  p1  S      0:14.21 /usr/bin/java -Xmx256m edu.sdsc.inca.Agent -l /inca-dist/./bin/../var/agent.log
 3560  p1  S      0:17.63 /usr/bin/java -Xmx256m edu.sdsc.inca.Depot -l /inca-dist/./bin/../var/depot.log
 3593  p1  S      0:15.43 /usr/bin/java -Xmx256m edu.sdsc.inca.Consumer -l /inca-dist/./bin/../var/consumer.log</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>a sample suite called <EM
><FONT
>TestSuiteLocal</FONT
></EM
> is sent to the
        agent requesting reporters to be started on a localhost client using the
        schedule:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>1-59/10 * * * * cluster.math.atlas.version
2-59/10 * * * * cluster.compiler.gcc.version
3-59/10 * * * * cluster.security.openssl.version
4-59/10 * * * * cluster.interactive_access.openssh.version
5-59/10 * * * * cluster.interactive_access.openssh.unit
6-59/10 * * * * viz.lib.vtknvgl.version
7-59/10 * * * * viz.lib.chromium.version
8-59/10 * * * * cluster.compiler.any.unit</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>a client component is started on localhost:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ps | grep Manager
 5382  p1  S      0:02.14 /usr/bin/perl /home/incaReporterManager/sbin/../sbin/reporter-manager -d incas://client64-236.sdsc.edu:6324 -c etc/rmcert.</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
><UL
><LI
><P
>the agent receives <EM
><FONT
>TestSuiteLocal</FONT
></EM
> suite and installs a reporter 
          manager on the localhost in <TT
CLASS="FILENAME"
>~/incaReporterManager</TT
> (takes 1-5 minutes - view progress of build in 
          <TT
CLASS="FILENAME"
>~/incaReporterManager/build.log</TT
>)
        </P
></LI
><LI
><P
>after the reporter manager is built, it registers itself with 
          the agent.  The agent will send the reporter manager the set of
          reporters, libraries, and execution schedule. 
        </P
></LI
><LI
><P
>          The reporter manager executes reporters based on the execution
          schedule and sends reports to the depot.  
        </P
></LI
></UL
></LI
></UL
></LI
><LI
><A
NAME="QS-STEP6"
></A
><P
>To view results and verify that your Inca installation is
    working correctly, open the URL below in a browser.
    Starting a web server is not required, but you may need to replace "localhost" with the full hostname of your
    machine.
    <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>http://<STRONG
><FONT
COLOR="RED"
>localhost</FONT
></STRONG
>:8080</PRE
></FONT
></TD
></TR
></TABLE
>
    </P
><P
>    You should see a start up screen similar to the figure below initially
    indicating an empty Inca configuration.  
        <DIV
CLASS="FIGURE"
><A
NAME="INCA.STARTUP.EMPTY.FIG"
></A
><P
><B
>Figure 3. Default Inca start up page.</B
></P
><P
><IMG
SRC="figures/ug-consumer-startpage-empty.png"
ALIGN="CENTER"></P
></DIV
>
    </P
><P
>    After a few minutes (when the consumer cache is refreshed), reload the
    page and you should see a start up screen similar to the figure below 
    showing one suite called <EM
><FONT
>TestSuiteLocal</FONT
></EM
> 
    (our default sample configuration), a resource group called
    <EM
><FONT
>defaultvo</FONT
></EM
>, and one resource called
    <EM
><FONT
>siteA</FONT
></EM
> which is a nickname for the machine you 
    installed Inca on.
        <DIV
CLASS="FIGURE"
><A
NAME="INCA.STARTUP.FIG"
></A
><P
><B
>Figure 4. Default Inca start up page with suite and resources.</B
></P
><P
><IMG
SRC="figures/ug-consumer-startpage.png"
ALIGN="CENTER"></P
></DIV
>
    </P
><P
>    Select <EM
><FONT
>TestSuiteLocal</FONT
></EM
> and
    <EM
><FONT
>defaultvo</FONT
></EM
> and press the <EM
><FONT
>Submit</FONT
></EM
>
    button.  You should see a results page similar to below showing 
    7 software packages listed on the top and a table with the packages
    divided into 4 categories (compilers, grid services, math libraries, and
    scientific visualization).  Each package may contain the results of
    a software package version query (e.g., gcc) and/or unit test (e.g., java --
    unit test name is java_hello_world).  Almost all boxes should be empty
    indicating that the reports have not yet been received. 
        <DIV
CLASS="FIGURE"
><A
NAME="INCA.DEFAULT.RESULTS.EMPTY.FIG"
></A
><P
><B
>Figure 5. Default Inca results page without results.</B
></P
><P
><IMG
SRC="figures/ug-consumer-default-results-empty.png"
ALIGN="CENTER"></P
></DIV
>
    </P
><P
>    Refresh the page after a few minutes and you should begin to see more
    boxes filled in until it looks like the below figure.  If you do not see a
    results filled in, check the .log files in $INCA_DIST/var for
    <TT
CLASS="FILENAME"
>ERROR</TT
> or <TT
CLASS="FILENAME"
>Exception</TT
>. See 
    <A
HREF="#USERGUIDE-TROUBLESHOOT"
>Section 10</A
> for more help on debugging.  
    </P
><DIV
CLASS="FIGURE"
><A
NAME="INCA.DEFAULT.RESULTS.FIG"
></A
><P
><B
>Figure 6. Default Inca results page with results.</B
></P
><P
><IMG
SRC="figures/ug-consumer-default-results.png"
ALIGN="CENTER"></P
></DIV
><P
>Click on any red/green box to see the details of how the result was
    collected.  The below figure shows the details of the 
    <TT
CLASS="FILENAME"
>cluster.compiler.any.unit</TT
> reporter that compiles
    and executes a small hello world java program.  
        <DIV
CLASS="FIGURE"
><A
NAME="INCA.JAVA.FIG"
></A
><P
><B
>Figure 7. Default Inca results page with results.</B
></P
><P
><IMG
SRC="figures/ug-consumer-java-details.png"
ALIGN="CENTER"></P
></DIV
>
    </P
></LI
><LI
><A
NAME="QS-STEP7"
></A
><P
>View the Inca sample default configuration using the Inca GUI tool, incat (Inca Administration Tool).
      You can use incat to make changes to the default configuration (e.g., add
      a new resource to <EM
><FONT
>defaultvo</FONT
></EM
> or add new tests to
      <EM
><FONT
>TestSuiteLocal</FONT
></EM
>).  See <A
HREF="#USERGUIDE-INCAT"
>Section 6</A
> for more information about using incat.</P
><P
> Use the following command to start incat: <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca start incat -A localhost:6323 </PRE
></FONT
></TD
></TR
></TABLE
> </P
><P
> You should now see the Java GUI window appear on your local machine. 
      If you don't see Java GUI windows pop up like those in <A
HREF="#RETRIEVE.FIG"
>Figure 8</A
> and <A
HREF="#DEFAULT.FIG"
>Figure 9</A
>, 
      it is probable that X-Window forwarding is not set up correctly between the 
      machine where you installed Inca and your local machine.
        You can either configure X-Window forwarding, or you can start incat on a local machine as described in step <A
HREF="#QS-STEP8"
>8</A
>.
      </P
><P
>        <DIV
CLASS="FIGURE"
><A
NAME="RETRIEVE.FIG"
></A
><P
><B
>Figure 8. incat Agent Screen</B
></P
><P
><IMG
SRC="figures/incat_retrieve_agent.jpg"
ALIGN="CENTER"></P
></DIV
>
        Once incat has information from the agent, the following screen will display:
      </P
><DIV
CLASS="FIGURE"
><A
NAME="DEFAULT.FIG"
></A
><P
><B
>Figure 9. Default incat Screen</B
></P
><P
><IMG
SRC="figures/ug-incat-repositories.png"
ALIGN="CENTER"></P
></DIV
></LI
><LI
><A
NAME="QS-STEP8"
></A
><P
><STRONG
><FONT
COLOR="RED"
>THIS STEP IS OPTIONAL.</FONT
></STRONG
>  If you don't see Java GUI windows pop up like those in <A
HREF="#RETRIEVE.FIG"
>Figure 8</A
> and <A
HREF="#DEFAULT.FIG"
>Figure 9</A
>, you can use this step to install incat on a local machine. </P
><P
></P
><UL
><LI
><P
>            Copy the <TT
CLASS="FILENAME"
>incaInstall.sh</TT
> script to a local machine.
          </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% wget http://inca.sdsc.edu/releases/2.0beta/incaInstall.sh</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>            Install incat on a local machine:
          </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./incaInstall.sh $INCA_DIST incat</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>            Copy the incat key, certificate, and trusted directory from the original machine 
        to your local machine:
          </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% scp <STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/incatkey.pem $INCA_DIST/etc/; \
scp <STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/incatcert.pem $INCA_DIST/etc/;
scp "<STRONG
><FONT
COLOR="RED"
>orig.machine:$ORIG_INCA_DIST</FONT
></STRONG
>/etc/trusted/*" $INCA_DIST/etc/trusted/;</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>Change the agent key/cert to incat key/cert in the 
        <TT
CLASS="FILENAME"
>$INCA_DIST/etc/common/inca.properties</TT
> local file:
            <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>#---------------------------------------------------------------------------
# agent
#---------------------------------------------------------------------------

inca.agent.auth=true
inca.agent.password=
<STRONG
><FONT
COLOR="RED"
>inca.agent.cert=incatcert.pem
inca.agent.key=incatkey.pem</FONT
></STRONG
>
inca.agent.trusted=trusted</PRE
></FONT
></TD
></TR
></TABLE
>
          </P
></LI
><LI
><P
> Start the incat component on a local machine with the agent hostname from the original machine: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca start incat -A <STRONG
><FONT
COLOR="RED"
>ORIGHOST</FONT
></STRONG
>:6323 &#38;</PRE
></FONT
></TD
></TR
></TABLE
></LI
></UL
></LI
></OL
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-ADVANCED-CONFIG"
>5. Advanced Configuration</A
></H2
><P
>This section will describe advanced configuration options (e.g. 
installing components in non-default 
locations, changing inca.properties and other defaults).</P
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="POSTGRES"
>5.1. Using Postgres as DB Backend</A
></H3
><P
></P
><UL
><LI
><P
>Stop the depot 
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca stop depot</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Edit $INCA_DIST/etc/hibernate.properties</P
><P
></P
><UL
><LI
><P
>Comment out the first 5 lines which specifies for hibernate to use 
hsql as its backend database: 
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>#hibernate.dialect=org.hibernate.dialect.HSQLDialect 
#hibernate.connection.driver_class=org.hsqldb.jdbcDriver 
#hibernate.connection.url=jdbc:hsqldb:test 
#hibernate.connection.username=sa 
#hibernate.connection.password=</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Uncomment the second block of lines 8-13 which specifies for 
hibernate to use postgres:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
># Settings for a local PostgreSQL database. 
hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect 
hibernate.query.substitutions=yes 'Y', no 'N' 
hibernate.connection.driver_class=org.postgresql.Driver 
hibernate.connection.url=jdbc:postgresql:test 
hibernate.connection.username=test 
hibernate.connection.password=</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Replace the value "jdbc:postgresql:test" for property 
"hibernate.connection.url" on line 11 with the following (where "hostname" is 
the FQDN of the host where postgres is installed and "username" is the username to 
connect to the postgres DB):
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>hibernate.connection.url=jdbc:postgresql://hostname/username</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Replace the value "test" for property 
"hibernate.connection.username" on line 12 with the postgres 
username:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>hibernate.connection.username=username</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></UL
></LI
><LI
><P
>Download the postgres jdbc jar file pg74.216.jdbc3.jar 
to your $INCA_DIST/lib directory:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST/lib 
% wget http://inca.sdsc.edu/workshop/pg74.216.jdbc3.jar </PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Initialize the depot (set up the Inca tables):
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST; ./bin/inca depot -d</PRE
></FONT
></TD
></TR
></TABLE
>
You should see something like:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>Initializing c3p0 pool... 
... 
Database Initialization Completed</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Start the depot 
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./bin/inca start depot</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT"
>6. Administering Inca with incat</A
></H2
><P
>  Inca provides a graphical administration tool, named incat, that allows you
  to configure your deployment.  Using incat, you can specify the repositories
  from which Inca should retrieve reporters, the hosts where you wish to
  run reporters, and which reporters you wish to run on each host.
  <P
><IMG
SRC="figures/arch-incat.jpg"
ALIGN="CENTER"></P
>
  </P
><P
>  The simplest way to run incat is via the inca command line tool in $INCA_DIST: "./bin/inca
  start incat".  You can connect incat to a running Inca Agent via the
  -A option, e.g., "./bin/inca start incat -A localhost:6323".
  </P
><P
>  As mentioned in the <A
HREF="#QS-STEP5"
>Quick Start guide</A
>, you
  can use the inca command line tool to install a default Inca configuration.
  The discussion below describes how you would use incat to specify the same
  configuration.  Before continuing, use the inca script to start both a Depot
  and an Agent on your host.
  </P
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-REPOS"
>6.1. Repositories</A
></H3
><P
><IMG
SRC="figures/ug-incat-repositories.png"
ALIGN="CENTER"></P
><P
>  incat begins by showing the panel for Inca reporter repositories.  The three
  sections of this panel display the list of repositories you've specified,
  the list of reporters contained within those repositories, and property
  information for the currently-selected reporter.  Buttons in the Repositories
  section allow you to add and delete repositories from your list.  If your
  list contains multiple repositories, a checkbox in the Reporters section
  determines whether the reporter list shows reporters from all repositories or
  only from the selected one.  Finally, pressing the Show button in the
  Reporters section will open a text window that contains the source code of
  the currently-selected reporter.
  </P
><P
>  The default Inca configuration retrieves reporters from the Inca project
  repository.  To add this repository to your list, press the Add button in the
  Repositories section, enter the URL "http://inca.sdsc.edu/repository/latest"
  in the pop-up window that appears, then press the OK button.  Within a few
  seconds you should see the repository URL appear in the Repositories list, a
  set of reporters in the Reporters list, and properties for the first reporter
  in the Reporter Properties list.  If you like, you can select reporters in
  the Reporters list and display their source code by pressing the Show button.
  (Double-clicking the name in the reporter list accomplishes the same thing.)
  </P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-RESOURCES"
>6.2. Resources</A
></H3
><P
><IMG
SRC="figures/ug-incat-resource-configuration.png"
ALIGN="CENTER"></P
><P
>  Pressing the Resource Configuration tab near the top of the incat window
  takes you to incat's resource specification panel.  Here you can enter and
  edit information about the hosts on which you want Inca to run reporters.
  The sections of this panel show resource groups (sets of hosts) that you've
  defined, a set of macros that you can use when defining reporter series to
  run on a particular resource group, and a list of hosts that are included in
  the selected resource group.  Buttons in the Resource Group section allow you
  to add, edit, and delete resource groups, and a similar set in the Macros
  section allow you to add, edit, and delete macros associated with the
  currently-selected resource group.
  </P
><P
>  The default Inca configuration defines two resource groups--one that
  specifies the host where the Inca Agent will launch a new Reporter Manager (localhost) and a container group that
  can be extended to include both localhost and any others that you define (e.g. other hosts running Reporter Managers).  To
  define these in incat, press the Add button in the Resource Groups section to
  open the resource group edit dialog.
  </P
><P
><IMG
SRC="figures/ug-incat-resource-dialog.png"
ALIGN="CENTER"></P
><P
>  In the Group Name text box, enter the name "siteA" as a nickname for the machine the Reporter Manager client runs on (this name choice is
  arbitrary; "agentHost" or "local" would also work).  The Members text
  box specifies the hosts that are in this resource group; for this group,
  enter either "localhost" or the DNS name of the host where the Reporter Manager client will run.  The Equivalent checkbox underneath the Members text box
  indicates that Inca should treat the hosts in this group as a single host,
  only running reporters on one of them.  This is most often useful when a
  single DNS name maps to multiple hosts (e.g., multiple login nodes for a
  batch system).  In this case, leave the box unchecked.
  </P
><P
>  Select "local" in the Access Method pull-down list.  This indicates that the
  Inca Agent can access this host directly without using either Globus or ssh
  (i.e., it's the same host where the Agent is running).
  </P
><P
>  If you enter a path in the Install Directory text box, Inca will install the
  Reporter Manager code in that directory; otherwise, it will use a default
  path (~/incaReporterManager).  Proxy information isn't needed for this resource group, so leave the
  other text boxes blank.
  </P
><P
>  Press OK to complete entry of this resource group.  incat will close the
  resource group edit dialog and will display siteA in the Resource Groups
  section of the Resource Configuration panel.
  </P
><P
><IMG
SRC="figures/ug-incat-resource-dialog2.png"
ALIGN="CENTER"></P
><P
>  Press the Add button again to add a second resource group.  Give this one
  the name "defaultvo" and enter "siteA" in the Members text box.  This tells
  incat that any hosts in the "siteA" group (localhost, in this case) are also
  part of the defaultvo group.  If you defined other groups, "siteB", "siteC",
  etc., you could include these in defaultvo by listing them in the Members
  text box, separated by spaces.  Press OK to complete entry of this resource
  group.  Select siteA, then defaultvo in the Resource Groups list and notice
  that the Members panel lists localhost as a member of both.
  </P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-SUITES"
>6.3. Suites</A
></H3
><P
><IMG
SRC="figures/ug-incat-suites.png"
ALIGN="CENTER"></P
><P
>  Pressing the Suites tab near the top of the incat window takes you to incat's
  suite/series specification panel.  Here you specify the reporters you want to
  run, the resource groups to run them on, how frequently to run them, and the
  arguments to use when running them.
  </P
><P
>  A suite groups a set of reporter series.  Suites are largely a convenience
  for organizing related series, and the decision as to whether to place all
  your series into a single suite or to divide them into multiple suites is up
  to you.  One consideration is that the Inca Consumer uses suites as its
  primary structure for organizing the display of reporter results, so
  organizing related series into suites may make the Consumer web pages more
  readable.
  </P
><P
>  The default Inca configuration defines a single suite named TestSuiteLocal
  that contains eight series.  Press the Add button in the Suites section of
  the panel, enter "TestSuiteLocal" in the pop-up window, then press the OK
  button.  You're now ready to add series to this new suite.  Press the Add
  button in the Series section to open the incat series dialog.
  </P
><P
><IMG
SRC="figures/ug-incat-series-dialog.png"
ALIGN="CENTER"></P
><P
>  The top half of the series dialog contains basic information about reporter
  execution--the name and version of the reporter, the resource group to run it
  on, what values to pass in the command line arguments, and how often to run.
  For this first series, scroll down to select the reporter
  "cluster.math.atlas.version" and leave the "Use Latest Version" radio button
  selected (the other choice, "Use Version 1.4 Only", indicates that your
  series would continue to run the same version of the reporter even if an
  updated version became available).  Because both defaultvo and siteA refer to
  the host where the Inca Agent is running, you can select either of them in
  the Resource Group list.  In the Arguments section, leave the cc (compiler)
  argument with its default value, "cc", and leave the dir argument blank,
  which will instruct the reporter to search a set of common directories for
  the atlas installation.  Use the pull-down menu to set the log argument to 3;
  this will cause any error, warning, and system-level log messages generated
  by the reporter to be included in its report.  Finally, use the pull-down
  menus in the frequency section to indicate that the reporter should run every
  10 minutes.  When you do this, the contents in the text box to the right
  changes to "*/10 * * * *".  This is crontab syntax (see the section 5 man
  page) for once every 10 minutes.  If you're familiar with crontab, you can
  enter values in the text box directly rather than using the pull-down menus.
  </P
><P
>  The bottom half of the series dialog allows you to supply optional
  customization information for your series.  You can supply a descriptive
  name for your series in the Nickname text box, and the Inca Consumer will
  include it as part of its display.  The nickname defaults to the name of the
  reporter; for this series, enter "atlas_version" as the value.  The context
  string allows you to specify how the reporter should be run by entering sh
  code either before or after "cluster.math.atlas.version -args" in the text
  box.  For example, you could run this reporter niced by entering "nice -9 "
  at the beginning of the box.  For this series, leave the text box unchanged.
  The limits section allows you to set CPU time, wall clock time, and memory
  limits on the reporter.  If the reporter exceeds any limits you set, the Inca
  Reporter Manager will terminate its execution and send an error report to the
  Inca Depot.  The bottommost two text boxes in the series dialog allow you to
  test the output of the reporter and send email if the test fails.  This is
  covered in <A
HREF="#USERGUIDE-INCAT-COMPARISON"
>Section 6.7</A
> below; for this series leave these boxes blank.  Press the
  OK button, and incat will close the series dialog box and add the series to
  the Series list in the suite/series specification panel.
  </P
><P
>  The other seven series in default Inca configuration are composed similarly
  to the first one.  Press the Add button in the series section for each of
  them, then set the values in the series dialog as specified in the table
  below.  Set the log argument for each series to 3 and the frequency to 10
  minutes.
  </P
><DIV
CLASS="TABLE"
><A
NAME="AEN318"
></A
><P
><B
>Table 1. Default Configuration Series</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><THEAD
><TR
><TH
><P
>Reporter</P
></TH
><TH
><P
>Nickname</P
></TH
><TH
><P
>Arguments</P
></TH
></TR
></THEAD
><TBODY
><TR
><TD
><P
>cluster.compiler.gcc.version</P
></TD
><TD
><P
>gcc_version</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>cluster.security.openssl.version</P
></TD
><TD
><P
>openssl_version</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>cluster.interactive_access.openssh.version</P
></TD
><TD
><P
>openssh_version</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>cluster.interactive_access.openssh.unit</P
></TD
><TD
><P
>openssh_to_localhost</P
></TD
><TD
><P
>host: localhost; login: inca</P
></TD
></TR
><TR
><TD
><P
>viz.lib.vtk-nvgl.version</P
></TD
><TD
><P
>vtk-nvgl_version</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>viz.lib.chromium.version</P
></TD
><TD
><P
>chromium_version</P
></TD
><TD
>&nbsp;</TD
></TR
><TR
><TD
><P
>cluster.compiler.any.unit</P
></TD
><TD
><P
>java_hello_world</P
></TD
><TD
><P
>compiler: javac; lang: java</P
></TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-COMMITS"
>6.4. Committing/Saving</A
></H3
><P
>  Your Inca deployment configuration is now complete.  At this point, it's a
  good idea to use the Save As option in incat's File menu to write the
  configuration to a file.  That way, you have a local copy of the configuration
  that you can later modify.  The file is formatted XML; if you're curious, you
  can read through it to see how incat represents the information you've
  entered.
  </P
><P
>  Although your configuration is complete, it's not yet active.  To tell Inca
  to begin running reporters, you need to use incat to send your configuration
  to your Inca Agent.  If you started incat with the --agent argument, then
  you're already connected to your Agent.  Otherwise, use the Connect option in
  incat's Agent menu to establish a connection.  Once you're connected, you can
  use the Commit option in the Agent menu to send the configuration to the
  Agent.  In response, the Agent will install the Inca Reporter Manager code on
  the host specified in incat's "Resource Configuration" panel and begin running the reporters you specified in the "Suite Series" panel.
  </P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-REMOTE"
>6.5. Other Resource Options</A
></H3
><DIV
CLASS="SECTION"
><H4
CLASS="SECTION"
><A
NAME="ACCESS-METHODS"
>6.5.1. Resource Access Methods</A
></H4
><P
>  By default, the Agent starts a Reporter Manager client on localhost (the resource group with localhost will have 
 the "local" access method selected in incat).  Reporter Managers can be started with the following 
 access methods:
  </P
><P
></P
><UL
><LI
><P
>manual:</P
><P
>  Entering a manual resource group indicates that you want complete, direct
  control over Inca execution on the group.  For a manual resource group you must
  start the Reporter Manager on the command line and restart it any time
  you want to change the reporter series configuration for the group.  The Agent will NOT automatically start a 
 Reporter Manager for a manual resource as it will for local, ssh, or globus2 resources.
  </P
></LI
><LI
><P
>local:</P
><P
>  The Agent starts a Reporter Manager on the same machine where the Agent is already running (localhost).  
  </P
></LI
><LI
><P
>ssh:</P
><P
>  The Agent starts a Reporter Manager on a remote machine using ssh to access the remote machine. 
  Reporter Manager files are copied from the Agent to the remote machine using sftp.
  For ssh resource groups, incat provides text boxes for you to enter the login
  id, password, and path to the ssh key file on the Agent machine.  For security purposes, incat
  echoes asterisks for the password and encrypts it when you save the
  configuration to a file.
  </P
></LI
><LI
><P
>globus2:</P
><P
>  The Agent starts a Reporter Manager on a remote machine using globus to access the remote machine. 
  Reporter Manager files are copied from the Agent to the remote machine using GridFtp.
  When you select globus2 in the Access Method pull-down, incat provides text
  boxes for you to enter contact information for the resource's Globus Gram
  and GridFtp servers.  If you leave these boxes blank, Inca defaults to ports
  2119 and 2811, respectively, for the first host in the resource group's member
  list.  Access to Globus hosts requires an active Globus proxy on the Agent's
  host.  You can either create a manual proxy on the Agent machine before starting, or you can
  store a proxy on a myproxy server and complete the four incat proxy dialog boxes (see below) so
  that the Agent can obtain one as needed.
  </P
></LI
></UL
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="PROXIES"
>6.5.2. Proxies</A
></H4
><P
>For convenience, the Inca framework can be used to retrieve a proxy for the globus2 access method or 
for reporters than require an active proxy.  Reporters that require a proxy should use the Inca::Reporter::GridProxy 
module described in <A
HREF="#REPORTER-API"
>Section 8.2.3</A
>.  </P
><P
>Before configuring Inca to retrieve proxies, first store a proxy on a myproxy server.  For information 
about setting up a myproxy server or storing proxies on a server, please see 
<A
HREF="http://grid.ncsa.uiuc.edu/myproxy/"
TARGET="_top"
>the official myproxy documentation</A
>.</P
><P
>The Agent can automatically 
retrieve a proxy from a myproxy server if the proxy information is defined in incat as follows:</P
><P
><IMG
SRC="figures/incat-proxy.jpg"
ALIGN="CENTER"></P
><P
>The dialog boxes are the hostname of the myproxy server, the username and password used to store the proxy, and the lifetime in hours that the agent should retrieve a proxy for (the default is 12 hours).</P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-MACROS"
>6.6. Using Resource Macros</A
></H3
><P
>  Resource macros provide a shorthand for defining multiple, similar series.
  For example, suppose you wanted to add three series to the configuration
  defined above to measure the ping time to three different hosts, named
  blue.ufo.edu, green.ufo.edu, and red.ufo.edu.  One approach would be to
  define a series for the blue, use the Make Copy button in the Series section
  of the Suites panel to make two copies, then modify them to ping green and
  red.
  </P
><P
>  A better approach is to use a macro for the host names and let Inca replicate
  the series for you.  In the Resource Configuration panel, click on siteA in
  the Resource Group section.  Next, press the Add button beneath the Macros
  section.  This opens a dialog box that allows you to enter the name and
  value(s) of a macro associated with the current resource group.  Enter
  "targets" in the Macro Name text box and "blue green red" in the Macro
  Value(s) text box, then press OK.  The definition of the targets macro now
  appears in the Macros section of the Resource Configuration panel.
  </P
><P
><IMG
SRC="figures/ug-incat-macrodef.png"
ALIGN="CENTER"></P
><P
>  To make use of the macro you've defined, click the Suites tab, then press the
  Add button underneath the Series section to open the series edit dialog.  In
  the dialog, set the reporter to grid.benchmark.performance.ping and the
  resource group to siteA.
  </P
><P
>  In the host text box in the Arguments section of the dialog, enter
  "@targets@.ufo.edu".  Macro references in incat are indicated by placing a
  "@" before and after the macro name.  When the Inca Agent encounters a macro
  reference in a series, it makes one copy of the series for each value of the
  macro.  Since the targets macro has three values--blue, green, and red--the
  Inca Agent will make three copies of this series, substituting a single value
  for the macro reference in each.  In this case that means that you'll have
  one series with a host argument of "blue.ufo.edu", one with a host argument
  of "green.ufo.edu", and one with a host argument of "red.ufo.edu".
  </P
><P
>  The inca web pages use the series nickname when displaying series results.
  If you leave the series nickname with its default value, the name of the
  reporter, then all three series will have the same nickname.  Instead, you
  can enter "ping_to_@targets@" in the nickname text box.  The Inca Agent will
  expand this reference in parallel with the reference in the host argument, so
  your three series will have the nicknames ping_to_blue, ping_to_green, and
  ping_to_red, respectively.
  </P
><P
><IMG
SRC="figures/ug-incat-macrouse.png"
ALIGN="CENTER"></P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="USERGUIDE-INCAT-COMPARISON"
>6.7. Series Comparison and Notification</A
></H3
><P
>  For a particular series, the Inca system by default reports only whether or
  not the series reporter was able to execute successfully--whether a version
  reporter was able to determine a package version, a unit reporter was able to
  run a program, etc.  Using Inca's comparison and notification feature, you
  can refine a series to define success more precisely and to receive
  notification from Inca when a series reporter detects a problem.  The bottom
  two text boxes of the series edit dialog provide access to Inca's comparison
  and notification feature.
  </P
><P
><IMG
SRC="figures/ug-incat-comparison.png"
ALIGN="CENTER"></P
><P
>  In the Comparison text box, you can enter a boolean expression that Inca will
  use to test the output of the series reporter.  When the expression
  evaluates to false, Inca flags it as a failure and the Consumer will indicate
  an error on the web page.
  </P
><P
>  The expression can test the content of the report body, the content of the
  report error message, or the value of any symbols defined in the report body
  by &#60;ID&#62; tags.  The expression may use any of the boolean operators
  &#60;, &#60;=, &#62;, &#62;=, ==, and !=, plus perl's pattern match (=~) and
  mismatch (!~) operators.  One simple test would be "body =~ /./", which would
  test whether the report body contained any characters.  Tests can be joined
  together by the &#38;&#38; and || operators.  Using these, you could ignore
  an expected, minor error with the test
  "body =~ /./ || errorMessage == 'Try again later'".
  </P
><P
>  As mentioned above, you can include symbols defined in the report body in
  your tests.  The Inca system uses the content of any subsequent tag as the
  symbol value.  For example, the body of the output of the gcc version
  reporter might be
  </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>  &#60;body&#62;
    &#60;package&#62;
      &#60;ID&#62;gcc&#60;/ID&#62;
      &#60;version&#62;3.1&#60;/version&#62;
    &#60;/package&#62;
  &#60;/body&#62;
  </PRE
></FONT
></TD
></TR
></TABLE
><P
>  Here, Inca will use "3.1" as the value of the symbol "gcc".  With this
  output, the comparison test "gcc &#62;= 3.0" would succeed, while the
  comparison "gcc == 3.0" would fail.  If the report body contains an
  &#60;ID&#62; tag with no subsequent tag, the value of the symbol is defined
  to be "".
  </P
><P
>  If you enter an email address into the "Notification Email" text box, Inca
  will send a message whenever the success/failure status of the series
  changes.  Whenever the reporter in a previously-successful series fails, Inca
  will construct and mail a message describing the failure.  Similarly,
  whenever a reporter succeeds in a series that had been failing, Inca will
  send an email noting that the previous failure has been fixed.  Finally, any
  time the reporter in a failing series indicates that the nature of the
  problem has changed (e.g., the error message changes), Inca will send an
  email to note the difference.
  </P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-CONSUMER"
>7. Data Display (Data Consumers)</A
></H2
><P
>The data that the Inca depot stores, as with all database data, can be displayed in many ways.  A data consumer is anything that 
retrieves data from the depot and displays it (e.g. a JSP, sql query, CGI, etc.).</P
><P
><IMG
SRC="figures/arch-consumer.jpg"
ALIGN="CENTER"></P
><P
>  Data consumers can query the Inca depot to produce current and historical reports and graphs 
or customized status information.  The Inca depot comes with two pre-defined queries: 
<P
></P
><OL
TYPE="1"
><LI
><P
>given instance and config IDs for a series, returns XML like the following (the results from executing
a reporter at a particular point in time)
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>&#60;reportDetails&#62; 
  &#60;suiteId&#62;1&#60;/suiteId&#62;
  &#60;seriesConfigId&#62;5&#60;/seriesConfigId&#62;
  &#60;seriesId&#62;5&#60;/seriesId&#62;
  &#60;reportId&#62;1&#60;/reportId&#62;
  &#60;instanceId&#62;73&#60;/instanceId&#62;
  &#60;seriesConfig&#62;
     ...    
    &#60;nickname&#62;java_hello_world&#60;/nickname&#62;     
     ...
  &#60;/seriesConfig&#62;
  &#60;report&#62;
     ...
  &#60;/report&#62;
  &#60;sysusage&#62;
     ...
  &#60;/sysusage&#62;
  &#60;stderr/&#62;
&#60;/reportDetails&#62;</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>given a suite name, returns XML like the following (the latest report summaries for all of the series in the particular suite)
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>&#60;reportSummary&#62;
  &#60;hostname&#62;Computer.local&#60;/hostname&#62;
  &#60;uri&#62;http://repository/compiler.any.unit&#60;/uri&#62;
  &#60;nickname&#62;java_hello_world&#60;/nickname&#62;
  &#60;seriesConfigId&#62;5&#60;/seriesConfigId&#62;
  &#60;instanceId&#62;73&#60;/instanceId&#62;
  &#60;gmt&#62;2006-12-20T16:00:11.000-08:00&#60;/gmt&#62; 
  &#60;body&#62;
    &#60;package&#62;
      &#60;ID&#62;openssl&#60;/ID&#62;
      &#60;version&#62;0.9.7i&#60;/version&#62;
    &#60;/package&#62;  
  &#60;/body&#62;  
&#60;/reportSummary&#62;
&#60;reportSummary&#62;...&#60;/reportSummary&#62;
&#60;reportSummary&#62;...&#60;/reportSummary&#62;</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></OL
></P
><P
>The default data consumer is a <A
HREF="http://www.mortbay.org/"
TARGET="_top"
>Jetty</A
> served JSP page (<A
HREF="http://localhost:8080/index.jsp"
TARGET="_top"
>http://localhost:8080/index.jsp</A
>) that allows its user to 
choose "suiteName" and "resourceID" parameters for a 
second JSP page called xslt.jsp.  The xslt.jsp script retrieves XML (partly from the second pre-defined query shown above) and formats it 
with an XSL stylesheet if the script is passed the name of a stylesheet as an input parameter. The default data consumer redirects to the xslt.jsp script and adds an input parameter with an XSL stylesheet so the result is formatted html (i.e. index.jsp redirects to something like <A
HREF="http://localhost:8080/xslt.jsp?suiteName=TestSuiteLocal&#38;resourceID=defaultvo&#38;xmlFile=swStack.xml&#38;xsl=swStack.xsl"
TARGET="_top"
>http://localhost:8080/xslt.jsp?suiteName=TestSuiteLocal&#38;resourceID=defaultvo&#38;xmlFile=swStack.xml&#38;xsl=swStack.xsl</A
>).</P
><P
>To view the XML that is retrieved and formatted by the xslt.jsp script, remove its XSL parameter.  For example, <A
HREF="http://localhost:8080/xslt.jsp?suiteName=TestSuiteLocal&#38;resourceID=defaultvo&#38;xmlFile=swStack.xml"
TARGET="_top"
>http://localhost:8080/xslt.jsp?suiteName=TestSuiteLocal&#38;resourceID=defaultvo&#38;xmlFile=swStack.xml</A
> would produce something similar to: 

<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>&#60;combo&#62;

&#60;all2allSummaries xmlns="http://inca.sdsc.edu/dataModel/all2all_2.0"&#62;
  &#60;resources xmlns=""&#62;
    &#60;resource&#62;
      &#60;name&#62;siteA&#60;/name&#62;
      &#60;testSummaries&#62;
        &#60;testSummary&#62;
          &#60;name&#62;gridftp&#60;/name&#62;
          &#60;numSuccesses&#62;15&#60;/numSuccesses&#62;
          &#60;numAtFaultFailures&#62;0&#60;/numAtFaultFailures&#62;
          &#60;numNotAtFaultFailures&#62;1&#60;/numNotAtFaultFailures&#62;
          &#60;failures/&#62;
        &#60;/testSummary&#62;
        &#60;testSummary&#62;
          &#60;name&#62;gram&#60;/name&#62;
          &#60;numSuccesses&#62;13&#60;/numSuccesses&#62;
          &#60;numAtFaultFailures&#62;1&#60;/numAtFaultFailures&#62;
          &#60;numNotAtFaultFailures&#62;0&#60;/numNotAtFaultFailures&#62;
          &#60;failures&#62;
            &#60;failure&#62;
              &#60;nickname&#62;all2all:gram_to_siteA&#60;/nickname&#62;
              &#60;instanceId&#62;239352&#60;/instanceId&#62;
              &#60;seriesConfigId&#62;172057&#60;/seriesConfigId&#62;
            &#60;/failure&#62;
          &#60;/failures&#62;
        &#60;/testSummary&#62;
      &#60;/testSummaries&#62;
    &#60;/resource&#62;
  &#60;/resources&#62;
&#60;/all2allSummaries&#62;

&#60;suite&#62;
 &#60;reportSummary&#62;
  &#60;hostname&#62;host1.name&#60;/hostname&#62;
  &#60;uri&#62;http://repository/globus.unit.xio&#60;/uri&#62;
  &#60;nickname&#62;gt4-xio&#60;/nickname&#62;
  &#60;seriesConfigId&#62;115446&#60;/seriesConfigId&#62;
  &#60;instanceId&#62;118115&#60;/instanceId&#62;
  &#60;gmt&#62;2006-11-16T23:49:49.000-08:00&#60;/gmt&#62;
  &#60;body/&#62;
 &#60;/reportSummary&#62;
 &#60;reportSummary&#62;
  &#60;hostname&#62;host2.name&#60;/hostname&#62;
  &#60;uri&#62;http://repository/globus.unit.xio&#60;/uri&#62;
  &#60;nickname&#62;gt4-xio&#60;/nickname&#62;
  &#60;seriesConfigId&#62;115466&#60;/seriesConfigId&#62;
  &#60;instanceId&#62;219103&#60;/instanceId&#62;
  &#60;gmt&#62;2006-12-15T01:31:53.000-08:00&#60;/gmt&#62;
  &#60;body&#62;
    &#60;unitTest&#62;
      &#60;ID&#62;xioTest&#60;/ID&#62;
    &#60;/unitTest&#62;
  &#60;/body&#62;
 &#60;/reportSummary&#62;
&#60;/suite&#62;

&#60;resourceConfig&#62;
  &#60;resources&#62;
    &#60;resource&#62;
      &#60;name&#62;siteA&#60;/name&#62;
      &#60;macros&#62;
        &#60;macro&#62;
          &#60;name&#62;__regexp__&#60;/name&#62;
          &#60;value&#62;host.sitea.org&#60;/value&#62;
        &#60;/macro&#62;
      &#60;/macros&#62;
    &#60;/resource&#62;
  &#60;/resources&#62;
&#60;/resourceConfig&#62;

&#60;stack&#62;
    &#60;id&#62;Software and Services&#60;/id&#62;
    &#60;category&#62;
        &#60;id&#62;Math Libraries&#60;/id&#62;
        &#60;package&#62;
            &#60;id&#62;globus&#60;/id&#62;
            &#60;version&#62;4.0.1&#60;/version&#62;
            &#60;tests&#62;
                &#60;version&#62;
			     &#60;id&#62;gt4-version&#60;/id&#62;
		       &#60;/version&#62;
                &#60;unitalias&#62;
			     &#60;id&#62;gt4-xio&#60;/id&#62;
		       &#60;/unitalias&#62;
                &#60;unitalias&#62;
			     &#60;id&#62;all2all:gram_to_siteA&#60;/id&#62;
		       &#60;/unitalias&#62;
            &#60;/tests&#62;
        &#60;/package&#62;
    &#60;/category&#62;
&#60;/stack&#62;

&#60;/combo&#62;</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>The XML above can be broken down into the following sections:
<P
></P
><OL
TYPE="1"
><LI
><P
>all2allSummaries (cross-site test results calculated by the consumer): </P
><P
>The default installation doesn't include cross-site tests; this section will be empty unless the Inca admin creates all2all series in incat.  Cross-site, or "all to all", tests determine whether all resources in a Grid can reach all other resources (e.g. via gsissh, gram, gridftp).  To be included in cross-site test calculation, a series must 
be assigned a nickname like "all2all:x_to_y" in incat.  Cross-site failures are calculated differently than regular failures.  For example, resource A will not be assigned a failure trying to reach resource B if all other resources trying to reach resource B also fail (i.e. there is a problem with resource B not resource A).</P
></LI
><LI
><P
>suite (xslt.jsp "suiteName" parameter):</P
><P
>array of report summaries for the suite.  This part of the XML is retrieved from the pre-defined depot query that takes a suite name (from the 
xslt.jsp suiteName parameter) and returns summaries 
for the latest series instance in that suite.</P
></LI
><LI
><P
>resourceConfig (xslt.jsp "resourceID" parameter):</P
><P
>array of all resources within a given resource group (from the xslt.jsp resourceID parameter) and their macros. 
This part of the XML is retrieved from the agent.</P
></LI
><LI
><P
>extra xml (xslt.jsp "xmlFile" parameter):</P
><P
>XML from the file passed as the xslt.jsp xmlFile parameter.  The default file is $INCA_DIST/etc/common/swStack.xml, but any XML file in the $INCA_DIST/etc/common directory can be passed as the xslt.jsp xmlFile parameter and it will automatically be picked up by the data consumer.  
When new series are added in incat, add the new series nicknames to the swStack.xml file as in the figure below to add the series to the default page.
<P
><IMG
SRC="figures/consumer-editxml.jpg"
ALIGN="CENTER"></P
></P
></LI
></OL
></P
><P
>To change the XML to HTML transformation, either edit the default XSL stylesheet ($INCA_DIST/etc/swStack.xsl for the summary page or $INCA_DIST/etc/instance.xsl for the report detail pages), or pass another XSL file in the $INCA_DIST/etc directory as the xslt.jsp "xsl" parameter.  [ <A
HREF="http://www.w3schools.com/xsl/"
TARGET="_top"
>xsl tutorial</A
> ] </P
><P
>Change default CSS (Cascading Style Sheet) properties such as colors and fonts by editing the $INCA_DIST/var/jetty/webapp/css/inca.css file. [ <A
HREF="http://www.w3schools.com/css/"
TARGET="_top"
>css tutorial</A
> ]</P
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-REPORTERS"
>8. Reporters and Repositories</A
></H2
><P
>Inca reporters are executable programs and scripts, generally small, that test
and report the health and characteristics of a system.  The figure below 
illustrates a typical Inca installation where reporters are retrieved from a repository and sent to Reporter 
Managers on Grid resources by the Agent.  The Reporter Managers then execute the reporters based on series configuration from the 
Agent and send the XML reports to the Depot for storage.
  <P
><IMG
SRC="figures/arch-reporters.jpg"
ALIGN="CENTER"></P
></P
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="REPORTER-CMDLINE"
>8.1. Executing Reporters</A
></H3
><P
>Because they are executables, Inca reporters are independent of the rest of the Inca system.
Reporters can be executed manually from a command line or automatically as part of an Inca installation.  
Incorporating your own reporters into a running Inca installation requires only writing the reporters (<A
HREF="#REPORTER-WRITING"
>Section 8.2</A
>), 
including them in a repository (<A
HREF="#REPORTER-REPOSITORIES"
>Section 8.3</A
>), 
and configuring the repository's series using incat (<A
HREF="#USERGUIDE-INCAT"
>Section 6</A
>).  Most developers will execute reporters from the 
command line before adding them to their Inca installation.   After installing Inca, you can try executing some of the reporters that come
with the distribution from the command line:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% cd $INCA_DIST/Inca-Reporter-*/bin
% setenv PERL5LIB ../lib
% ./cluster.compiler.gcc.version </PRE
></FONT
></TD
></TR
></TABLE
>
You should now see XML output like that in <A
HREF="#REPORTER-OUTPUT"
>Section 8.2.2</A
>.</P
><P
>All Inca reporters must support the command line arguments listed in the table
below.  In addition, a reporter may support additional command line arguments
specific to that reporter's task.</P
><DIV
CLASS="TABLE"
><A
NAME="AEN470"
></A
><P
><B
>Table 2. Reporter Command Line Arguments</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><COL><THEAD
><TR
><TH
><P
>Argument</P
></TH
><TH
><P
>Valid Values</P
></TH
><TH
><P
>Default Value</P
></TH
><TH
><P
>Description</P
></TH
></TR
></THEAD
><TBODY
><TR
><TD
><P
>-help</P
></TD
><TD
><P
>yes|no</P
></TD
><TD
><P
>no</P
></TD
><TD
><P
>    Do not run the reporter; instead, print information on running it.  If
    the value of the verbose argument is 0, this information will be readable
    text; otherwise, it will be reporter XML.
    </P
></TD
></TR
><TR
><TD
><P
>-log</P
></TD
><TD
><P
>0-5|debug|error|info|system|warn</P
></TD
><TD
><P
>0</P
></TD
><TD
><P
>    Include reporter log messages in the reporter output.  The named argument
    values indicate specific types of log messages that should be included.  0
    indicates no log messages should be included; the other numeric values
    indicate error, warn, system, info, and debug messages, cumulatively.  For
    example, --log=2 indicates both error and warn messages should be included,
    while --log=4 includes error, warn, system, and info messages.
    </P
></TD
></TR
><TR
><TD
><P
>-verbose</P
></TD
><TD
><P
>0-2</P
></TD
><TD
><P
>1</P
></TD
><TD
><P
>    Determine what the reporter prints.  A verbose level of 0 indicates that
    the reporter prints only 'completed' or 'failed', depending on the outcome
    of its testing.  Verbose level 1 produces XML that reports the testing
    result, and verbose level 2 adds additional tags to this XML to give
    instructions on running the reporter.
    </P
></TD
></TR
><TR
><TD
><P
>-version</P
></TD
><TD
><P
>yes|no</P
></TD
><TD
><P
>no</P
></TD
><TD
><P
>    Do not run the reporter; instead, print its version number.
    </P
></TD
></TR
></TBODY
></TABLE
></DIV
><P
>Executing a reporter using different arguments:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>% ./cluster.compiler.gcc.version -log=3 
% ./cluster.compiler.gcc.version -help=yes -verbose=0
% ./cluster.compiler.gcc.version -version=yes</PRE
></FONT
></TD
></TR
></TABLE
></P
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="REPORTER-WRITING"
>8.2. Writing Reporters</A
></H3
><P
>Reporters can be written in any language as long as 
they output XML according to the schema described in <A
HREF="#REPORTER-SCHEMA"
>Section 8.2.1</A
>.  
New reporter developers may choose to write reporters in Perl since 
the Inca distribution includes sample Perl reporters and API modules (<A
HREF="#REPORTER-API"
>Section 8.2.3</A
>) 
for printing XML according to our schema.</P
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="REPORTER-SCHEMA"
>8.2.1. Reporter XML Schema</A
></H4
><P
>In order to promote interoperability between reporters, we define a
specification for how reporter output should be formatted.  Given the
wide acceptance and availability of tools for XML, the specification
requires that reporter output should be formatted using XML.  Furthermore, we
specify a basic schema that the XML should follow so
that we can handle the output in a general manner.   The goal of this schema
is to be flexible enough to express a wide variety of data.</P
><P
>Our approach is to require a number of XML fields which provide metadata about
the output and define one of the fields, body, to be abstract.  The body
field is a placeholder for the formatted output and can be replaced by any XML
 substitution group thereby allowing this schema to accommodate a large variety of output.  In
other words, the basic schema is like an abstract class and the substitution
groups provide for subclassing.  </P
><P
>The reporter schema is visualized in <A
HREF="#REPORTER-SCHEMA-FIG"
>Figure 10</A
>.
<DIV
CLASS="FIGURE"
><A
NAME="REPORTER-SCHEMA-FIG"
></A
><P
><B
>Figure 10. Inca Reporter Schema</B
></P
><P
><IMG
SRC="figures/reporter-schema.jpg"
ALIGN="CENTER"></P
></DIV
></P
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="REPORTER-OUTPUT"
>8.2.2. Reporter XML Output</A
></H4
><P
>Here is the output from the successful run of a typical Inca reporter.  The
content and meaning of the XML tags is described below.</P
><DIV
CLASS="FIGURE"
><A
NAME="SAMPLE-REPORT"
></A
><P
><B
>Figure 11. Example of Reporter Output</B
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>&#60;?xml version='1.0'?&#62;
&#60;inca:report xmlns:inca='http://inca.sdsc.edu/dataModel/report_2.1'&#62;
  &#60;gmt&#62;2006-11-17T17:35:40Z&#60;/gmt&#62;
  &#60;hostname&#62;jhayes-Computer.local&#60;/hostname&#62;
  &#60;name&#62;cluster.compiler.gcc.version&#60;/name&#62;
  &#60;version&#62;2&#60;/version&#62;
  &#60;workingDir&#62;/Users/jhayes/Inca/subversion/inca/trunk/devel/reporters/bin&#60;/workingDir&#62;
  &#60;reporterPath&#62;cluster.compiler.gcc.version&#60;/reporterPath&#62;
  &#60;args&#62;
    &#60;arg&#62;
      &#60;name&#62;help&#60;/name&#62;
      &#60;value&#62;no&#60;/value&#62;
    &#60;/arg&#62;
    &#60;arg&#62;
      &#60;name&#62;log&#60;/name&#62;
      &#60;value&#62;0&#60;/value&#62;
    &#60;/arg&#62;
    &#60;arg&#62;
      &#60;name&#62;verbose&#60;/name&#62;
      &#60;value&#62;1&#60;/value&#62;
    &#60;/arg&#62;
    &#60;arg&#62;
      &#60;name&#62;version&#60;/name&#62;
      &#60;value&#62;no&#60;/value&#62;
    &#60;/arg&#62;
  &#60;/args&#62;
  &#60;body&#62;
    &#60;package&#62;
      &#60;ID&#62;gcc&#60;/ID&#62;
      &#60;version&#62;3.3&#60;/version&#62;
    &#60;/package&#62;
  &#60;/body&#62;
  &#60;exitStatus&#62;
    &#60;completed&#62;true&#60;/completed&#62;
  &#60;/exitStatus&#62;
&#60;/inca:report&#62;</PRE
></FONT
></TD
></TR
></TABLE
></DIV
><P
>As shown in <A
HREF="#SAMPLE-REPORT"
>Figure 11</A
>, reporter output begins with an XML preamble and it surrounded by &#60;report&#62; tags.
A prefix with a tag name that references
http://inca.sdsc.edu/dataModel/report_2.1, which is the namespace that defines
the report schema, can also be used.</P
><P
>The following tags are defined within a &#60;report&#62;:</P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="FILENAME"
>gmt</TT
></DT
><DD
><P
>  the time the reporter ran (ISO 8601 format)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>hostname</TT
></DT
><DD
><P
>  host where reporter ran
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>name</TT
></DT
><DD
><P
>  reporter name
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>version</TT
></DT
><DD
><P
>  reporter version number
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>workingDir</TT
></DT
><DD
><P
>  directory where reporter execution begins
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>reporterPath</TT
></DT
><DD
><P
>  local path to reporter file
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>args</TT
></DT
><DD
><P
>	args must contain an arg name/value entry for every argument the reporter supports, 
	including those for which the reporter supplies a default value (help, log, verbose, version)
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>log</TT
></DT
><DD
><P
>    OPTIONAL TAG (not shown in <A
HREF="#SAMPLE-REPORT"
>Figure 11</A
> report). Log entries produced by the reporter.  This tag contains one or more
&#60;debug&#62;, &#60;error&#62;, &#60;info&#62;, &#60;system&#62;, and/or &#60;warn&#62;
tags, each of which gives the text of the message and the time it was produced.
Here is a typical example of a log section:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>  &#60;log&#62;
    &#60;system&#62;
      &#60;gmt&#62;2006-11-17T18:28:10Z&#60;/gmt&#62;
      &#60;message&#62;grid-proxy-info 2&#38;gt;&#38;amp;1&#60;/message&#62;
    &#60;/system&#62;
    &#60;debug&#62;
      &#60;gmt&#62;2006-11-17T18:28:10Z&#60;/gmt&#62;
      &#60;message&#62;Checking for grid proxy: Result of command "grid-proxy-info":
         sh: line 1: grid-proxy-info: command not found
      &#60;/message&#62;
    &#60;/debug&#62;
    &#60;error&#62;
      &#60;gmt&#62;2006-11-17T18:28:10Z&#60;/gmt&#62;
      &#60;message&#62;ERROR: Valid proxy needed for file transfer.&#60;/message&#62;
    &#60;/error&#62;
  &#60;/log&#62;</PRE
></FONT
></TD
></TR
></TABLE
>
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>body</TT
></DT
><DD
><P
>    The body tag contains the results of the reporter testing.  The only
requirement for the contents of this tag is that they must be well-formed
XML--tags balanced and no extraneous &#60;, &#62;, and &#38; characters.  <A
HREF="#SAMPLE-REPORT"
>Figure 11</A
>
shows the conventional body for version reporters.
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>exitStatus</TT
></DT
><DD
><P
>Includes the boolean &#60;completed&#62; tag, indicating whether or not the reporter
successfully completed its testing, and the optional &#60;errorMessage&#62; tag,
which contains a string indicating why the reporter failed to complete.
  </P
></DD
><DT
><TT
CLASS="FILENAME"
>help</TT
></DT
><DD
><P
>    OPTIONAL TAG (not shown in <A
HREF="#SAMPLE-REPORT"
>Figure 11</A
> report).  The help tag describes the reporter and how to run it.  Contents include
the reporter name, version, description, and url, detailed descriptions of each
argument, and an optional list of dependencies that the reporter has on other
packages.  For example, here is the &#60;help&#62; section for the gcc version
reporter.
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>  &#60;help&#62;
    &#60;ID&#62;help&#60;/ID&#62;
    &#60;name&#62;cluster.compiler.gcc.version&#60;/name&#62;
    &#60;version&#62;2&#60;/version&#62;
    &#60;description&#62;Reports the version of gcc&#60;/description&#62;
    &#60;url&#62;http://gcc.gnu.org&#60;/url&#62;
    &#60;argDescription&#62;
      &#60;ID&#62;help&#60;/ID&#62;
      &#60;accepted&#62;no|yes&#60;/accepted&#62;
      &#60;description&#62;display usage information (no|yes)&#60;/description&#62;
      &#60;default&#62;no&#60;/default&#62;
    &#60;/argDescription&#62;
    &#60;argDescription&#62;
      &#60;ID&#62;log&#60;/ID&#62;
      &#60;accepted&#62;[012345]|debug|error|info|system|warn&#60;/accepted&#62;
      &#60;description&#62;log message types included in report&#60;/description&#62;
      &#60;default&#62;0&#60;/default&#62;
    &#60;/argDescription&#62;
    &#60;argDescription&#62;
      &#60;ID&#62;verbose&#60;/ID&#62;
      &#60;accepted&#62;[012]&#60;/accepted&#62;
      &#60;description&#62;verbosity level (0|1|2)&#60;/description&#62;
      &#60;default&#62;1&#60;/default&#62;
    &#60;/argDescription&#62;
    &#60;argDescription&#62;
      &#60;ID&#62;version&#60;/ID&#62;
      &#60;accepted&#62;no|yes&#60;/accepted&#62;
      &#60;description&#62;show reporter version (no|yes)&#60;/description&#62;
      &#60;default&#62;no&#60;/default&#62;
    &#60;/argDescription&#62;
    &#60;dependency&#62;
      &#60;ID&#62;Inca::Reporter&#60;/ID&#62;
    &#60;/dependency&#62;
    &#60;dependency&#62;
      &#60;ID&#62;Inca::Reporter::Version&#60;/ID&#62;
    &#60;/dependency&#62;
  &#60;/help&#62;</PRE
></FONT
></TD
></TR
></TABLE
>
  </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H4
CLASS="SECTION"
><A
NAME="REPORTER-API"
>8.2.3. Reporter APIs</A
></H4
><P
>The Inca release includes a set of <A
HREF="http://inca.sdsc.edu/releases/2.0betalatest/html/"
TARGET="_top"
>Perl modules</A
> that make it easier to
develop reporters that produce output as shown in <A
HREF="#REPORTER-OUTPUT"
>Section 8.2.2</A
>
 and conform to the schema described in <A
HREF="#REPORTER-SCHEMA"
>Section 8.2.1</A
>.  
The following are a list of modules and their purpose (click on module names for manpages):</P
><P
></P
><OL
TYPE="1"
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.0betalatest/html/Inca/Reporter.html"
TARGET="_top"
>Inca::Reporter</A
></P
><P
>This module is the general reporter API and is the base class for all types of reporters.
Inca::Reporter automates determination of hostname, gmt, reporter name, etc.,  handles command-line parsing, 
provides an interface for log messages, and handles XML generation.</P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.0betalatest/html/Inca/Reporter/GlobusUnit.html"
TARGET="_top"
>Inca::Reporter::GlobusUnit</A
></P
><P
>The Inca::Reporter::GlobusUnit module is used for Globus unit tests.  This package 
provides methods for running Globus jobs.</P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.0betalatest/html/Inca/Reporter/GridProxy.html"
TARGET="_top"
>Inca::Reporter::GridProxy</A
></P
><P
>The Inca::Reporter::GridProxy package is a pseudo-module indicating that a reporter requires a proxy credential in order to execute.  The following is an example of a reporter that requires a proxy:
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>#!/usr/bin/env perl

use strict;
use warnings;
use Inca::Reporter::SimpleUnit;

my $reporter = new Inca::Reporter::SimpleUnit(
  name =&#62; 'grid.middleware.globus.unit.proxy',
  version =&#62; 2,
  description =&#62; 'Verifies that user has valid proxy',
  url =&#62; 'http://www.globus.org/security/proxy.html',
  unit_name =&#62; 'validproxy'
);
$reporter-&#62;addDependency( "Inca::Reporter::GridProxy" );
$reporter-&#62;processArgv(@ARGV);

# check to see if proxy has enough time left
$reporter-&#62;log( 'info', "X509_USER_PROXY=$ENV{X509_USER_PROXY}" );
my $output = $reporter-&#62;loggedCommand('grid-proxy-info -exists -hours 4 2&#62;&#38;1');
if( $? != 0 ) {
  $reporter-&#62;unitFailure("grid-proxy-info failed: $! $output");
} else {
  $reporter-&#62;unitSuccess();
}
$reporter-&#62;print();</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.0betalatest/html/Inca/Reporter/Performance.html"
TARGET="_top"
>Inca::Reporter::Performance</A
></P
><P
>The Inca::Reporter::Performance module is used to gather system performance metrics.  This package 
defines a common &#60;body&#62; schema for system/software performance metric reporters and produces a collection of benchmarks, each a set of 
parameters (name/value) and statistics (name/value/units). For a single benchmark, the <A
HREF="http://inca.sdsc.edu/releases/2.0betalatest/html/Inca/Reporter/Performance/Benchmark.html"
TARGET="_top"
>Inca::Test::Reporter::Performance::Benchmark</A
> module is also available.</P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.0betalatest/html/Inca/Reporter/SimpleUnit.html"
TARGET="_top"
>Inca::Reporter::SimpleUnit</A
></P
><P
>The Inca::Reporter::SimpleUnit module is used for software unit tests.  This package 
defines a common &#60;body&#62; schema for unit test reporters and provides methods for recording results of unit tests.</P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.0betalatest/html/Inca/Reporter/Usage.html"
TARGET="_top"
>Inca::Reporter::Usage</A
></P
><P
>The Inca::Reporter::Usage module is used for creating simple usage reports.</P
></LI
><LI
><P
><A
HREF="http://inca.sdsc.edu/releases/2.0betalatest/html/Inca/Reporter/Version.html"
TARGET="_top"
>Inca::Reporter::Version</A
></P
><P
>The Inca::Reporter::Version module is used for reporting software versions.  This package 
defines a common &#60;body&#62; schema for version reporters,  
offers support for subpackage versions, and provides convenience methods for common ways of 
determining version.</P
></LI
></OL
><P
>The following is the Perl code for a reporter that produces output like <A
HREF="#SAMPLE-REPORT"
>Figure 11</A
>.  This reporter 
uses the Inca::Reporter::Version module to determine the version of gcc.  Examples of reporters that use the other Perl modules are 
located in $INCA_DIST/Inca-Reporter-*/bin.
<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>#!/usr/bin/env perl

use strict;
use warnings;
use Inca::Reporter::Version;

my $reporter = new Inca::Reporter::Version(
  name =&#62; 'cluster.compiler.gcc.version',
  version =&#62; 2,
  description =&#62; 'Reports the version of gcc',
  url =&#62; 'http://gcc.gnu.org',
  package_name =&#62; 'gcc'
);
$reporter-&#62;processArgv(@ARGV);

$reporter-&#62;setVersionByExecutable('gcc -dumpversion');
$reporter-&#62;print();</PRE
></FONT
></TD
></TR
></TABLE
></P
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H3
CLASS="SECTION"
><A
NAME="REPORTER-REPOSITORIES"
>8.3. Reporter Repositories</A
></H3
><P
>The Inca system retrieves reporters from external collections called
repositories.  A reporter repository is simply a file directory, accessed via a
file: or http: URL, that contains a catalog file named Packages.gz.  This
gzipped file includes a sequence of name:value attribute pairs for every
reporter and support package in the repository; blank lines separate the
attributes for different reporters.  For example, here is a portion of the
Packages.gz file for the Inca standard reporter repository.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>arguments: help no|yes no;log [012345]|debug|error|info|system|warn 0;verbose [0
12] 1;version no|yes no
dependencies: Inca::Reporter;Inca::Reporter::Version
description: Reports the version of tgusage
file: cluster.accounting.tgusage.version
name: cluster.accounting.tgusage.version
url: http://www.teragrid.org
version: 2

arguments: help no|yes no;log [012345]|debug|error|info|system|warn 0;verbose [0
12] 1;version no|yes no
dependencies: Inca::Reporter;Inca::Reporter::SimpleUnit
description: ant hello world test
file: cluster.admin.ant.unit
name: cluster.admin.ant.unit
version: 3

arguments: help no|yes no;log [012345]|debug|error|info|system|warn 0;verbose [0
12] 1;version no|yes no
dependencies: Inca::Reporter;Inca::Reporter::Version
description: Reports the version of Apache Ant
file: cluster.admin.ant.version
name: cluster.admin.ant.version
version: 2&#13;</PRE
></FONT
></TD
></TR
></TABLE
><P
>Of the attributes shown, only file and name are required.  The file attribute
gives the relative path to the reporter file, and the name attribute specifies
the unique package name of the reporter.  If the reporter requires support
packages to execute, it should include a dependencies attribute with a
semicolon-separated list of package names.  The incat administration tool uses
the Packages.gz file's arguments and description attributes as part of its series edit dialog.
The value of the arguments attribute is a semicolon-separated list giving the
name, value pattern, and default value, if any, for each supported command-line
argument.</P
><P
>To create a local repository for your own reporters, you only need to collect
them into a directory and create a Packages.gz in that directory.  The Inca
distribution includes a perl script, incpack, that can create Packages.gz for
you.  Simply run incpack with a list of reporters that you want to include in
Packages.gz, e.g.,</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>perl incpack jade.version f77.unit vim.version</PRE
></FONT
></TD
></TR
></TABLE
><P
>incpack runs each of the listed reporters with --help=yes --verbose=1 to
extract a standard set of attributes.  If your reporters use the Inca reporter
perl modules, you might need to run incpack with a -I switch to specify the
location of the Inca perl library, like this.</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>perl incpack -I ${INCA_INSTALL}/lib jade.version f77.unit vim.version</PRE
></FONT
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-WEBSERVICES"
>9. Web Services and APIs</A
></H2
><P
>TODO: description of web services and perl and java client apis.</P
></DIV
><DIV
CLASS="SECTION"
><HR><H2
CLASS="SECTION"
><A
NAME="USERGUIDE-TROUBLESHOOT"
>10. Troubleshooting</A
></H2
><P
>This section will include debugging information about logging, the default inca.properties file, security (keys,
certs, etc.), "manpages" for each component and descriptions of manual resources. </P
></DIV
></DIV
></BODY
></HTML
>